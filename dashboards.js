!/**
 * Highcharts Dashboards v4.0.0 (2025-10-29)
 * @module dashboards/dashboards
 *
 * (c) 2009-2025 Highsoft AS
 *
 * License: www.highcharts.com/license
 */function(e,t){"object"==typeof exports&&"object"==typeof module?(e._Dashboards=t(),module.exports=e._Dashboards):"function"==typeof define&&define.amd?define("dashboards/dashboards",[],t):"object"==typeof exports?(e._Dashboards=t(),exports["dashboards/dashboards"]=e._Dashboards):(e.Dashboards&&e.Dashboards.error(16,!0),e.Dashboards=t())}("undefined"==typeof window?this:window,()=>(()=>{"use strict";let e;var t,i,n,r,o,s,a,l,c,h,d={};d.d=(e,t)=>{for(var i in t)d.o(t,i)&&!d.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var u={};d.d(u,{default:()=>rV}),function(e){e.SVG_NS="http://www.w3.org/2000/svg",e.product="Highcharts",e.version="4.0.0",e.win="undefined"!=typeof window?window:{},e.doc=e.win.document,e.svg=!!e.doc?.createElementNS?.(e.SVG_NS,"svg")?.createSVGRect,e.pageLang=e.doc?.documentElement?.closest("[lang]")?.lang,e.userAgent=e.win.navigator?.userAgent||"",e.isChrome=e.win.chrome,e.isFirefox=-1!==e.userAgent.indexOf("Firefox"),e.isMS=/(edge|msie|trident)/i.test(e.userAgent)&&!e.win.opera,e.isSafari=!e.isChrome&&-1!==e.userAgent.indexOf("Safari"),e.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(e.userAgent),e.isWebKit=-1!==e.userAgent.indexOf("AppleWebKit"),e.deg2rad=2*Math.PI/360,e.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],e.noop=function(){},e.supportsPassiveEvents=function(){let t=!1;if(!e.isMS){let i=Object.defineProperty({},"passive",{get:function(){t=!0}});e.win.addEventListener&&e.win.removeEventListener&&(e.win.addEventListener("testPassive",e.noop,i),e.win.removeEventListener("testPassive",e.noop,i))}return t}(),e.charts=[],e.composed=[],e.dateFormats={},e.seriesTypes={},e.symbolSizes={},e.chartCount=0}(t||(t={}));let p=t,{charts:f,doc:m,win:g}=p;function y(e,t,i,n){let r=t?"Highcharts error":"Highcharts warning";32===e&&(e=`${r}: Deprecated member`);let o=T(e),s=o?`${r} #${e}: www.highcharts.com/errors/${e}/`:e.toString();if(void 0!==n){let e="";o&&(s+="?"),H(n,function(t,i){e+=`
 - ${i}: ${t}`,o&&(s+=encodeURI(i)+"="+encodeURI(t))}),s+=e}D(p,"displayError",{chart:i,code:e,message:s,params:n},function(){if(t)throw Error(s);g.console&&-1===y.messages.indexOf(s)&&console.warn(s)}),y.messages.push(s)}function b(e,t){return parseInt(e,t||10)}function C(e){return"string"==typeof e}function w(e){let t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t}function v(e,t){return!!e&&"object"==typeof e&&(!t||!w(e))}function O(e){return v(e)&&"number"==typeof e.nodeType}function x(e){let t=e?.constructor;return!!(v(e,!0)&&!O(e)&&t?.name&&"Object"!==t.name)}function T(e){return"number"==typeof e&&!isNaN(e)&&e<1/0&&e>-1/0}function E(e){return null!=e}function N(e,t,i){let n,r=C(t)&&!E(i),o=(t,i)=>{E(t)?e.setAttribute(i,t):r?(n=e.getAttribute(i))||"class"!==i||(n=e.getAttribute(i+"Name")):e.removeAttribute(i)};return C(t)?o(i,t):H(t,o),n}function M(e){return w(e)?e:[e]}function S(e,t){let i;for(i in e||(e={}),t)e[i]=t[i];return e}function A(){let e=arguments,t=e.length;for(let i=0;i<t;i++){let t=e[i];if(null!=t)return t}}function R(e,t){S(e.style,t)}function P(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))}function I(e,t){return e>1e14?e:parseFloat(e.toPrecision(t||14))}(y||(y={})).messages=[],Math.easeInOutSine=function(e){return -.5*(Math.cos(Math.PI*e)-1)};let L=Array.prototype.find?function(e,t){return e.find(t)}:function(e,t){let i,n=e.length;for(i=0;i<n;i++)if(t(e[i],i))return e[i]};function H(e,t,i){for(let n in e)Object.hasOwnProperty.call(e,n)&&t.call(i||e[n],e[n],n,e)}function k(e,t,i){function n(t,i){let n=e.removeEventListener;n&&n.call(e,t,i,!1)}function r(i){let r,o;e.nodeName&&(t?(r={})[t]=!0:r=i,H(r,function(e,t){if(i[t])for(o=i[t].length;o--;)n(t,i[t][o].fn)}))}let o="function"==typeof e&&e.prototype||e;if(Object.hasOwnProperty.call(o,"hcEvents")){let e=o.hcEvents;if(t){let o=e[t]||[];i?(e[t]=o.filter(function(e){return i!==e.fn}),n(t,i)):(r(e),e[t]=[])}else r(e),delete o.hcEvents}}function D(e,t,i,n){if(i=i||{},m?.createEvent&&(e.dispatchEvent||e.fireEvent&&e!==p)){let n=m.createEvent("Events");n.initEvent(t,!0,!0),i=S(n,i),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent(t,i)}else if(e.hcEvents){i.target||S(i,{preventDefault:function(){i.defaultPrevented=!0},target:e,type:t});let n=[],r=e,o=!1;for(;r.hcEvents;)Object.hasOwnProperty.call(r,"hcEvents")&&r.hcEvents[t]&&(n.length&&(o=!0),n.unshift.apply(n,r.hcEvents[t])),r=Object.getPrototypeOf(r);o&&n.sort((e,t)=>e.order-t.order),n.forEach(t=>{!1===t.fn.call(e,i)&&i.preventDefault()})}n&&!i.defaultPrevented&&n.call(e,i)}let F=function(){let t=Math.random().toString(36).substring(2,9)+"-",i=0;return function(){return"highcharts-"+(e?"":t)+i++}}();g.jQuery&&(g.jQuery.fn.highcharts=function(){let e=[].slice.call(arguments);if(this[0])return e[0]?(new p[C(e[0])?e.shift():"Chart"](this[0],e[0],e[1]),this):f[N(this[0],"data-highcharts-chart")]});let j={addEvent:function(e,t,i,n={}){let r="function"==typeof e&&e.prototype||e;Object.hasOwnProperty.call(r,"hcEvents")||(r.hcEvents={});let o=r.hcEvents;p.Point&&e instanceof p.Point&&e.series&&e.series.chart&&(e.series.chart.runTrackerClick=!0);let s=e.addEventListener;s&&s.call(e,t,i,!!p.supportsPassiveEvents&&{passive:void 0===n.passive?-1!==t.indexOf("touch"):n.passive,capture:!1}),o[t]||(o[t]=[]);let a={fn:i,order:"number"==typeof n.order?n.order:1/0};return o[t].push(a),o[t].sort((e,t)=>e.order-t.order),function(){k(e,t,i)}},arrayMax:function(e){let t=e.length,i=e[0];for(;t--;)e[t]>i&&(i=e[t]);return i},arrayMin:function(e){let t=e.length,i=e[0];for(;t--;)e[t]<i&&(i=e[t]);return i},attr:N,clamp:function(e,t,i){return e>t?e<i?e:i:t},clearTimeout:function(e){E(e)&&clearTimeout(e)},correctFloat:I,createElement:function(e,t,i,n,r){let o=m.createElement(e);return t&&S(o,t),r&&R(o,{padding:"0",border:"none",margin:"0"}),i&&R(o,i),n&&n.appendChild(o),o},crisp:function(e,t=0,i){let n=t%2/2,r=i?-1:1;return(Math.round(e*r-n)+n)*r},css:R,defined:E,destroyObjectProperties:function(e,t,i){H(e,function(n,r){n!==t&&n?.destroy&&n.destroy(),(n?.destroy||!i)&&delete e[r]})},diffObjects:function(e,t,i,n){let r={};return!function e(t,r,o,s){let a=i?r:t;H(t,function(i,l){if(!s&&n&&n.indexOf(l)>-1&&r[l]){i=M(i),o[l]=[];for(let t=0;t<Math.max(i.length,r[l].length);t++)r[l][t]&&(void 0===i[t]?o[l][t]=r[l][t]:(o[l][t]={},e(i[t],r[l][t],o[l][t],s+1)))}else v(i,!0)&&!i.nodeType?(o[l]=w(i)?[]:{},e(i,r[l]||{},o[l],s+1),0===Object.keys(o[l]).length&&("colorAxis"!==l||0!==s)&&delete o[l]):(t[l]!==r[l]||l in t&&!(l in r))&&"__proto__"!==l&&"constructor"!==l&&(o[l]=a[l])})}(e,t,r,0),r},discardElement:function(e){e?.parentElement?.removeChild(e)},erase:function(e,t){let i=e.length;for(;i--;)if(e[i]===t){e.splice(i,1);break}},error:y,extend:S,extendClass:function(e,t){let i=function(){};return i.prototype=new e,S(i.prototype,t),i},find:L,fireEvent:D,getAlignFactor:(e="")=>({center:.5,right:1,middle:.5,bottom:1})[e]||0,getClosestDistance:function(e,t){let i,n,r,o,s=!t;return e.forEach(e=>{if(e.length>1)for(o=n=e.length-1;o>0;o--)(r=e[o]-e[o-1])<0&&!s?(t?.(),t=void 0):r&&(void 0===i||r<i)&&(i=r)}),i},getMagnitude:P,getNestedProperty:function(e,t){let i=e.split(".");for(;i.length&&E(t);){let e=i.shift();if(void 0===e||"__proto__"===e)return;if("this"===e){let e;return v(t)&&(e=t["@this"]),e??t}let n=t[e.replace(/[\\'"]/g,"")];if(!E(n)||"function"==typeof n||"number"==typeof n.nodeType||n===g)return;t=n}return t},getStyle:function e(t,i,n){let r;if("width"===i){let i=Math.min(t.offsetWidth,t.scrollWidth),n=t.getBoundingClientRect?.().width;return n<i&&n>=i-1&&(i=Math.floor(n)),Math.max(0,i-(e(t,"padding-left",!0)||0)-(e(t,"padding-right",!0)||0))}if("height"===i)return Math.max(0,Math.min(t.offsetHeight,t.scrollHeight)-(e(t,"padding-top",!0)||0)-(e(t,"padding-bottom",!0)||0));let o=g.getComputedStyle(t,void 0);return o&&(r=o.getPropertyValue(i),A(n,"opacity"!==i)&&(r=b(r))),r},insertItem:function(e,t){let i,n=e.options.index,r=t.length;for(i=e.options.isInternal?r:0;i<r+1;i++)if(!t[i]||T(n)&&n<A(t[i].options.index,t[i]._i)||t[i].options.isInternal){t.splice(i,0,e);break}return i},isArray:w,isClass:x,isDOMElement:O,isFunction:function(e){return"function"==typeof e},isNumber:T,isObject:v,isString:C,merge:function(e,...t){let i,n=[e,...t],r={},o=function(e,t){return"object"!=typeof e&&(e={}),H(t,function(i,n){"__proto__"!==n&&"constructor"!==n&&(!v(i,!0)||x(i)||O(i)?e[n]=t[n]:e[n]=o(e[n]||{},i))}),e};!0===e&&(r=n[1],n=Array.prototype.slice.call(n,2));let s=n.length;for(i=0;i<s;i++)r=o(r,n[i]);return r},normalizeTickInterval:function(e,t,i,n,r){let o,s=e;i=A(i,P(e));let a=e/i;for(!t&&(t=r?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===n&&(1===i?t=t.filter(function(e){return e%1==0}):i<=.1&&(t=[1/i]))),o=0;o<t.length&&(s=t[o],(!r||!(s*i>=e))&&(r||!(a<=(t[o]+(t[o+1]||t[o]))/2)));o++);return I(s*i,-Math.round(Math.log(.001)/Math.LN10))},objectEach:H,offset:function(e){let t=m.documentElement,i=e.parentElement||e.parentNode?e.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:i.top+(g.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(g.pageXOffset||t.scrollLeft)-(t.clientLeft||0),width:i.width,height:i.height}},pad:function(e,t,i){return Array((t||2)+1-String(e).replace("-","").length).join(i||"0")+e},pick:A,pInt:b,pushUnique:function(e,t){return 0>e.indexOf(t)&&!!e.push(t)},relativeLength:function(e,t,i){return/%$/.test(e)?t*parseFloat(e)/100+(i||0):parseFloat(e)},removeEvent:k,replaceNested:function(e,...t){let i,n;do for(n of(i=e,t))e=e.replace(n[0],n[1]);while(e!==i);return e},splat:M,stableSort:function(e,t){let i,n,r=e.length;for(n=0;n<r;n++)e[n].safeI=n;for(e.sort(function(e,n){return 0===(i=t(e,n))?e.safeI-n.safeI:i}),n=0;n<r;n++)delete e[n].safeI},syncTimeout:function(e,t,i){return t>0?setTimeout(e,t,i):(e.call(0,i),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(e){return C(e)?e.substring(0,1).toUpperCase()+e.substring(1):String(e)},uniqueKey:F,useSerialIds:function(t){return e=A(t,e)},wrap:function(e,t,i){let n=e[t];e[t]=function(){let e=arguments,t=this;return i.apply(this,[function(){return n.apply(t,arguments.length?arguments:e)}].concat([].slice.call(arguments)))}}},{SVG_NS:z,win:$}=p,{attr:V,createElement:B,css:U,error:Y,isFunction:_,isString:G,objectEach:J,splat:W}=j,{trustedTypes:K}=$,q=K&&_(K.createPolicy)&&K.createPolicy("highcharts",{createHTML:e=>e}),Z=q?q.createHTML(""):"";class X{static filterUserAttributes(e){return J(e,(t,i)=>{let n=!0;-1===X.allowedAttributes.indexOf(i)&&(n=!1),-1!==["background","dynsrc","href","lowsrc","src"].indexOf(i)&&(n=G(t)&&X.allowedReferences.some(e=>0===t.indexOf(e))),n||(Y(33,!1,void 0,{"Invalid attribute in config":`${i}`}),delete e[i]),G(t)&&e[i]&&(e[i]=t.replace(/</g,"&lt;"))}),e}static parseStyle(e){return e.split(";").reduce((e,t)=>{let i=t.split(":").map(e=>e.trim()),n=i.shift();return n&&i.length&&(e[n.replace(/-([a-z])/g,e=>e[1].toUpperCase())]=i.join(":")),e},{})}static setElementHTML(e,t){e.innerHTML=X.emptyHTML,t&&new X(t).addToDOM(e)}constructor(e){this.nodes="string"==typeof e?this.parseMarkup(e):e}addToDOM(e){return function e(t,i){let n;return W(t).forEach(function(t){let r,o=t.tagName,s=t.textContent?p.doc.createTextNode(t.textContent):void 0,a=X.bypassHTMLFiltering;if(o)if("#text"===o)r=s;else if(-1!==X.allowedTags.indexOf(o)||a){let n="svg"===o?z:i.namespaceURI||z,l=p.doc.createElementNS(n,o),c=t.attributes||{};J(t,function(e,t){"tagName"!==t&&"attributes"!==t&&"children"!==t&&"style"!==t&&"textContent"!==t&&(c[t]=e)}),V(l,a?c:X.filterUserAttributes(c)),t.style&&U(l,t.style),s&&l.appendChild(s),e(t.children||[],l),r=l}else Y(33,!1,void 0,{"Invalid tagName in config":o});r&&i.appendChild(r),n=r}),n}(this.nodes,e)}parseMarkup(e){let t,i=[];e=e.trim().replace(/ style=(["'])/g," data-style=$1");try{t=new DOMParser().parseFromString(q?q.createHTML(e):e,"text/html")}catch{}if(!t){let i=B("div");i.innerHTML=e,t={body:i}}let n=(e,t)=>{let i=e.nodeName.toLowerCase(),r={tagName:i};"#text"===i&&(r.textContent=e.textContent||"");let o=e.attributes;if(o){let e={};[].forEach.call(o,t=>{"data-style"===t.name?r.style=X.parseStyle(t.value):e[t.name]=t.value}),r.attributes=e}if(e.childNodes.length){let t=[];[].forEach.call(e.childNodes,e=>{n(e,t)}),t.length&&(r.children=t)}t.push(r)};return[].forEach.call(t.body.childNodes,e=>n(e,i)),i}}X.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","disabled","dx","dy","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","result","role","rowspan","scope","slope","src","startOffset","stdDeviation","stroke-linecap","stroke-width","stroke","style","summary","tabindex","tableValues","target","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],X.allowedReferences=["https://","http://","mailto:","/","../","./","#"],X.allowedTags=["#text","a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","tbody","td","text","textPath","th","thead","title","tr","tspan","u","ul"],X.emptyHTML=Z,X.bypassHTMLFiltering=!1,!function(e){e.classNamePrefix="highcharts-dashboards-",e.classNames={layout:e.classNamePrefix+"layout",cell:e.classNamePrefix+"cell",cellHover:e.classNamePrefix+"cell-state-hover",cellActive:e.classNamePrefix+"cell-state-active",cellLoading:e.classNamePrefix+"cell-state-loading",row:e.classNamePrefix+"row",layoutsWrapper:e.classNamePrefix+"layouts-wrapper",boardContainer:e.classNamePrefix+"wrapper"},e.guiElementType={row:"row",cell:"cell",layout:"layout"},e.boards=[],e.win=window,e.doc=document,e.noop=function(){},e.isMS=/(edge|msie|trident)/i.test(e.win.navigator&&e.win.navigator.userAgent||"")&&!e.win.opera,e.supportsPassiveEvents=function(){let t=!1;if(!e.isMS){let i=Object.defineProperty({},"passive",{get:function(){t=!0}});e.win.addEventListener&&e.win.removeEventListener&&(e.win.addEventListener("testPassive",e.noop,i),e.win.removeEventListener("testPassive",e.noop,i))}return t}()}(i||(i={}));let Q=i,ee=Q.classNamePrefix+"edit-",et={classNames:{resizeSnap:ee+"resize-snap",resizeSnapX:ee+"resize-snap-x",resizeSnapY:ee+"resize-snap-y",separator:ee+"separator",contextMenuBtn:ee+"context-menu-btn",contextMenuBtnText:ee+"context-menu-btn-text",contextMenu:ee+"context-menu",contextMenuItem:ee+"context-menu-item",editModeEnabled:ee+"enabled",editToolbar:ee+"toolbar",editToolbarCellOutline:ee+"toolbar-cell-outline",editToolbarRowOutline:ee+"toolbar-row-outline",editToolbarItem:ee+"toolbar-item",editToolbarRow:ee+"toolbar-row",editToolbarCell:ee+"toolbar-cell",editSidebar:ee+"sidebar",editSidebarShow:ee+"sidebar-show",editSidebarHide:ee+"sidebar-hide",editSidebarHeader:ee+"sidebar-header",editSidebarTitle:ee+"sidebar-title",editSidebarMenuItem:ee+"sidebar-item",rowContextHighlight:ee+"row-context-highlight",cellEditHighlight:ee+"cell-highlight",dashboardCellEditHighlightActive:ee+"cell-highlight-active",dragMock:ee+"drag-mock",dropPointer:ee+"drop-pointer",contextDetectionPointer:ee+"ctx-detection-pointer",resizePointer:ee+"resize-pointer",currentEditedElement:ee+"unmask",maskElement:ee+"mask",menuItem:ee+"menu-item",menu:ee+"menu",menuVerticalSeparator:ee+"menu-vertical-separator",menuHorizontalSeparator:ee+"menu-horizontal-separator",menuDestroy:ee+"menu-destroy",editSidebarWrapper:ee+"sidebar-wrapper",customSelect:ee+"custom-select",customSelectButton:ee+"custom-option-button",toggleContainer:ee+"toggle-container",toggleWrapper:ee+"toggle-wrapper",toggleSlider:ee+"toggle-slider",toggleWrapperColored:ee+"toggle-wrapper-colored",toggleLabels:ee+"toggle-labels",labeledToggleWrapper:ee+"labeled-toggle-wrapper",button:ee+"button",sidebarNavButton:ee+"sidebar-button-nav",labelText:ee+"label-text",editSidebarTabBtn:ee+"sidebar-tab-btn",editToolsBtn:ee+"tools-btn",editTools:ee+"tools",editGridItems:ee+"grid-items",editStandaloneToggle:ee+"standalone-toggle",confirmationPopup:ee+"confirmation-popup",popupButtonContainer:ee+"confirmation-popup-button-container",popupContentContainer:ee+"confirmation-popup-content",popupCancelBtn:ee+"confirmation-popup-cancel-btn",popupConfirmBtn:ee+"confirmation-popup-confirm-btn",popupCloseButton:ee+"popup-close",editOverlay:ee+"overlay",editOverlayActive:ee+"overlay-active",resizerMenuBtnActive:ee+"resizer-menu-btn-active",sidebarCloseButton:ee+"close-btn",editSidebarTabBtnWrapper:ee+"tabs-buttons-wrapper",editSidebarRight:ee+"sidebar-right",editSidebarRightShow:ee+"sidebar-right-show",viewFullscreen:ee+"view-fullscreen",accordionMenu:ee+"accordion-menu",accordionContainer:ee+"accordion",accordionHeader:ee+"accordion-header",accordionHeaderBtn:ee+"accordion-header-btn",accordionHeaderWrapper:ee+"accordion-header-wrapper",accordionHeaderIcon:ee+"accordion-header-icon",accordionContent:ee+"accordion-content",accordionNestedWrapper:ee+"accordion-nested",accordionMenuButtonsContainer:ee+"accordion-menu-buttons-container",accordionMenuButton:ee+"accordion-menu-button",accordionStandaloneWrapper:ee+"accordion-standalone-wrapper",hiddenElement:ee+"hidden-element",collapsableContentHeader:ee+"collapsable-content-header",standaloneElement:ee+"standalone-element",collapsedElement:ee+"collapsed-element",dropdown:ee+"dropdown",dropdownContent:ee+"dropdown-content",dropdownButton:ee+"dropdown-button",dropdownButtonContent:ee+"dropdown-button-content",dropdownIcon:ee+"pointer",icon:ee+"icon"}},{addEvent:ei,createElement:en,uniqueKey:er,objectEach:eo,error:es}=j,ea=class{static getOffsets(e,t){let i={left:0,top:0,right:0,bottom:0};if(!e.container)return i;let n=e.container.getBoundingClientRect(),r=t?t.getBoundingClientRect():{left:0,top:0};return i.left=n.left-r.left,i.top=n.top-r.top,i.right=n.right-r.left,i.bottom=n.bottom-r.top,i}static getDimFromOffsets(e){return{width:e.right-e.left,height:e.bottom-e.top}}static getElementId(e){return Q.classNamePrefix+e+"-"+er().slice(11)}static getPercentageWidth(e){let t,i=/^(\d{1})[\-\/\.](\d{1,2})$/;if(i.test(e)){let n=e.match(i)||[];t=((t=100*n[1]/n[2])<=100?t:100)+"%"}else if(-1!==e.indexOf("%")){let i=parseFloat(e);t=(i<=100?i>=0?i:0:100)+"%"}return t}getElementContainer(e){let t,i=this;if(e.render)e.attribs&&!e.attribs.id&&delete e.attribs.id;else if("string"==typeof e.elementId){let t=document.getElementById(e.elementId);t?i.container=t:es("Element "+e.elementId+" does not exist")}return i.removeBindedEventFn=ei(t=e.element instanceof HTMLElement?e.element:en("div",e.attribs||{},e.style||{},e.parentContainer),"bindedGUIElement",function(e){e.guiElement=i,e.stopImmediatePropagation()}),t}destroy(){let e=this;e.removeBindedEventFn&&e.removeBindedEventFn(),e.container&&e.container.parentNode&&e.container.parentNode.removeChild(e.container),eo(e,function(t,i){delete e[i]})}getType(){return this.type}changeVisibility(e=!0,t){let i=this.isVisible&&!e||!this.isVisible&&e;this.container&&i&&(this.container.style.display=e?t||"block":"none",this.isVisible=e)}hide(){this.changeVisibility(!1)}show(){this.changeVisibility()}},{merge:el,fireEvent:ec}=j;class eh extends ea{constructor(e,t,i){super(),this.type=Q.guiElementType.cell,this.id=t.id,this.options=t,this.row=e,this.isVisible=!0;let n=document.getElementById(t.parentContainerId||"")||e.container,r=e.layout.options||{},o=e.options||{},s=r.cellClassName||"";this.container=this.getElementContainer({render:e.layout.board.guiEnabled,parentContainer:n,attribs:{id:t.id,className:Q.classNames.cell+" "+s},element:i,elementId:t.id,style:el(r.style,o.style,t.style,{height:this.height})}),this.options.layout&&this.setNestedLayout()}setNestedLayout(){let e=this.row.layout.board,t=this.row.layout.constructor,i=e.options.gui;this.nestedLayout=new t(e,el({},i&&i.layoutOptions,this.options.layout,{parentContainerId:this.options.id}),this)}destroy(){let{row:e}=this;this.mountedComponent?.destroy(),this.nestedLayout?.destroy(),e.unmountCell(this);let t=e.cells?.length===0;super.destroy(),t&&e.destroy()}getOptions(){return this.options}changeVisibility(e=!0){super.changeVisibility(e);let t=this,i=t.row;t.row.getVisibleCells().length?t.isVisible&&!i.isVisible&&t.row.show():t.row.hide(),setTimeout(()=>{ec(i,"cellChange",{row:i,cell:t})},0)}getParentCell(e){let t;if(e<=this.row.layout.level){if(this.row.layout.level===e)return this;if(this.row.layout.level-1>=0&&(t=this.row.layout.parentCell))return t.getParentCell(e)}}getOverlappingLevels(e,t,i){let n=this.row.layout.parentCell,r=[this.row.layout.level];if(n){let o=i||ea.getOffsets(this)[e],s=ea.getOffsets(n)[e];Math.abs(o-s)<t&&(r=[...r,...n.getOverlappingLevels(e,t,s)])}return r}setSize(e,t){let i=this.row.layout.board.editMode;if(this.container){if(e)if("auto"===e&&"1 1 0%"!==this.container.style.flex)this.container.style.flex="1 1 0%";else{let t=this.convertWidthToValue(e);t&&this.container.style.flex!=="0 0 "+t&&(this.container.style.flex="0 0 "+t)}t&&(this.height=this.container.style.height=t+"px"),i&&(i.hideContextPointer(),i.cellToolbar&&i.cellToolbar.isVisible&&(i.cellToolbar.cell===this?i.cellToolbar.showToolbar(this):i.cellToolbar.hide())),ec(this.row.layout.board,"cellResize",{cell:this}),ec(this.row,"cellChange",{cell:this,row:this.row})}}setHighlight(e){let t=this.row?.layout.board.editMode;if(this.container&&t){let t=this.container,i=t.classList.contains(et.classNames.cellEditHighlight);e||i?e&&i&&(t.classList.remove(et.classNames.cellEditHighlight),this.row.layout.board.container.classList.remove(et.classNames.dashboardCellEditHighlightActive),this.isHighlighted=!1):(t.classList.add(et.classNames.cellEditHighlight),this.row.layout.board.container.classList.add(et.classNames.dashboardCellEditHighlightActive),this.isHighlighted=!0)}}setActiveState(){this.row.layout.board.mountedComponents.forEach(e=>{e.cell.container&&e.cell.container.classList.remove(Q.classNames.cellActive),e.component.isActive=!1}),this.container&&this.container.classList.add(Q.classNames.cellActive)}setLoadingState(e=!0){this.container?.classList?.toggle(Q.classNames.cellLoading,e)}convertWidthToValue(e){return"number"==typeof e?e+"px":/px/.test(e)?e:ea.getPercentageWidth(e)||""}}(eh||(eh={})).isCell=function(e){return!!e&&"row"in e&&"cell"===e.type};let ed=eh,eu=class{constructor(){this.registry={}}addCallback(e,t){this.registry[e]=t}getCallback(e){return this.registry[e]}toJSON(){let e={};return Object.keys(this.registry).forEach(t=>{let{func:i,type:n}=this.getCallback(t);e[t]={func:i.toString(),type:n}}),e}},ep=class{constructor(e,t){this.tableEvents=[],this.component=e,this.options=t}async initConnector(){let e=this.component,t=this.options.id,i=this.component.board.dataPool;if(t&&(this.connectorId!==t||i.isNewConnector(t))){ed.isCell(e.cell)&&e.cell.setLoadingState();let n=await i.getConnector(t);this.destroyed||this.setConnector(n)}return e}setTable(e){this.clearTableListeners(e),this.setupTableListeners(e),e.on("setModifier",()=>this.clearTableListeners(e)),e.on("afterSetModifier",e=>{"afterSetModifier"===e.type&&e.modified&&(this.setupTableListeners(e.modified),this.component.emit({type:"tableChanged",connector:this.connector}))}),this.presentationModifier?this.presentationTable=this.presentationModifier.modifyTable(e.getModified().clone()).getModified():this.presentationTable=e}setConnector(e){for(;this.tableEvents.length;){let e=this.tableEvents.pop();"function"==typeof e&&e()}if(this.connector=e,e){let t=e.dataTables;this.options.dataTableKey?this.setTable(t[this.options.dataTableKey]):this.setTable(Object.values(t)[0])}return this.addConnectorAssignment(),this.component}setupTableListeners(e){let t=this.connector;t&&e&&["afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].forEach(i=>{this.tableEvents.push(e.on(i,e=>{clearTimeout(this.tableEventTimeout),this.tableEventTimeout=Q.win.setTimeout(()=>{this.component.emit({...e,type:"tableChanged",targetConnector:t}),this.tableEventTimeout=void 0})}))})}clearTableListeners(e){let t=this.connector,i=this.tableEvents;this.removeTableEvents(),t&&i.push(e.on("afterSetModifier",e=>{"afterSetModifier"===e.type&&(clearTimeout(this.tableEventTimeout),this.tableEventTimeout=Q.win.setTimeout(()=>{this.component.emit({...e,type:"tableChanged",targetConnector:t}),this.tableEventTimeout=void 0}))}))}addConnectorAssignment(){let{connector:e}=this;if(e&&(e.components||(e.components=[]),!e.components.includes(this.component))){let t=e.options;e.components.push(this.component),"enablePolling"in t&&t.enablePolling&&!e.polling&&1===e.components.length&&"dataRefreshRate"in t&&e.startPolling(1e3*Math.max(t.dataRefreshRate||0,1))}}removeConnectorAssignment(){let{connector:e}=this;if(!e?.components)return;let t=e.components.indexOf(this.component);t>-1&&(e.components.splice(t,1),e.components.length||(e.stopPolling(),delete e.components))}removeTableEvents(){this.tableEvents.forEach(e=>e()),this.tableEvents.length=0}updateOptions(e){this.options=e}destroy(){this.destroyed=!0,this.removeConnectorAssignment(),this.removeTableEvents()}};class ef{constructor(e,t=ef.defaultBindings){this.component=e,this.bindings=t}getOptions(){let e=this.component.options.editableOptions;if(!e)return[];for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.propertyPath?.some(e=>"connector"===e)){let e=this.component.board;i.selectOptions=e?e.dataPool.getConnectorIds().map(e=>({name:e})):[]}}return e}}ef.defaultBindings={keyMap:{color:"colorPicker",title:"text",caption:"text",style:"textarea"},typeMap:{string:"text",number:"input",boolean:"toggle"},skipRedraw:[]},ef.defaultTypeMap={string:"text",number:"input",boolean:"toggle"};class em{static register(e){let{id:t}=e;this.registry[t]=e}static get(e){return this.registry[e]}constructor(e,t){this.id=e,this.func=t,em.register(this)}create(e){this.callback=this.func.call(e)}remove(){this.callback&&this.callback()}}em.registry={};class eg{static register(e){let{id:t}=e;this.registry[t]=e}static get(e){return this.registry[e]}constructor(e,t){this.id=e,this.func=t,eg.register(this)}register(e){let{func:t}=this;this.callback=t.call(e)}remove(){this.callback&&this.callback()}}eg.registry={};let{merge:ey,isObject:eb}=j;class eC{constructor(e,t){this.component=e,this.predefinedSyncConfig=t,this.syncConfig=eC.prepareSyncConfig(t,e.options.sync),this.registeredSyncHandlers={},this.registeredSyncEmitters={},this.isSyncing=!1,this.listeners=[]}static prepareSyncConfig(e,t={}){let{defaultSyncPairs:i,defaultSyncOptions:n}=e;return Object.keys(t).reduce((e,r)=>{if(r){let o=i[r],s=n[r],a=t[r],l=ey(s||{},{enabled:eb(a)?a.enabled:a},eb(a)?a:{});if(o&&l.enabled)for(let e of["emitter","handler"])(!0===l[e]||void 0===l[e])&&(l[e]=o[e]);e[r]=l}return e},{})}registerSyncEmitter(e){let{id:t}=e;this.registeredSyncEmitters[t]=e}isRegisteredEmitter(e){return!!this.registeredSyncEmitters[e]}registerSyncHandler(e){let{id:t}=e;this.registeredSyncHandlers[t]=e}isRegisteredHandler(e){return!!this.registeredSyncHandlers[e]}start(){let{component:e}=this;for(let t of(this.syncConfig=eC.prepareSyncConfig(this.predefinedSyncConfig,e.options.sync),Object.keys(this.syncConfig))){let i=this.syncConfig[t];if(!i)continue;let{emitter:n,handler:r}=i;if(r){!0===r&&(r=eC.defaultHandlers[t].handler);let i=new eg(t,r);this.isRegisteredHandler(i.id)||(this.registerSyncHandler(i),i.register(e))}if(n){!0===n&&(n=eC.defaultHandlers[t].emitter);let i=new em(t,n);this.isRegisteredEmitter(i.id)||(this.registerSyncEmitter(i),i.create(e))}}this.isSyncing=!0,this.listeners.push(e.on("update",()=>this.stop()))}stop(){let{component:e,listeners:t,registeredSyncHandlers:i,registeredSyncEmitters:n}=this;Object.keys(i).forEach(e=>{i[e].remove(),delete i[e]}),Object.keys(n).forEach(e=>{n[e].remove(),delete n[e]}),this.isSyncing=!1;for(let e=0,i=t.length;e<i;++e)t[e]();this.listeners.length=0,this.listeners.push(e.on("afterUpdate",()=>{this.start()}))}}eC.defaultHandlers={},!function(e){function t(e,t){let i=window.getComputedStyle(e);return t.map(e=>i[e])}function i(e,t){return t&&(e+="number"==typeof t?t:parseFloat(t)),e}e.getMargins=function(e,n=!0){return{y:t(e,["marginTop","marginBottom",...n?["borderTop","borderBottom"]:[]]).reduce(i,0),x:t(e,["marginLeft","marginTop",...n?["borderLeft","borderRight"]:[]]).reduce(i,0)}},e.getPaddings=function(e){return{x:t(e,["paddingLeft","paddingRight"]).reduce(i,0),y:t(e,["paddingTop","paddingBottom"]).reduce(i,0)}},e.getStyles=t,e.sumPixels=i}(n||(n={}));let{doc:ew,supportsPassiveEvents:ev}=Q,{error:eO,isClass:ex,isDOMElement:eT,isObject:eE,objectEach:eN,uniqueKey:eM}=j;function eS(e,t){let i;for(i in e||(e={}),t)e[i]=t[i];return e}function eA(e,t,i){function n(t,i){let n=e.removeEventListener;n&&n.call(e,t,i,!1)}function r(i){let r,o;e.nodeName&&(t?(r={})[t]=!0:r=i,eN(r,function(e,t){if(i[t])for(o=i[t].length;o--;)n(t,i[t][o].fn)}))}let o="function"==typeof e&&e.prototype||e;if(Object.hasOwnProperty.call(o,"hcEvents")){let e=o.hcEvents;if(t){let o=e[t]||[];i?(e[t]=o.filter(function(e){return i!==e.fn}),n(t,i)):(r(e),e[t]=[])}else r(e),delete o.hcEvents}}let eR={addEvent:function(e,t,i,n={}){let r="function"==typeof e&&e.prototype||e;Object.hasOwnProperty.call(r,"hcEvents")||(r.hcEvents={});let o=r.hcEvents,s=e.addEventListener;s&&s.call(e,t,i,!!ev&&{passive:void 0===n.passive?-1!==t.indexOf("touch"):n.passive,capture:!1}),o[t]||(o[t]=[]);let a={fn:i,order:"number"==typeof n.order?n.order:1/0};return o[t].push(a),o[t].sort((e,t)=>e.order-t.order),function(){eA(e,t,i)}},deepClone:function e(t,i){if(Array.isArray(t))return t.map(t=>e(t,i));if(t&&"object"==typeof t){let n={};for(let r of Object.keys(t))i&&i.includes(r)?n[r]=t[r]:n[r]=e(t[r],i);return n}return t},error:function(e,t){if(16===e)return void console.warn("Dashboard error: Dashboards library loaded more than once.This may cause undefined behavior.");eO(e,t)},fireEvent:function(e,t,i,n){if(i=i||{},ew?.createEvent&&(e.dispatchEvent||e.fireEvent&&e!==Q)){let n=ew.createEvent("Events");n.initEvent(t,!0,!0),i=eS(n,i),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent(t,i)}else if(e.hcEvents){i.target||eS(i,{preventDefault:function(){i.defaultPrevented=!0},target:e,type:t});let n=[],r=e,o=!1;for(;r.hcEvents;)Object.hasOwnProperty.call(r,"hcEvents")&&r.hcEvents[t]&&(n.length&&(o=!0),n.unshift.apply(n,r.hcEvents[t])),r=Object.getPrototypeOf(r);o&&n.sort((e,t)=>e.order-t.order),n.forEach(t=>{!1===t.fn.call(e,i)&&i.preventDefault()})}n&&!i.defaultPrevented&&n.call(e,i)},merge:function(e,...t){let i=0,n={},r=Error("Recursive copy depth > 100"),o=(e,t)=>{if("object"!=typeof e&&(e={}),++i>100)throw r;return eN(t,(i,n)=>{"__proto__"!==n&&"constructor"!==n&&(!eE(i,!0)||ex(i)||eT(i)?e[n]=t[n]:e[n]=o(e[n]||{},i))}),--i,e};!0===e?n=t.shift():t.unshift(e);for(let e=0,i=t.length;e<i;++e)n=o(n,t[e]);return n},removeEvent:eA,uniqueKey:function(){return`dashboard-${eM().replace("highcharts-","")}`}},{classNamePrefix:eP}=Q,{createElement:eI,isArray:eL,merge:eH,fireEvent:ek,addEvent:eD,objectEach:eF,isFunction:ej,getStyle:ez,diffObjects:e$,removeEvent:eV}=j,{getMargins:eB,getPaddings:eU}=n,{deepClone:eY,uniqueKey:e_}=eR;class eG{static createTextElement(e,t,i){if("object"==typeof i){let{className:n,text:r,style:o}=i;return eI(e,{className:n||`${eP}component-${t}`,textContent:r},o)}if("string"==typeof i)return eI(e,{className:`${eP}component-${t}`,textContent:i},{})}constructor(e,t,i){this.connectorHandlers=[],this.callbackRegistry=new eu,this.cellListeners=[],this.resizeTimeouts=[],this.innerResizeTimeouts=[];let n=t.renderTo;if(this.board=i||e?.row?.layout?.board||{},this.parentElement=e?.container||document.querySelector("#"+n),this.cell=e,this.options=eH(eG.defaultOptions,t),this.id=this.options.id&&this.options.id.length?this.options.id:e_(),this.options.connector)for(let e of eL(this.options.connector)?this.options.connector:[this.options.connector])this.connectorHandlers.push(new ep(this,e));this.editableOptions=new ef(this,t.editableOptionsBindings),this.dimensions={width:null,height:null},this.element=eI("div",{className:this.options.className},{},this.parentElement),Number(ez(this.element,"padding"))||(this.element.style.padding="0.1px"),this.contentElement=eI("div",{className:`${this.options.className}-content`},{},this.element,!0),this.sync=new eC(this,this.constructor.predefinedSyncConfig),this.setupEventListeners(),e&&(this.attachCellListeners(),this.on("update",()=>{ed.isCell(this.cell)&&this.cell.setLoadingState()}),this.on("afterRender",()=>{ed.isCell(this.cell)&&this.cell.setLoadingState(!1)})),this.on("tableChanged",()=>{this.onTableChanged()})}getOptionsOnDrop(e){return{}}getFirstConnector(){return this.connectorHandlers[0]?.connector}attachCellListeners(){for(;this.cellListeners.length;){let e=this.cellListeners.pop();e&&e()}if(this.cell&&ed.isCell(this.cell)&&Object.keys(this.cell).length){let e=this.cell.row.layout.board;this.cellListeners.push(eD(e,"cellResize",()=>{this.resizeTo(this.parentElement)}),eD(this.cell.row,"cellChange",e=>{let{row:t}=e;t&&this.cell&&void 0===t.getCellIndex(this.cell)&&this.cell&&this.setCell(this.cell)}))}}setCell(e,t=!1){this.cell=e,e.container&&(this.parentElement=e.container),this.attachCellListeners(),t&&this.resizeTo(this.parentElement)}async initConnectors(){for(let e of(ek(this,"setConnectors",{connectorHandlers:this.connectorHandlers}),this.connectorHandlers))await e.initConnector();return ek(this,"afterSetConnectors",{connectorHandlers:this.connectorHandlers}),this}getContentHeight(){return(this.titleElement?this.titleElement.clientHeight+eB(this.titleElement).y:0)+(this.captionElement?this.captionElement.clientHeight+eB(this.captionElement).y:0)}resize(e,t){if(t){let e=eU(this.element).y+eB(this.element).y;this.element.style.height="calc(100% - "+e+"px)",this.contentElement.style.height="calc(100% - "+this.getContentHeight()+"px)"}else null===t&&(this.dimensions.height=null,this.element.style.removeProperty("height"));ek(this,"resize",{width:e,height:t})}resizeDynamicContent(e,t){let{element:i}=this;if(t){let e=eB(i).y,n=eU(i).y;"string"==typeof t&&(t=parseFloat(t)),t=Math.round(t),i.style.height=`${t-e-n}px`,this.contentElement.style.height=`${i.clientHeight-this.getContentHeight()-n}px`}else null===t&&(this.dimensions.height=null,i.style.removeProperty("height"));ek(this,"resize",{width:e,height:t})}resizeTo(e){for(;this.resizeTimeouts.length;){let e=this.resizeTimeouts.pop();e&&cancelAnimationFrame(e)}let t=requestAnimationFrame(()=>{let{width:t,height:i}=e.getBoundingClientRect(),n=eU(e),r=eB(e);this.resize(t-n.x-r.x,i-n.y-r.y)});this.resizeTimeouts.push(t)}async update(e,t=!0){let i={options:e,shouldForceRerender:!1};ek(this,"update",i),e.connector&&Array.isArray(this.options.connector)&&(this.options.connector=void 0),this.options=eH(this.options,e);let n=this.options.connector?eL(this.options.connector)?this.options.connector:[this.options.connector]:[],r=n.length!==this.connectorHandlers.length;if(!r)for(let e=0,t=n.length;e<t;e++){let t=this.connectorHandlers[e]?.options,i=n[e];if(i?.id!==t?.id||i?.dataTableKey!==t?.dataTableKey){r=!0;break}this.connectorHandlers[e].updateOptions(n[e])}if(r){for(let e of this.connectorHandlers)e.destroy();for(let e of(this.connectorHandlers.length=0,n))this.connectorHandlers.push(new ep(this,e));await this.initConnectors()}(t||i.shouldForceRerender)&&this.render()}setupEventListeners(){let e=this.options.events;e&&(Object.keys(e).forEach(t=>{let i=e[t];i&&this.callbackRegistry.addCallback(t,{type:"component",func:i})}),eF(e,(e,t)=>{ej(e)&&this.on(t,e)}));let t=()=>{this.resizeTo(this.parentElement)};if("function"==typeof ResizeObserver)this.resizeObserver=new ResizeObserver(t),this.resizeObserver.observe(this.element);else{let e=eD(window,"resize",t);eD(this,"destroy",e)}}setTitle(e){let t=this.titleElement;if(e&&("string"==typeof e||e.text)){let i=eG.createTextElement("h2","title",e);i&&(t?t.replaceWith(i):this.element.insertBefore(i,this.element.firstChild),this.titleElement=i)}else if(t){t.remove(),delete this.titleElement;return}}setCaption(e){let t=this.captionElement;if(e&&("string"==typeof e||e.text)){let i=eG.createTextElement("div","caption",e);i&&(t?t.replaceWith(i):this.element.appendChild(i),this.captionElement=i)}else if(t){t.remove(),delete this.captionElement;return}}async load(){return await this.initConnectors(),this.render(),this}render(){return this.emit({type:"render"}),this.setTitle(this.options.title),this.setCaption(this.options.caption),this.resizeTo(this.parentElement),this}destroy(){for(this.sync.isSyncing&&this.sync.stop();this.element.firstChild;)this.element.firstChild.remove();for(let e of(ek(this,"unmount"),this.connectorHandlers))e.destroy();eV(this),this.element.remove()}on(e,t){return eD(this,e,t)}emit(e){e.target||(e.target=this),ek(this,e.type,e)}getOptions(){return e$(this.options,eG.defaultOptions)}getEditableOptions(){return eY(this.options,["dataTable","points","series","data","editableOptions"])}getEditableOptionValue(e){if(!e)return;let t=this.getEditableOptions();for(let i=0,n=e.length;i<n;i++){if(eL(t)&&"connector"===e[0]&&t.length>1)return"multiple connectors";if(!t)return;!1===(t=t[e[i]])&&(e.indexOf("title")>=0||e.indexOf("subtitle")>=0||e.indexOf("caption")>=0)&&(t="")}return t}}eG.Sync=eC,eG.predefinedSyncConfig={defaultSyncOptions:{},defaultSyncPairs:{}},eG.defaultOptions={className:`${eP}component`,id:"",title:!1,caption:!1,sync:eC.defaultHandlers,editableOptions:[{name:"title",propertyPath:["title"],type:"input"},{name:"caption",propertyPath:["caption"],type:"input"}]};let eJ=eG,eW={type:"HTML",className:[eJ.defaultOptions.className,`${eJ.defaultOptions.className}-html`].join(" "),elements:[],editableOptions:[...eJ.defaultOptions.editableOptions||[],{name:"htmlInput",propertyPath:["html"],type:"textarea"}]},{merge:eK,diffObjects:eq}=j,{deepClone:eZ}=eR;X.allowedTags=[...X.allowedTags,"option","select","label","input","textarea"],X.allowedAttributes=[...X.allowedAttributes,"for","value","checked","src","name","selected"],X.allowedReferences=[...X.allowedReferences,"data:image/"];class eX extends eJ{constructor(e,t){t.className&&(t.className=`${eX.defaultOptions.className} ${t.className}`),super(e,t=eK(eX.defaultOptions,t)),this.options=t,this.type="HTML",this.elements=[]}async load(){this.emit({type:"load"}),await super.load();let e=this.options,t=!1;if(e.elements?.length?this.elements=e.elements.map(function(e){return"string"==typeof e?new X(e).nodes[0]:(e.textContent||e.tagName||!e.attributes||(t=!0),e)}):e.html&&(this.elements=this.getElementsFromString(e.html),this.options.elements=this.elements),this.constructTree(),this.emit({type:"afterLoad"}),t)throw Error(`Missing tagName param in component: ${e.renderTo}`);return this}render(){return super.render(),this.constructTree(),this.sync.start(),this.emit({type:"afterRender"}),this}resize(e,t){return super.resize(e,t),this}async update(e,t=!0){e.html?(this.elements=this.getElementsFromString(e.html),this.options.elements=this.elements,this.constructTree()):e.elements&&(this.elements=e.elements),await super.update(e,t),this.emit({type:"afterUpdate"})}getOptionsOnDrop(){return{type:"HTML",elements:[{tagName:"span",textContent:"[Your custom HTML here- edit the component]"}]}}constructTree(){for(;this.contentElement.firstChild;)this.contentElement.firstChild.remove();new X(this.options.elements||[]).addToDOM(this.contentElement)}getElementsFromString(e){return new X(e).nodes}getOptions(){return{...eq(this.options,eX.defaultOptions),type:"HTML"}}getEditableOptions(){return eZ(this.options,["editableOptions"])}getEditableOptionValue(e){if(e){if("html"===e[0]){let t=this.getEditableOptions();return!t.html&&t.elements?this.getStringFromElements(t.elements):t[e[0]]}return super.getEditableOptionValue(e)}}getStringFromElements(e){let t="";for(let i of e)t+=this.serializeNode(i);return t}serializeNode(e){if(!e.tagName||"#text"===e.tagName)return e.textContent||"";let t=e.attributes,i=`<${e.tagName}`;if(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let n=t[e];void 0!==n&&(i+=` ${e}="${n}"`)}}return i+=">",i+=e.textContent||"",(e.children||[]).forEach(e=>{i+=this.serializeNode(e)}),i+=`</${e.tagName}>`}onTableChanged(e){e.detail?.sender!==this.id&&this.render()}}eX.defaultOptions=eK(eJ.defaultOptions,eW),eX.predefinedSyncConfig={defaultSyncPairs:{},defaultSyncOptions:{}};let{isNumber:eQ}=j;!function(e){function t(e,t){if("number"==typeof e)return e;if("boolean"==typeof e)return+!!e;if("string"==typeof e){if(e.indexOf(" ")>-1&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}return e instanceof Date?e.getDate():e?e.getRowCount():NaN}e.asDate=function(e,t){let i;if("string"==typeof e)i=t.parseDate(e);else if("number"==typeof e)i=e;else{if(e instanceof Date)return e;i=t.parseDate(""+e)}return new Date(i)},e.asNumber=t,e.asString=function(e){return""+e},e.asBoolean=function(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!t(e)},e.guessType=function(t,i){let n="string";if("string"==typeof t){let r=e.trim(`${t}`),o=i.decimalRegExp,s=e.trim(r,!0);o&&(s=o.test(s)?s.replace(o,"$1.$2"):"");let a=parseFloat(s);+s===a?t=a:n=eQ(i.parseDate(t))?"Date":"string"}return"number"==typeof t&&(n=t>31536e6?"Date":"number"),n},e.trim=function(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e},e.getColumnsCollection=function(e=[],t){let i={};for(let n=0,r=Math.max(t.length,e.length);n<r;++n)i[t[n]||`${n}`]=e[n]?e[n].slice():[];return i}}(r||(r={}));let e0=r,{addEvent:e1,fireEvent:e2,merge:e3}=j;class e6{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){let t=new Date;if(!e)return NaN;let i=+e[4];return i>t.getFullYear()-2e3?i+=1900:i+=2e3,Date.UTC(i,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};let t=e3(e6.defaultOptions,e),i=t.decimalPoint;("."===i||","===i)&&(i="."===i?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+i+"([0-9]+)$")),this.options=t}convertByType(e){let t=this;return({number:e=>e0.asNumber(e,t.decimalRegExp),Date:e=>e0.asDate(e,t),string:e0.asString})[e0.guessType(e,t)].call(t,e)}deduceDateFormat(e,t,i){let n=[],r=[],o="YYYY/mm/dd",s,a=[],l=0,c=!1,h,d;for((!t||t>e.length)&&(t=e.length);l<t;l++)if(void 0!==e[l]&&e[l]&&e[l].length)for(d=0,s=e[l].trim().replace(/[\-\.\/]/g," ").split(" "),a=["","",""];d<s.length;d++)d<a.length&&(h=parseInt(s[d],10))&&(r[d]=!r[d]||r[d]<h?h:r[d],void 0!==n[d]?n[d]!==h&&(n[d]=!1):n[d]=h,h>31?h<100?a[d]="YY":a[d]="YYYY":h>12&&h<=31?(a[d]="dd",c=!0):a[d].length||(a[d]="mm"));if(c){for(d=0;d<n.length;d++)!1!==n[d]?r[d]>12&&"YY"!==a[d]&&"YYYY"!==a[d]&&(a[d]="YY"):r[d]>12&&"mm"===a[d]&&(a[d]="dd");3===a.length&&"dd"===a[1]&&"dd"===a[2]&&(a[2]="YY"),o=a.join("/")}return i&&(this.options.dateFormat=o),o}emit(e){e2(this,e.type,e)}on(e,t){return e1(this,e,t)}parseDate(e,t){let i=this.options,n=t||i.dateFormat,r=NaN,o,s=null;if(i.parseDate)r=i.parseDate(e);else{let t=this.dateFormats;if(n){let i=t[n];i||(i=t["YYYY/mm/dd"]),(s=e.match(i.regex))&&(r=i.parser(s))}else for(o in t){let i=t[o];if(s=e.match(i.regex)){n=o,r=i.parser(s);break}}if(!s){let t=Date.parse(e);!isNaN(t)&&(r=t-6e4*new Date(t).getTimezoneOffset(),e.includes("2001")||2001!==new Date(r).getFullYear()||(r=NaN))}}return r}}e6.defaultOptions={dateFormat:"",firstRowAsNames:!0},function(e){e.types={},e.registerType=function(t,i){return!!t&&!e.types[t]&&!!(e.types[t]=i)}}(e6||(e6={}));let e5=e6,{merge:e4}=j;class e9 extends e5{constructor(e){let t=e4(e9.defaultOptions,e);super(t),this.headers=[],this.dataTypes=[],this.options=t}parse(e,t){let i=this.dataTypes,n=e4(this.options,e),{beforeParse:r,lineDelimiter:o,firstRowAsNames:s,itemDelimiter:a}=n,l,c=0,{csv:h,startRow:d,endRow:u}=n,p,f=[];if(this.emit({type:"parse",columns:f,detail:t,headers:this.headers}),h&&r&&(h=r(h)),h){if(l=h.replace(/\r\n|\r/g,"\n").split(o||"\n"),(!d||d<0)&&(d=0),(!u||u>=l.length)&&(u=l.length-1),a||(this.guessedItemDelimiter=this.guessDelimiter(l)),s){let e=l[0].split(a||this.guessedItemDelimiter||",");for(let t=0;t<e.length;t++)e[t]=e[t].trim().replace(/^["']|["']$/g,"");this.headers=e,d++}let e=0;for(c=d;c<=u;c++)"#"===l[c][0]?e++:this.parseCSVRow(f,l[c],c-d-e);i.length&&i[0].length&&"date"===i[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(f[0],null,!0);for(let e=0,t=f.length;e<t;++e){p=f[e];for(let t=0,i=p.length;t<i;++t)if(p[t]&&"string"==typeof p[t]){let i=this.convertByType(p[t]);i instanceof Date&&(i=i.getTime()),f[e][t]=i}}}return f.forEach(e=>{e.length=Math.max(...f.map(e=>e.length))}),this.emit({type:"afterParse",columns:f,detail:t,headers:this.headers}),e0.getColumnsCollection(f,this.headers)}parseCSVRow(e,t,i){let n=this,r=n.dataTypes,{startColumn:o,endColumn:s}=n.options,a=n.options.itemDelimiter||n.guessedItemDelimiter,{decimalPoint:l}=n.options;l&&l!==a||(l=n.guessedDecimalPoint||".");let c=0,h="",d="",u=0,p=0,f=e=>{h=t[e]},m=e=>{r.length<p+1&&r.push([e]),r[p][r[p].length-1]!==e&&r[p].push(e)},g=()=>{if(o>u||u>s){++u,d="";return}if("string"==typeof d){let e=parseFloat(d);!isNaN(e)&&isFinite(Number(d))?(d=e,m("number")):isNaN(Date.parse(d))?m("string"):(d=d.replace(/\//g,"-"),m("date"))}else m("number");if(e.length<p+1&&e.push([]),"number"!=typeof d&&"number"!==e0.guessType(d,n)&&l){let e=d;d=d.replace(l,"."),"number"!==e0.guessType(d,n)&&(d=e)}e[p][i]=d,d="",++p,++u};if(t.trim().length&&"#"!==t.trim()[0]){for(;c<t.length;c++){if(f(c),"#"===h&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(t.substring(c)))return void g();if('"'===h)for(f(++c);c<t.length&&'"'!==h;)d+=h,f(++c);else h===a?g():d+=h}g()}}guessDelimiter(e){let t=0,i=0,n,r={",":0,";":0,"	":0},o=e.length;for(let n=0;n<o;n++){let o=!1,s,a,l,c="";if(n>13)break;let h=e[n];for(let e=0;e<h.length&&(s=h[e],a=h[e+1],l=h[e-1],"#"!==s);e++){if('"'===s)if(o){if('"'!==l&&'"'!==a){for(;" "===a&&e<h.length;)a=h[++e];void 0!==r[a]&&r[a]++,o=!1}}else o=!0;else void 0!==r[s]?(isNaN(Date.parse(c=c.trim()))?(isNaN(Number(c))||!isFinite(Number(c)))&&r[s]++:r[s]++,c=""):c+=s;","===s&&i++,"."===s&&t++}}return r[";"]>r[","]?n=";":(r[","]>r[";"],n=","),t>i?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",n}}e9.defaultOptions={...e5.defaultOptions,lineDelimiter:"\n",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE},e5.registerType("CSV",e9);let{addEvent:e8,fireEvent:e7,merge:te}=j;class tt{benchmark(e,t){let i=[],n=this,r=()=>{n.modifyTable(e),n.emit({type:"afterBenchmarkIteration"})},{iterations:o}=te({iterations:1},t);n.on("afterBenchmarkIteration",()=>{if(i.length===o)return void n.emit({type:"afterBenchmark",results:i});r()});let s={startTime:0,endTime:0};return n.on("modify",()=>{s.startTime=window.performance.now()}),n.on("afterModify",()=>{s.endTime=window.performance.now(),i.push(s.endTime-s.startTime)}),r(),i}emit(e){e7(this,e.type,e)}modify(e,t){let i=this;return new Promise((n,r)=>{e.modified||(e.modified=e.clone(!1,t));try{n(i.modifyTable(e,t))}catch(n){i.emit({type:"error",detail:t,table:e}),r(n instanceof Error?n:Error(""+n))}})}on(e,t){return e8(this,e,t)}}!function(e){e.types={},e.registerType=function(t,i){return!!t&&!e.types[t]&&!!(e.types[t]=i)}}(tt||(tt={}));let ti=tt;!function(e){e.setLength=function(e,t,i){return Array.isArray(e)?(e.length=t,e):e[i?"subarray":"slice"](0,t)},e.splice=function(e,t,i,n,r=[]){if(Array.isArray(e))return Array.isArray(r)||(r=Array.from(r)),{removed:e.splice(t,i,...r),array:e};let o=Object.getPrototypeOf(e).constructor,s=e[n?"subarray":"slice"](t,t+i),a=new o(e.length-i+r.length);return a.set(e.subarray(0,t),0),a.set(r,t),a.set(e.subarray(t+i),t+r.length),{removed:s,array:a}},e.convertToNumber=function(e,t){switch(typeof e){case"boolean":return+!!e;case"number":return isNaN(e)&&!t?null:e;default:return isNaN(e=parseFloat(`${e??""}`))&&!t?null:e}}}(o||(o={}));let tn=o,{setLength:tr,splice:to}=tn,{fireEvent:ts,objectEach:ta,uniqueKey:tl}=j,tc=class{constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||tl(),this.rowCount=0,this.versionTag=tl();let t=0;ta(e.columns||{},(e,i)=>{this.columns[i]=e.slice(),t=Math.max(t,e.length)}),this.applyRowCount(t)}applyRowCount(e){this.rowCount=e,ta(this.columns,(t,i)=>{t.length!==e&&(this.columns[i]=tr(t,e))})}deleteRows(e,t=1){if(t>0&&e<this.rowCount){let i=0;ta(this.columns,(n,r)=>{this.columns[r]=to(n,e,t).array,i=n.length}),this.rowCount=i}ts(this,"afterDeleteRows",{rowIndex:e,rowCount:t}),this.versionTag=tl()}getColumn(e,t){return this.columns[e]}getColumns(e,t){return(e||Object.keys(this.columns)).reduce((e,t)=>(e[t]=this.columns[t],e),{})}getRow(e,t){return(t||Object.keys(this.columns)).map(t=>this.columns[t]?.[e])}setColumn(e,t=[],i=0,n){this.setColumns({[e]:t},i,n)}setColumns(e,t,i){let n=this.rowCount;ta(e,(e,t)=>{this.columns[t]=e.slice(),n=e.length}),this.applyRowCount(n),i?.silent||(ts(this,"afterSetColumns"),this.versionTag=tl())}setRow(e,t=this.rowCount,i,n){let{columns:r}=this,o=i?this.rowCount+1:t+1;ta(e,(e,s)=>{let a=r[s]||n?.addColumns!==!1&&Array(o);a&&(i?a=to(a,t,0,!0,[e]).array:a[t]=e,r[s]=a)}),o>this.rowCount&&this.applyRowCount(o),n?.silent||(ts(this,"afterSetRows"),this.versionTag=tl())}getModified(){return this.modified||this}},{splice:th,setLength:td}=tn,{addEvent:tu,defined:tp,extend:tf,fireEvent:tm,isNumber:tg,uniqueKey:ty}=j;class tb extends tc{constructor(e={}){super(e),this.metadata=e.metadata}clone(e,t){let i={};this.emit({type:"cloneTable",detail:t}),e||(i.columns=this.columns),this.autoId||(i.id=this.id);let n=new tb(i);return e||(n.versionTag=this.versionTag,n.originalRowIndexes=this.originalRowIndexes,n.localRowIndexes=this.localRowIndexes),this.emit({type:"afterCloneTable",detail:t,tableClone:n}),n}deleteColumns(e,t){let i=this.columns,n={},r={},o=this.modifier,s=this.rowCount;if((e=e||Object.keys(i)).length){this.emit({type:"deleteColumns",columnIds:e,detail:t});for(let t=0,o=e.length,a,l;t<o;++t)(a=i[l=e[t]])&&(n[l]=a,r[l]=Array(s)),delete i[l];return Object.keys(i).length||(this.rowCount=0,this.deleteRowIndexReferences()),o&&o.modifyTable(this),this.emit({type:"afterDeleteColumns",columns:n,columnIds:e,detail:t}),n}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(e,t=1,i){let n=[],r=[],o=this.modifier;if(this.emit({type:"deleteRows",detail:i,rowCount:t,rowIndex:e||0}),void 0===e&&(e=0,t=this.rowCount),t>0&&e<this.rowCount){let i=this.columns,o=Object.keys(i);for(let s=0,a=o.length,l,c,h;s<a;++s){let d=th(l=i[h=o[s]],e,t);c=d.removed,i[h]=l=d.array,s||(this.rowCount=l.length);for(let e=0,t=c.length;e<t;++e)n[e]=n[e]||[],n[e][s]=c[e];r.push(Array(a))}}return o&&o.modifyTable(this),this.emit({type:"afterDeleteRows",detail:i,rowCount:t,rowIndex:e||0,rows:n}),n}emit(e){["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)&&(this.versionTag=ty()),tm(this,e.type,e)}getCell(e,t){let i=this.columns[e];if(i)return i[t]}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnIds(){return Object.keys(this.columns)}getColumns(e,t,i){let n=this.columns,r={};e=e||Object.keys(n);for(let o=0,s=e.length,a,l;o<s;++o)(a=n[l=e[o]])&&(t?r[l]=a:i&&!Array.isArray(a)?r[l]=Array.from(a):r[l]=a.slice());return r}getLocalRowIndex(e){let{localRowIndexes:t}=this;return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){let{originalRowIndexes:t}=this;return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,i){let n=this.columns[e];if(n){let e=-1;if(Array.isArray(n)?e=n.indexOf(t,i):tg(t)&&(e=n.indexOf(t,i)),-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(e=0,t=this.rowCount-e,i){let n=this.columns,r=Array(t);i=i||Object.keys(n);for(let o=e,s=0,a=Math.min(this.rowCount,e+t),l,c;o<a;++o,++s)for(let e of(c=r[s]={},i))l=n[e],c[e]=l?l[o]:void 0;return r}getRows(e=0,t=this.rowCount-e,i){let n=this.columns,r=Array(t);i=i||Object.keys(n);for(let o=e,s=0,a=Math.min(this.rowCount,e+t),l,c;o<a;++o,++s)for(let e of(c=r[s]=[],i))l=n[e],c.push(l?l[o]:void 0);return r}getVersionTag(){return this.versionTag}hasColumns(e){let t=this.columns;for(let i=0,n=e.length;i<n;++i)if(!t[e[i]])return!1;return!0}hasRowWith(e,t){let i=this.columns[e];return Array.isArray(i)?-1!==i.indexOf(t):!!(tp(t)&&Number.isFinite(t))&&-1!==i.indexOf(+t)}on(e,t){return tu(this,e,t)}changeColumnId(e,t){let i=this.columns;return!!i[e]&&(e!==t&&(i[t]=i[e],delete i[e]),!0)}setCell(e,t,i,n){let r=this.columns,o=this.modifier,s=r[e];s&&s[t]===i||(this.emit({type:"setCell",cellValue:i,columnId:e,detail:n,rowIndex:t}),s||(s=r[e]=Array(this.rowCount)),t>=this.rowCount&&(this.rowCount=t+1),s[t]=i,o&&o.modifyTable(this),this.emit({type:"afterSetCell",cellValue:i,columnId:e,detail:n,rowIndex:t}))}setColumns(e,t,i,n){let r=this.columns,o=this.modifier,s=Object.keys(e),a=this.rowCount;if(this.emit({type:"setColumns",columns:e,columnIds:s,detail:i,rowIndex:t}),tp(t)||n){for(let i=0,o=s.length,l,c,h,d;i<o;++i){l=e[h=s[i]],d=Object.getPrototypeOf((c=r[h])&&n?c:l).constructor,c?d===Array?Array.isArray(c)||(c=Array.from(c)):c.length<a&&(c=new d(a)).set(r[h]):c=new d(a),r[h]=c;for(let e=t||0,i=l.length;e<i;++e)c[e]=l[e];a=Math.max(a,l.length)}this.applyRowCount(a)}else super.setColumns(e,t,tf(i,{silent:!0}));o&&o.modifyTable(this),this.emit({type:"afterSetColumns",columns:e,columnIds:s,detail:i,rowIndex:t})}setModifier(e,t){let i=this;return i.emit({type:"setModifier",detail:t,modifier:e,modified:i.getModified()}),i.modifier=e,(e?e.modify(i):Promise.resolve(i)).then(i=>(i.emit({type:"afterSetModifier",detail:t,modifier:e,modified:i.getModified()}),i)).catch(t=>{throw i.emit({type:"setModifierError",error:t,modifier:e,modified:i.getModified()}),t})}setOriginalRowIndexes(e,t=!1){if(this.originalRowIndexes=e,t)return;let i=this.localRowIndexes=[];for(let t=0,n=e.length,r;t<n;++t)tp(r=e[t])&&(i[r]=t)}setRow(e,t,i,n){this.setRows([e],t,i,n)}setRows(e,t=this.rowCount,i,n){let r=this.columns,o=Object.keys(r),s=this.modifier,a=e.length;this.emit({type:"setRows",detail:n,rowCount:a,rowIndex:t,rows:e});for(let n=0,s=t,l;n<a;++n,++s)if(0===Object.keys(l=e[n]).length)for(let e=0,t=o.length;e<t;++e){let t=r[o[e]];i?r[o[e]]=th(t,s,0,!0,[null]).array:t[s]=null}else if(Array.isArray(l))for(let e=0,t=o.length;e<t;++e)r[o[e]][s]=l[e];else super.setRow(l,s,void 0,{silent:!0});let l=i?a+e.length:t+a;if(l>this.rowCount){this.rowCount=l;for(let e=0,t=o.length;e<t;++e){let t=o[e];r[t]=td(r[t],l)}}s&&s.modifyTable(this),this.emit({type:"afterSetRows",detail:n,rowCount:a,rowIndex:t,rows:e})}}let{addEvent:tC,fireEvent:tw,merge:tv,pick:tO}=j;class tx{get polling(){return!!this._polling}constructor(e){this.dataTables={},this.loaded=!1,this.metadata=e.metadata||{columns:{}},this.options=e;let t=e?.dataTables,i=0;if(e.options&&console.error("The `DataConnectorOptions.options` property was removed in Dashboards v4.0.0. Check how to upgrade your connector to use the new options structure here: https://api.highcharts.com/dashboards/#interfaces/Data_DataTableOptions.DataTableOptions-1"),t&&t?.length>0)for(let e=0,n=t.length;e<n;++e){let n=t[e],r=n?.key;this.dataTables[r??i]=new tb(n),!r&&i++}else this.dataTables[0]=new tb({id:e.id})}getTable(e){return e?this.dataTables[e]:Object.values(this.dataTables)[0]}describeColumn(e,t){let i=this.metadata.columns;i[e]=tv(i[e]||{},t)}describeColumns(e){let t,i=Object.keys(e);for(;"string"==typeof(t=i.pop());)this.describeColumn(t,e[t])}getColumnOrder(){let e=this.metadata.columns,t=Object.keys(e||{});if(t.length)return t.sort((t,i)=>tO(e[t].index,0)-tO(e[i].index,0))}getSortedColumns(){return this.getTable().getColumns(this.getColumnOrder())}setColumnOrder(e){for(let t=0,i=e.length;t<i;++t)this.describeColumn(e[t],{index:t})}load(){return this.emit({type:"afterLoad"}),Promise.resolve(this)}async applyTableModifiers(){let e=this.options?.dataTables;for(let[t,i]of Object.entries(this.dataTables)){let n=e?.find(e=>e.key===t)?.dataModifier??this.options?.dataModifier,r=n&&ti.types[n.type];await i.setModifier(r?new r(n):void 0)}return this}startPolling(e=1e3){let t=this;this.pollingController=new AbortController,window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){this.polling&&(this?.pollingController?.abort(),window.clearTimeout(this._polling),delete this._polling)}emit(e){tw(this,e.type,e)}on(e,t){return tC(this,e,t)}initConverters(e,t,i){let n=0;for(let[r,o]of Object.entries(this.dataTables)){let s=t(r),a=i(s,e);o.deleteColumns(),o.setColumns(a),0===n&&(this.converter=s),n++}}}!function(e){e.types={},e.registerType=function(t,i){return!!t&&!e.types[t]&&!!(e.types[t]=i)}}(tx||(tx={}));let tT=tx,{merge:tE,fireEvent:tN}=j;class tM extends tT{constructor(e){let t=tE(tM.defaultOptions,e);super(t),this.options=t,t.enablePolling&&this.startPolling(1e3*Math.max(t.dataRefreshRate||0,1))}emit(e){tN(this,e.type,e)}load(e){let t=this,i=t.options,{csv:n,csvURL:r,dataTables:o,decimalPoint:s}=i;return t.emit({type:"load",csv:n}),Promise.resolve(r?fetch(r,{signal:t?.pollingController?.signal}).then(e=>e.text()):n||"").then(e=>(e&&this.initConverters(e,e=>{let{firstRowAsNames:t=i.firstRowAsNames,beforeParse:n=i.beforeParse}=o?.find(t=>t.key===e)||{};return new e9(tE(i,{decimalPoint:s,firstRowAsNames:t,beforeParse:n}))},(e,t)=>e.parse({csv:t})),t.applyTableModifiers().then(()=>e))).then(i=>(t.emit({type:"afterLoad",detail:e,csv:i}),t)).catch(i=>{throw t.emit({type:"loadError",detail:e,error:i}),i})}}tM.defaultOptions={id:"csv-connector",type:"CSV",csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},tT.registerType("CSV",tM);let{merge:tS,uniqueKey:tA}=j;class tR extends e5{constructor(e){let t=tS(tR.defaultOptions,e);super(t),this.header=[],this.options=t}parse(e,t){let i,n=tS(this.options,e),r=(n.json?.values||[]).map(e=>e.slice());if(0===r.length)return{};this.header=[],this.emit({type:"parse",columns:[],detail:t,headers:this.header});let{beforeParse:o,json:s}=n;o&&s&&(r=o(s.values));for(let e=0,t=r.length;e<t;e++){i=r[e],this.header[e]=n.firstRowAsNames?`${i.shift()}`:tA();for(let t=0,n=i.length;t<n;++t){var a;let n=i[t];a=n,"[object Date]"===Object.prototype.toString.call(a)&&(n=n.getTime()),r[e][t]=n}}return this.emit({type:"afterParse",columns:r,detail:t,headers:this.header}),e0.getColumnsCollection(r,this.header)}}tR.defaultOptions={...e5.defaultOptions},e5.registerType("GoogleSheets",tR);let{merge:tP,pick:tI,fireEvent:tL}=j;class tH extends tT{constructor(e){let t=tP(tH.defaultOptions,e);super(t),this.options=t}emit(e){tL(this,e.type,e)}load(e){let t=this,i=t.options,{dataRefreshRate:n,enablePolling:r,googleAPIKey:o,googleSpreadsheetKey:s,dataTables:a}=i,l=tH.buildFetchURL(o,s,i);if(t.emit({type:"load",detail:e,url:l}),!URL.canParse(l))throw Error("Invalid URL: "+l);return fetch(l,{signal:t?.pollingController?.signal}).then(e=>e.json()).then(e=>{if("object"==typeof e&&e&&"object"==typeof e.error&&e.error&&"number"==typeof e.error.code&&"string"==typeof e.error.message&&"string"==typeof e.error.status)throw Error(e.error.message);return this.initConverters(e,e=>{let{firstRowAsNames:t=i.firstRowAsNames,beforeParse:n=i.beforeParse}=a?.find(t=>t.key===e)||{};return new tR({firstRowAsNames:t,beforeParse:n})},(e,t)=>e.parse({json:t})),t.applyTableModifiers()}).then(()=>(t.emit({type:"afterLoad",detail:e,url:l}),r&&setTimeout(()=>t.load(),1e3*Math.max(n||0,1)),t)).catch(i=>{throw t.emit({type:"loadError",detail:e,error:i}),i})}}tH.defaultOptions={id:"google-sheets-connector",type:"GoogleSheets",googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0},function(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function i(e={}){let{endColumn:n,endRow:r,googleSpreadsheetRange:o,startColumn:s,startRow:a}=e;return o||(t[s||0]||"A")+(Math.max(a||0,0)+1)+":"+(t[tI(n,25)]||"Z")+(r?Math.max(r,0):"Z")}e.buildFetchURL=function(e,t,n={}){let r=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`),o=n.onlyColumnIds?"A1:Z1":i(n);r.pathname+=o;let s=r.searchParams;return s.set("alt","json"),n.onlyColumnIds||(s.set("dateTimeRenderOption","FORMATTED_STRING"),s.set("majorDimension","COLUMNS"),s.set("valueRenderOption","UNFORMATTED_VALUE")),s.set("prettyPrint","false"),s.set("key",e),r.href},e.buildQueryRange=i}(tH||(tH={})),tT.registerType("GoogleSheets",tH);let tk=tH,{merge:tD}=j;class tF extends e5{constructor(e){let t=tD(tF.defaultOptions,e);super(t),this.headers=[],this.options=t,t.tableElement&&(this.tableElement=t.tableElement,this.tableElementID=t.tableElement.id)}export(e,t=this.options){let i=!1!==t.firstRowAsNames,n=t.useMultiLevelHeaders,r=e.getSortedColumns(),o=Object.keys(r),s=[],a=o.length,l=[],c="";if(i){let e=[];if(n){for(let t of o){let i=r[t];Array.isArray(i)||(i=Array.from(i));let n=(i.shift()||"").toString();r[t]=i,e.push(n)}c=this.getTableHeaderHTML(o,e,t)}else c=this.getTableHeaderHTML(void 0,o,t)}for(let e=0;e<a;e++){let t=r[o[e]],i=t.length;for(let n=0;n<i;n++){let i=t[n];l[n]||(l[n]=[]),"string"!=typeof i&&"number"!=typeof i&&void 0!==i&&(i=(i||"").toString()),l[n][e]=this.getCellHTMLFromValue(e?"td":"th",null,e?"":'scope="row"',i),e===a-1&&s.push("<tr>"+l[n].join("")+"</tr>")}}let h="";return t.tableCaption&&(h='<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>"),"<table>"+h+c+"<tbody>"+s.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,i,n,r){let o=n,s="text"+(t?" "+t:"");return"number"==typeof o?(o=o.toString(),","===r&&(o=o.replace(".",r)),s="number"):n||(o="",s="empty"),"<"+e+(i?" "+i:"")+' class="'+s+'">'+o+"</"+e+">"}getTableHeaderHTML(e=[],t=[],i=this.options){let{useMultiLevelHeaders:n,useRowspanHeaders:r}=i,o="<thead>",s=0,a=t&&t.length,l,c=0,h;if(n&&e&&t&&!function(e,t){let i=e.length;if(t.length!==i)return!1;for(;--i;)if(e[i]!==t[i])return!1;return!0}(e,t)){for(o+="<tr>";s<a;++s)(l=e[s])===e[s+1]?++c:c?(o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(c+1)+'"',l),c=0):(l===t[s]?r?(h=2,t.splice(s,1)):(h=1,t[s]=""):h=1,o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(h>1?' valign="top" rowspan="'+h+'"':""),l));o+="</tr>"}if(t){for(o+="<tr>",s=0,a=t.length;s<a;++s)void 0!==t[s]&&(o+=this.getCellHTMLFromValue("th",null,'scope="col"',t[s]));o+="</tr>"}return o+"</thead>"}parse(e,t){let i=[],n=[],r=tD(this.options,e),{endRow:o,startColumn:s,endColumn:a,firstRowAsNames:l}=r,c=r.tableElement||this.tableElement;if(!(c instanceof HTMLElement))return this.emit({type:"parseError",columns:i,detail:t,headers:n,error:"Not a valid HTML Table"}),{};this.tableElement=c,this.tableElementID=c.id,this.emit({type:"parse",columns:i,detail:t,headers:this.headers});let h=c.getElementsByTagName("tr"),d=h.length,u=0,p,{startRow:f}=r;if(l&&d){let e=h[0].children,t=e.length;for(let i=s;i<t&&!(i>a);i++)("TD"===(p=e[i]).tagName||"TH"===p.tagName)&&n.push(p.innerHTML);f++}for(;u<d;){if(u>=f&&u<=o){let e=h[u].children,t=e.length,n=0;for(;n<t;){let t=n-s,r=i[t];if(("TD"===(p=e[n]).tagName||"TH"===p.tagName)&&n>=s&&n<=a){i[t]||(i[t]=[]);let e=this.convertByType(p.innerHTML);e instanceof Date&&(e=e.getTime()),i[t][u-f]=e;let n=1;for(;u-f>=n&&void 0===r[u-f-n];)r[u-f-n]=null,n++}n++}}u++}return this.headers=n,this.emit({type:"afterParse",columns:i,detail:t,headers:n}),e0.getColumnsCollection(i,this.headers)}}tF.defaultOptions={...e5.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0,startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE},e5.registerType("HTMLTable",tF);let{win:tj}=p,{merge:tz}=j;class t$ extends tT{constructor(e){let t=tz(t$.defaultOptions,e);super(t),this.options=t,this.converter=new tF(t)}async load(e){let t,i=this.options,n=this.converter,r=this.getTable(),o=i.htmlTable;if(this.emit({type:"load",detail:e}),"string"==typeof o?(this.tableID=o,t=tj.document.getElementById(o)):(t=o,this.tableID=t.id),this.tableElement=t||void 0,!this.tableElement){let t="HTML table not provided, or element with ID not found";return this.emit({type:"loadError",detail:e,error:t}),Promise.reject(Error(t))}let s=n.parse(tz({tableElement:this.tableElement},i),e);return r.deleteColumns(),r.setColumns(s),await this.applyTableModifiers(),this.emit({type:"afterLoad",detail:e}),this}}t$.defaultOptions={id:"HTML-table-connector",type:"HTMLTable",htmlTable:""},tT.registerType("HTMLTable",t$);let{error:tV,isArray:tB,merge:tU,objectEach:tY}=j;class t_ extends e5{constructor(e){let t=tU(t_.defaultOptions,e);super(t),this.headerColumnIds=[],this.headers=[],this.options=t}parse(e,t){let{beforeParse:i,orientation:n,firstRowAsNames:r,columnIds:o}=e=tU(this.options,e),s=e.data;if(!s)return{};this.headers=[];let a=[];return this.emit({type:"parse",columns:a,detail:t,headers:this.headers}),i&&(s=i(s)),s=s.slice(),"columns"===n?this.parseColumnsOrientation(a,s,r,o):"rows"===n&&this.parseRowsOrientation(a,s,r,o),this.emit({type:"afterParse",columns:a,detail:t,headers:this.headers}),e0.getColumnsCollection(a,this.headers)}parseColumnsOrientation(e,t,i,n){for(let r=0,o=t.length;r<o;r++){let o=t[r];if(!Array.isArray(o))return;Array.isArray(this.headers)?(i?this.headers.push(`${o.shift()}`):n&&Array.isArray(n)&&this.headers.push(n[r]),e.push(o)):tV("JSONConverter: Invalid `columnIds` option.",!1)}}parseRowsOrientation(e,t,i,n){i?this.headers=t.shift():n&&(this.headerColumnIds=n);for(let r=0,o=t.length;r<o;r++){let o=t[r];tB(o)||(o=this.convertItemToRow(o,n));for(let t=0,n=o.length;t<n;t++)e.length<t+1&&e.push([]),e[t].push(o[t]),i||0!==r||(Array.isArray(this.headerColumnIds)?this.headers.push(this.headerColumnIds[t]||t.toString()):tV("JSONConverter: Invalid `columnIds` option.",!1))}}convertItemToRow(e,t){let i=this;if(t&&!Array.isArray(t)){let n=[];return tY(t,(t,r)=>{n.push(t.reduce((e,t)=>e[t],e)),0>i.headers.indexOf(r)&&i.headers.push(r)}),n}return i.headerColumnIds=Object.keys(e),Object.values(e)}}t_.defaultOptions={...e5.defaultOptions,orientation:"rows"},e5.registerType("JSON",t_);let{merge:tG,fireEvent:tJ}=j;class tW extends tT{constructor(e){let t=tG(tW.defaultOptions,e);super(t),this.options=t,t.enablePolling&&this.startPolling(1e3*Math.max(t.dataRefreshRate||0,1))}emit(e){tJ(this,e.type,e)}load(e){let t=this,i=t.options,{data:n,dataUrl:r,dataTables:o}=i;return t.emit({type:"load",detail:e,data:n}),Promise.resolve(r?fetch(r,{signal:t?.pollingController?.signal}).then(e=>e.json()).catch(i=>{t.emit({type:"loadError",detail:e,error:i}),console.warn(`Unable to fetch data from ${r}.`)}):n||[]).then(async e=>(e&&this.initConverters(e,t=>{let{columnIds:n=i.columnIds,firstRowAsNames:r=i.firstRowAsNames,orientation:s=i.orientation,beforeParse:a=i.beforeParse}=o?.find(e=>e.key===t)||{};return new t_({data:e,columnIds:n,firstRowAsNames:r,orientation:s,beforeParse:a})},(e,t)=>e.parse({data:t})),t.applyTableModifiers().then(()=>e??[]))).then(i=>(t.emit({type:"afterLoad",detail:e,data:i}),t)).catch(i=>{throw t.emit({type:"loadError",detail:e,error:i}),i})}}tW.defaultOptions={type:"JSON",id:"json-connector",data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},tT.registerType("JSON",tW);let{addEvent:tK,fireEvent:tq,merge:tZ}=j;class tX extends ti{constructor(e,...t){super(),this.chain=t,this.options=tZ(tX.defaultOptions,e);let i=this.options.chain||[];for(let e=0,n=i.length,r,o;e<n;++e)(r=i[e]).type&&(o=ti.types[r.type])&&t.push(new o(r))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}async modify(e,t){let i=this.options.reverse?this.chain.slice().reverse():this.chain.slice();e.modified||(e.modified=e.clone(!1,t));let n=e;for(let r=0,o=i.length;r<o;++r){try{await i[r].modify(n,t)}catch(i){throw this.emit({type:"error",detail:t,table:e}),i}n=n.getModified()}return e.modified=n,e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let i=this.options.reverse?this.chain.reverse():this.chain.slice(),n=e.getModified();for(let e=0,r=i.length;e<r;++e)n=i[e].modifyTable(n,t).getModified();return e.modified=n,this.emit({type:"afterModify",detail:t,table:e}),e}remove(e,t){let i=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),i.splice(i.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}emit(e){tq(this,e.type,e)}on(e,t){return tK(this,e,t)}}tX.defaultOptions={type:"Chain"},ti.registerType("Chain",tX);let{merge:tQ}=j;class t0 extends ti{constructor(e){super(),this.options=tQ(t0.defaultOptions,e)}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let i=e.getModified();if(e.hasColumns(["columnIds"])){let t=(e.deleteColumns(["columnIds"])||{}).columnIds||[],n={},r=[];for(let e=0,i=t.length;e<i;++e)r.push(""+t[e]);for(let t=0,i=e.getRowCount(),o;t<i;++t)(o=e.getRow(t))&&(n[r[t]]=o);i.deleteColumns(),i.setColumns(n)}else{let t={};for(let i=0,n=e.getRowCount(),r;i<n;++i)(r=e.getRow(i))&&(t[`${i}`]=r);t.columnIds=e.getColumnIds(),i.deleteColumns(),i.setColumns(t)}return this.emit({type:"afterModify",detail:t,table:e}),e}}t0.defaultOptions={type:"Invert"},ti.registerType("Invert",t0);let{merge:t1}=j;class t2 extends ti{constructor(e){super(),this.options=t1(t2.defaultOptions,e)}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let{start:i,end:n}=this.options;i=Math.max(0,i||0);let r=Math.max((n=Math.min(n||1/0,e.getRowCount()))-i,0),o=e.getModified();return o.deleteRows(),o.setRows(e.getRows(i,r)),o.setOriginalRowIndexes(Array.from({length:r},(t,n)=>e.getOriginalRowIndex(i+n))),this.emit({type:"afterModify",detail:t,table:e}),e}}t2.defaultOptions={type:"Range",start:0,end:1/0},ti.registerType("Range",t2);let{merge:t3}=j;class t6 extends ti{static ascending(e,t){return(e||0)<(t||0)?-1:+((e||0)>(t||0))}static descending(e,t){return(t||0)<(e||0)?-1:+((t||0)>(e||0))}static compareFactory(e,t){return t?"desc"===e?(e,i)=>-t(e,i):t:"asc"===e?t6.ascending:t6.descending}constructor(e){super(),this.options=t3(t6.defaultOptions,e)}getRowReferences(e){let t=e.getRows(),i=[];for(let e=0,n=t.length;e<n;++e)i.push({index:e,row:t[e]});return i}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let i=e.getColumnIds(),n=e.getRowCount(),r=this.getRowReferences(e),{direction:o,orderByColumn:s,orderInColumn:a,compare:l}=this.options,c=t6.compareFactory(o,l),h=i.indexOf(s),d=e.getModified();if(-1!==h&&r.sort((e,t)=>c(e.row[h],t.row[h])),a){let e=[];for(let t=0;t<n;++t)e[r[t].index]=t;d.setColumns({[a]:e})}else{let t,i=[],o=[];for(let s=0;s<n;++s)t=r[s],i.push(e.getOriginalRowIndex(t.index)),o.push(t.row);d.setRows(o,0),d.setOriginalRowIndexes(i)}return this.emit({type:"afterModify",detail:t,table:e}),e}}t6.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},ti.registerType("Sort",t6);let{isFunction:t5,merge:t4}=j;class t9 extends ti{static compile(e){if(t5(e))return e;let t=e.operator;switch(t){case"and":{let t=e.conditions.map(e=>this.compile(e));return(e,i,n)=>t.every(t=>t(e,i,n))}case"or":{let t=e.conditions.map(e=>this.compile(e));return(e,i,n)=>t.some(t=>t(e,i,n))}case"not":{let t=this.compile(e.condition);return(e,i,n)=>!t(e,i,n)}}let{columnId:i,value:n}=e;switch(t){case"==":return e=>e[i]==n;case"===":return e=>e[i]===n;case"!=":return e=>e[i]!=n;case"!==":return e=>e[i]!==n;case">":return e=>(e[i]||0)>(n||0);case">=":return e=>(e[i]||0)>=(n||0);case"<":return e=>(e[i]||0)<(n||0);case"<=":return e=>(e[i]||0)<=(n||0);case"empty":return e=>null===e[i]||""===e[i]}let{ignoreCase:r}=e,o=e=>{let t=""+e;return r??!0?t.toLowerCase():t};return"contains"===t?e=>o(e[i]).includes(o(n)):e=>o(e[i])[t](o(n))}constructor(e){super(),this.options=t4(t9.defaultOptions,e)}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let{condition:i}=this.options;if(!i)return e;let n=t9.compile(i),r=e.getModified(),o=[],s=[];for(let t=0,i=e.getRowCount();t<i;++t){let i=e.getRowObject(t);i&&n(i,e,t)&&(o.push(i),s.push(e.getOriginalRowIndex(t)))}return r.deleteRows(),r.setRows(o),r.setOriginalRowIndexes(s),this.emit({type:"afterModify",detail:t,table:e}),e}}t9.defaultOptions={type:"Filter"},ti.registerType("Filter",t9),function(e){let t={},i={};e.fromJSON=function(e){let n=e.$class;if("string"!=typeof n)throw Error("JSON has no $class property.");let r=t[n];if(r)return r.fromJSON(e);let o=i[n];if(o)return o.fromJSON(e);throw Error(`'${n}' unknown.`)},e.registerClassPrototype=function(e,i){if(t[e])throw Error("A serializer for '"+e+"' is already registered.");t[e]=i},e.registerHelper=function(e){if(i[e.$class])throw Error("A serializer for '"+e.$class+"' is already registered.");i[e.$class]=e},e.toJSON=function(e){let t;if("function"==typeof e.fromJSON&&"function"==typeof e.toJSON)return e.toJSON();let n=Object.keys(i),r=n.length;for(let o=0;o<r;++o)if((t=i[n[o]]).jsonSupportFor(e))return t.toJSON(e);throw Error("Object is not supported.")}}(s||(s={}));let t8=s,t7={$class:"Data.DataTable",fromJSON:function(e){return new tb({columns:e.columns,id:e.id})},jsonSupportFor:function(e){return e instanceof tb},toJSON:function(e){let t={$class:"Data.DataTable",columns:e.getColumns(void 0,!1,!0)};return e.autoId||(t.id=e.id),t}};t8.registerHelper(t7);let{merge:ie}=j;t8.registerHelper({$class:"Data.CSVConnector",fromJSON:function(e){return new tM(e.options)},jsonSupportFor:function(e){return e instanceof tM},toJSON:function(e){let t=ie(e.options);return t.dataTable=t7.toJSON(e.getTable()),{$class:"Data.CSVConnector",options:t}}});let{merge:it}=j;t8.registerHelper({$class:"Data.DataConverter",fromJSON:function(e){return new e5(e.options)},jsonSupportFor:function(e){return e instanceof e5},toJSON:function(e){return{$class:"Data.DataConverter",options:it(e.options)}}});class ii{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,i){let n=this.listenerMap[e]=this.listenerMap[e]||{};return(n[t]=n[t]||[]).push(i),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(e,t,i,n){let r=e.id,o=t.state,s=this.listenerMap[r]&&this.listenerMap[r][o];if(s){let o=this.stateMap[r]=this.stateMap[r]??{},a=o[t.state]||[];n&&(a.length||(o[t.state]=a),-1===ii.getIndex(t,a)&&a.push(t));let l={cursor:t,cursors:a,table:e};i&&(l.event=i);let c=this.emittingRegister,h=this.buildEmittingTag(l);if(c.indexOf(h)>=0)return this;try{this.emittingRegister.push(h);for(let e=0,t=s.length;e<t;++e)s[e].call(this,l)}finally{let e=this.emittingRegister.indexOf(h);e>=0&&this.emittingRegister.splice(e,1)}}return this}remitCursor(e,t){let i=this.stateMap[e]&&this.stateMap[e][t.state];if(i){let e=ii.getIndex(t,i);e>=0&&i.splice(e,1)}return this}removeListener(e,t,i){let n=this.listenerMap[e]&&this.listenerMap[e][t];if(n){let e=n.indexOf(i);e>=0&&n.splice(e,1)}return this}}!function(e){function t(e,t){if("range"===e.type)return e;let i={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(i.columns=[e.column]),i}e.getIndex=function(e,t){if("position"===e.type){for(let i,n=0,r=t.length;n<r;++n)if("position"===(i=t[n]).type&&i.state===e.state&&i.column===e.column&&i.row===e.row)return n}else{let i=JSON.stringify(e.columns);for(let n,r=0,o=t.length;r<o;++r)if("range"===(n=t[r]).type&&n.state===e.state&&n.firstRow===e.firstRow&&n.lastRow===e.lastRow&&JSON.stringify(n.columns)===i)return r}return -1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns)},e.isInRange=function(e,i){"position"===i.type&&(i=t(i)),"position"===e.type&&(e=t(e,i));let n=e.columns,r=i.columns;return e.firstRow>=i.firstRow&&e.lastRow<=i.lastRow&&(!n||!r||n.every(e=>r.indexOf(e)>=0))},e.toPositions=function(e){if("position"===e.type)return[e];let t=e.columns||[],i=[],n=e.state;for(let r=e.firstRow,o=e.lastRow;r<o;++r){if(!t.length){i.push({type:"position",row:r,state:n});continue}for(let e=0,o=t.length;e<o;++e)i.push({type:"position",column:t[e],row:r,state:n})}return i},e.toRange=t}(ii||(ii={}));let ir=ii;t8.registerHelper({$class:"Data.DataCursor",fromJSON:function(e){return new ir(e.stateMap)},jsonSupportFor:function(e){return e instanceof ir},toJSON:function(e){let t,i,n,r,o,s=e.stateMap,a={},l=Object.keys(e.stateMap);for(let e=0,c=l.length;e<c;++e){o=Object.keys(s[n=l[e]]),a[n]={};for(let e=0,l=o.length;e<l;++e){r=o[e],t=s[n][r],a[n][r]=i=[];for(let e=0,n=t.length;e<n;++e)i.push({...t[e]})}}return{$class:"Data.DataCursor",stateMap:a}}});let{merge:io}=j;t8.registerHelper({$class:"Data.GoogleSheetsConnector",fromJSON:function(e){return new tk(e.options||{googleAPIKey:"",googleSpreadsheetKey:""})},jsonSupportFor:function(e){return e instanceof tk},toJSON:function(e){let t=io(e.options);return t.dataTable=t7.toJSON(e.getTable()),{$class:"Data.GoogleSheetsConnector",options:t}}});let{merge:is}=j;t8.registerHelper({$class:"Data.HTMLTableConnector",fromJSON:function(e){return new t$(e.options)},jsonSupportFor:function(e){return e instanceof t$},toJSON:function(e){let t=is(e.options);return t.dataTable=t7.toJSON(e.getTable()),{$class:"Data.HTMLTableConnector",options:t}}});let{merge:ia}=j;!function(e){e.types={},e.registerComponent=function(t,i){return!!t&&!e.types[t]&&!!(e.types[t]=i)}}(a||(a={}));let il=a;class ic extends ea{constructor(e){super(),this.type="cell-html",this.options=e,this.id=e.id,this.container=e.container,this.mountedComponent=e.mountedComponent}destroy(){this.mountedComponent?.destroy(),super.destroy()}setHighlight(){this.container.classList.toggle(et.classNames.cellEditHighlight),this.mountedComponent?.board.container.classList.toggle(et.classNames.dashboardCellEditHighlightActive)}setActiveState(){this.container&&this.container.classList.add(Q.classNames.cellActive)}}!function(e){e.isCellHTML=function(t){return t instanceof e}}(ic||(ic={}));let ih=ic,{addEvent:id,fireEvent:iu}=j;!function(e){function t(e,t){let i;"string"==typeof e&&document.querySelectorAll("#"+e).length>1&&console.warn(`Multiple cells have identical ID %c${e}%c, potentially leading to unexpected behavior. 
Ensure that each cell has a unique ID on the page.`,"font-weight: bold","");let n=t?t.querySelector("#"+e):document.getElementById(e);return null!==n&&iu(n,"bindedGUIElement",{},function(e){i=e.guiElement}),i}async function i(t,i,n){let r=t.states,o=t.events,s=t.renderTo;if(!s)return void console.error("The%c renderTo%c option is required to render the component.","font-weight: bold","");if(i.mountedComponents.filter(e=>e.options.renderTo===s).length>0)return void console.error(`A component has already been declared in the cell %c${s}%c use a different cell.`,"font-weight: bold","");n=n||e.getCell(s,i.container);let a=n?.container||document.querySelector("#"+s);if(!a||!t.type)return void console.error(`The component is unable to find the HTML cell element %c${s}%c to render the content.`,"font-weight: bold","");let l=il.types[t.type];!l&&(console.error(`The component's type %c${t.type}%c does not exist.`,"font-weight: bold",""),n&&(l=il.types.HTML,t.title={text:i.editMode?.lang.errorMessage||"Something went wrong",className:Q.classNamePrefix+"component-title-error "+Q.classNamePrefix+"component-title"}));let c=new l(n,t,i),h=c.load().catch(e=>{console.error(e),c.update({connector:{id:""},title:{text:i.editMode?.lang.errorMessage||"Something went wrong",className:Q.classNamePrefix+"component-title-error "+Q.classNamePrefix+"component-title"}})});return n&&(c.setCell(n),n.mountedComponent=c),i.mountedComponents.push({options:t,component:c,cell:n||new ih({id:s,container:a,mountedComponent:c})}),n&&r?.active?.enabled&&r?.active?.isActive&&(n.setActiveState(),c.isActive=!0),iu(c,"mount"),id(a,"click",()=>{o&&o.click&&o.click.call(c),n&&c&&a&&r?.active?.enabled&&(n.setActiveState(),c.isActive=!0)}),r?.hover?.enabled&&a.classList.add(Q.classNames.cellHover),iu(c,"afterLoad"),h}e.addComponent=i,e.getCell=function(e,i){let n=t(e,i);if(n&&"cell"===n.getType())return n},e.getRow=function(e,i){let n=t(e,i);if(n&&"row"===n.getType())return n},e.getLayout=function(e,i){let n=t(e,i);if(n&&"layout"===n.getType())return n}}(l||(l={}));let ip=l,im=class{constructor(e){this.board=e,this.addTabIndexToCells()}addTabIndexToCells(){let e,t=this.board.mountedComponents;for(let i=0,n=t.length;i<n;++i)(e=t[i].cell)&&e.container&&e.container.setAttribute("tabindex",-1)}},{addEvent:ig,fireEvent:iy,merge:ib}=j;class iC{constructor(e){this.options=ib(iC.defaultOptions,e),this.connectors={},this.waiting={}}emit(e){iy(this,e.type,e)}getConnector(e){let t=this.connectors[e];if(t?.loaded)return Promise.resolve(t);let i=this.waiting[e];if(!i){i=this.waiting[e]=[];let t=this.getConnectorOptions(e);if(!t)throw Error(`Connector '${e}' not found.`);this.loadConnector(t).then(t=>{delete this.waiting[e];for(let e=0,n=i.length;e<n;++e)i[e][0](t)}).catch(t=>{delete this.waiting[e];for(let e=0,n=i.length;e<n;++e)i[e][1](t)})}return new Promise((e,t)=>{i.push([e,t])})}getConnectorIds(){let e=this.options.connectors,t=[];for(let i=0,n=e.length;i<n;++i)t.push(e[i].id);return t}getConnectorOptions(e){let t=this.options.connectors;for(let i=0,n=t.length;i<n;++i)if(t[i].id===e)return t[i]}isNewConnector(e){return!this.connectors[e]}loadConnector(e){return new Promise((t,i)=>{this.emit({type:"load",options:e});let n=tT.types[e.type];if(!n)throw Error(`Connector type not found. (${e.type})`);let r=this.connectors[e.id]=new n(e);r.load().then(({converter:i})=>{r.converter=i,r.loaded=!0,this.emit({type:"afterLoad",options:e}),t(r)}).catch(i)})}cancelPendingRequests(){let{connectors:e}=this;for(let t of Object.keys(e))e[t].stopPolling()}on(e,t){return ig(this,e,t)}setConnectorOptions(e){let t=this.options.connectors,i=this.connectors;this.emit({type:"setConnectorOptions",options:e});for(let i=0,n=t.length;i<n;++i)if(t[i].id===e.id){t.splice(i,1);break}i[e.id]&&(i[e.id].stopPolling(),delete i[e.id]),t.push(e),this.emit({type:"afterSetConnectorOptions",options:e})}}iC.defaultOptions={connectors:[]};let{merge:iw,addEvent:iv,error:iO,objectEach:ix,uniqueKey:iT}=j;class iE{static board(e,t,i){return new iE(e,t).init(i)}constructor(e,t){this.componentTypes=il.types,this.options=iw(iE.defaultOptions,t),this.dataPool=new iC(t.dataPool),this.id=iT(),this.guiEnabled=!!t.gui&&this.options?.gui?.enabled,this.editModeEnabled=!!t.editMode&&this.options?.editMode?.enabled,this.layouts=[],this.mountedComponents=[],this.initContainer(e),this.initEditMode(),this.dataCursor=new ir,this.index=Q.boards.length,Q.boards.push(this),this.a11y=new im(this)}init(e){let t=this.options,i=t.components?this.setComponents(t.components):[];return(this.initEvents(),e)?Promise.all(i).then(()=>(t.events?.mounted?.call(this),this)):(t.events?.mounted?.call(this),this)}initEvents(){let e=this,t=()=>{e.reflow()};if("function"==typeof ResizeObserver)this.resizeObserver=new ResizeObserver(t),this.resizeObserver.observe(e.container);else{let e=iv(window,"resize",t);iv(this,"destroy",e)}}initContainer(e){"string"==typeof e&&(e=window.document.getElementById(e)),e||iO(13,!0),this.container=e}initEditMode(){if(Dashboards.EditMode)this.editMode=new Dashboards.EditMode(this,this.options.editMode);else if(this.editModeEnabled)throw Error("Missing layout.js module")}setComponents(e){let t=[];for(let i=0,n=e.length;i<n;++i)t.push(ip.addComponent(e[i],this));return t}destroy(){let e=this;if(this.dataPool.cancelPendingRequests(),this.guiEnabled)for(let t=0,i=e.layouts?.length;t<i;++t)e.layouts[t].destroy();else for(let t of e.mountedComponents)t.component.destroy();this.resizeObserver?.unobserve(e.container),this.guiEnabled&&e.container?.remove(),ix(e,function(t,i){delete e[i]}),Q.boards[this.index]=void 0}reflow(){if(this.editMode){let e=this.editMode.tools;this.editMode.hideToolbars(["cell","row"]),this.editMode.hideContextPointer(),e.contextMenu&&e.contextMenu.updatePosition(e.contextButtonElement)}}getOptions(){let e={...this.options,components:[]};for(let t=0,i=this.mountedComponents.length;t<i;++t)this.mountedComponents[t].cell&&this.mountedComponents[t].cell.mountedComponent&&e.components?.push(this.mountedComponents[t].component.getOptions());if(this.guiEnabled){e.gui={layouts:[]};for(let t=0,i=this.layouts.length;t<i;++t)e.gui.layouts?.push(this.layouts[t].getOptions())}else delete e.gui;return e}getComponentById(e){return this.mountedComponents.find(t=>t.component.id===e)?.component}getComponentByCellId(e){return this.mountedComponents.find(t=>t.cell.id===e)?.component}}(iE||(iE={})).defaultOptions={gui:{enabled:!0,layoutOptions:{rowClassName:void 0,cellClassName:void 0},layouts:[]},components:[]},il.registerComponent("HTML",eX);let iN=iE,iM={defaultOptions:{},syncPair:{emitter:void 0,handler:function(){if("Grid"!==this.type)return;let e=this,t=this.sync.syncConfig.extremes,i=t.group?":"+t.group:"",{board:n}=e,r=t=>{let i=t.cursor;if("position"===i.type&&e.grid&&"number"==typeof i?.row){let{row:t}=i,{viewport:n}=e.grid,r=n?.dataTable?.getLocalRowIndex(t);void 0!==r&&e.grid.viewport?.scrollToRow(r)}};if(n)return(()=>{let{dataCursor:t}=n;if(!t)return;let o=e.connectorHandlers?.[0]?.connector?.getTable();o&&t.addListener(o.id,"xAxis.extremes.min"+i,r)})(),()=>{let t=e.connectorHandlers?.[0]?.connector?.getTable(),{dataCursor:o}=n;t&&o.removeListener(t.id,"xAxis.extremes.min"+i,r)}}}},{addEvent:iS,removeEvent:iA}=j,iR={defaultOptions:{autoScroll:!1},syncPair:{emitter:function(){if("Grid"!==this.type)return;let{grid:e,board:t}=this,i=this.sync.syncConfig.highlight,n=i.group?":"+i.group:"";if(!t||!e||!i?.enabled)return;let{dataCursor:r}=t,o=this.connectorHandlers[0]?.presentationTable,s=e=>{if(o){let t=e.target;r.emitCursor(o,{type:"position",row:t.row.id,column:t.column.id,state:"point.mouseOver"+n,sourceId:this.id})}},a=e=>{if(o){let t=e.target;r.emitCursor(o,{type:"position",row:t.row.id,column:t.column.id,state:"point.mouseOut"+n,sourceId:this.id})}};return iS(e,"cellMouseOver",s),iS(e,"cellMouseOut",a),function(){iA(e.container,"cellMouseOver",s),iA(e.container,"cellMouseOut",a)}},handler:function(){if("Grid"!==this.type)return;let e=this,{board:t}=e,i=e.sync.syncConfig.highlight,n=i.group?":"+i.group:"";if(!i?.enabled)return;let r=e.connectorHandlers[0]?.presentationTable,o=t=>{let n=t.cursor;if(n.sourceId===e.id||"position"!==n.type)return;let{row:r,column:o}=n,{grid:s}=e,a=s?.viewport;if(void 0===r||!a)return;let l=a.dataTable.getLocalRowIndex(r);void 0!==l&&(i.autoScroll&&a.scrollToRow(l),s.syncRow(l),s.syncColumn(o))},s=t=>{let{grid:i}=e;i&&t.cursor.sourceId!==e.id&&(i.syncColumn(),i.syncRow())};if(t)return(()=>{let{dataCursor:e}=t;e&&r&&(e.addListener(r.id,"point.mouseOver"+n,o),e.addListener(r.id,"point.mouseOut"+n,s))})(),()=>{if(!r)return;let e=t.dataCursor;e.removeListener(r.id,"point.mouseOver"+n,o),e.removeListener(r.id,"point.mouseOut"+n,s)}}}},iP={defaultOptions:{},syncPair:{emitter:void 0,handler:function(){if("Grid"!==this.type)return;let e=this,t=this.sync.syncConfig.visibility,i=t.group?":"+t.group:"",{board:n}=e,r=t=>{let n=t.cursor,r=e.grid;r&&"position"===n.type&&n.column&&r.updateColumn(n.column,{enabled:n.state!=="series.hide"+i})};if(n)return(()=>{let{dataCursor:t}=n;if(!t)return;let o=e.connectorHandlers?.[0]?.presentationTable;o&&(t.addListener(o.id,"series.show"+i,r),t.addListener(o.id,"series.hide"+i,r))})(),()=>{let t=e.connectorHandlers?.[0]?.presentationTable,{dataCursor:o}=n;t&&(o.removeListener(t.id,"series.show"+i,r),o.removeListener(t.id,"series.hide"+i,r))}}}},iI={defaultSyncPairs:{extremes:iM.syncPair,highlight:iR.syncPair,visibility:iP.syncPair},defaultSyncOptions:{extremes:iM.defaultOptions,highlight:iR.defaultOptions,visibility:iP.defaultOptions}},{uniqueKey:iL}=j,iH={gridClassName:"highcharts-grid-container",gridID:"grid-"+iL(),gridOptions:{},editableOptions:[{name:"connectorName",propertyPath:["connector","id"],type:"select"},{name:"title",propertyPath:["title"],type:"input"},{name:"caption",propertyPath:["caption"],type:"input"},{name:"Grid options",type:"nested",nestedOptions:[{name:"General",options:[{name:"Caption/title",propertyPath:["gridOptions","caption","text"],type:"input"},{name:"Columns resizing mode",propertyPath:["gridOptions","rendering","columns","resizing","mode"],type:"select",selectOptions:[{name:"adjacent"},{name:"distributed"},{name:"independent"}]},{name:"Editable Grid",propertyPath:["gridOptions","columnDefaults","cells","editMode","enabled"],type:"toggle"},{name:"Resizable columns",propertyPath:["gridOptions","rendering","columns","resizing","enabled"],type:"toggle"},{name:"Sortable columns",propertyPath:["gridOptions","columnDefaults","sorting","sortable"],type:"toggle"},{name:"Cell text truncation",propertyPath:["gridOptions","rendering","rows","strictHeights"],type:"toggle"}]}]},{name:"Grid class name",propertyPath:["gridClassName"],type:"input"},{name:"Grid ID",propertyPath:["gridID"],type:"input"}],onUpdate:(e,t)=>{let i=e.target;if(i){let e=i.closest(".hcg-row"),n=i.closest(".hcg-cell");if(e&&e instanceof HTMLElement&&n&&n instanceof HTMLElement){let r=e.dataset.rowIndex,{columnId:o}=n.dataset;if(void 0!==r&&void 0!==o){let e=t.getTable();if(e){let t=new e5().convertByType(i.value);t instanceof Date&&(t=t.toString()),e.setCell(o,Number(r),t)}}}}}},{merge:ik,diffObjects:iD,getStyle:iF}=j,{deepClone:ij}=eR;class iz extends eJ{constructor(e,t,i){super(e,t=ik(iz.defaultOptions,t),i),this.options=t,this.type="Grid",this.setOptions()}async update(e){await super.update(e),this.setOptions(),this.grid&&(this.grid.update(e.gridOptions,!1),this.grid?.viewport?.dataTable?.id!==this.getFirstConnector()?.getTable()?.id&&this.grid.update({dataTable:this.getFirstConnector()?.getTable()?.getModified()},!1),this.grid.renderViewport()),this.emit({type:"afterUpdate"})}render(){return super.render(),this.grid?this.grid.renderViewport():this.grid=this.constructGrid(),this.grid.initialContainerHeight=iF(this.parentElement,"height",!0)||0,this.sync.start(),this.emit({type:"afterRender"}),this}resize(e,t){t?this.contentElement.style.minHeight="0":null===t&&this.contentElement.style.removeProperty("min-height"),this.resizeDynamicContent(e,t),this.grid?.viewport?.reflow()}onTableChanged(){let{grid:e}=this;if(!e)return;let t=this.connectorHandlers[0]?.presentationTable;if(!t?.getModified())return void e.update({dataTable:void 0});if(!e.options?.header){let i=t.getModified().getColumnIds(),{columnOptionsMap:n,enabledColumns:r}=e,o=0;for(let s of i)if(n[s]?.options?.enabled!==!1){if(r?.[o]!==s)return void e.update({dataTable:t.getModified()});o++}}e.dataTable=t?.getModified(),e.querying.shouldBeUpdated=!0,e.viewport?.updateRows()}getEditableOptions(){let e=this.options;return ij(ik({gridOptions:this.grid?.options},e),["editableOptions","dataTable"])}getOptionsOnDrop(e){let t=e.editMode.board.dataPool.getConnectorIds(),i={type:"Grid"};return t.length&&(i={...i,connector:{id:t[0]}}),i}getOptions(){let e=ik(this.options);return e.gridOptions=this.grid?.getOptions(),e.connector?.id?delete e.gridOptions?.dataTable:e.gridOptions?.dataTable?.id&&(e.gridOptions.dataTable={columns:e.gridOptions.dataTable.columns}),{...iD(e,iz.defaultOptions),type:"Grid"}}destroy(){this.sync.stop(),this.grid?.destroy(),super.destroy()}setOptions(){let e=this.options,t=e.gridClassName,i=e.gridID;t&&(this.contentElement.classList.value=iH.gridClassName+" "+t),i&&(this.contentElement.id=i)}constructGrid(){let e=iz.GridNamespace;if(!e)throw Error("Grid not connected.");let t=this.connectorHandlers[0]?.presentationTable,i=this.options.gridOptions;if(!i)throw Error("Grid options are not set.");t&&(i.dataTable=t.getModified());let n=new e.Grid(this.contentElement,i);return this.options.gridOptions=n.options,n}}iz.predefinedSyncConfig=iI,iz.defaultOptions=ik(eJ.defaultOptions,iH);let i$={custom:{connectGrid:function(e){iz.GridNamespace=e}},name:"Grid.DashboardsPlugin",onRegister:function(e){let{ComponentRegistry:t}=e;t.registerComponent("Grid",iz)},onUnregister:function(e){}},{addEvent:iV,isString:iB}=j,iU={defaultOptions:{},syncPair:{emitter:function(){if("Highcharts"!==this.type)return;let e=this,t=[],{chart:i,board:n}=e,r=e.connectorHandlers?.[0]?.connector,o=r&&r.getTable(),s=this.sync.syncConfig.extremes,a=s.group?":"+s.group:"",{dataCursor:l}=n;if(o&&i){let n=t=>{let n=!!t.resetSelection;if((!t.trigger||t.trigger&&"dashboards-sync"!==t.trigger)&&!n){let n=t.target,r=Object.keys(e.seriesFromConnector),s=r.length>0?i.get(r[0]):n.series[0];if(s){let i=s.points.filter(e=>e.isInside||!1),c={type:"position",state:`${n.coll}.extremes.min${a}`},h={type:"position",state:`${n.coll}.extremes.max${a}`};if(r.length>0&&"xAxis"===n.coll&&i.length){let t,r=(e.connectorHandlers[0]?.options).columnAssignment;if(r){let e=r.find(e=>e.seriesId===s.options.id);if(e){let i=e.data;t=iB(i)?i:Array.isArray(i)?i[i.length-1]:i.y}}t||(t=n.dateTime&&(o.hasColumns(["x"])?"x":s.options.id??s.name)),c.row=i[0].index,c.column=t,h.row=i[i.length-1].index,h.column=t}l.emitCursor(o,c,t,!0).emitCursor(o,h,t,!0)}}},r=()=>i.axes.map(e=>iV(e,"afterSetExtremes",n)),s=r(),c=()=>{s.forEach(e=>{e()}),s=[]};t.push(iV(i,"selection",e=>{e.resetSelection&&(c(),l.emitCursor(o,{type:"position",state:"chart.zoomOut"+a},e),s.push(...r()))})),t.push(()=>{l.remitCursor(o.id,{type:"position",state:"xAxis.extremes.min"+a}),l.remitCursor(o.id,{type:"position",state:"xAxis.extremes.max"+a}),c()})}return function(){t.forEach(e=>{e()})}},handler:function(){if("Highcharts"!==this.type)return;let e=this,t=this.sync.syncConfig.extremes,i=t.group?":"+t.group:"",{chart:n,board:r}=e;if(n&&r&&n.zooming?.type){let t=n.zooming.type.split("").map(e=>e+"Axis"),o=[];return t.forEach(t=>{let s=e=>{let{cursor:i,event:r}=e;if("position"===i.type){let e=r?.target;if(e&&n){let i=n[t],r=!1;i.forEach(t=>{e.coll===t.coll&&e!==t&&null!==e.min&&null!==e.max&&(t.max!==e.max||t.min!==e.min)&&(t.setExtremes(e.min,e.max,!1,void 0,{trigger:"dashboards-sync"}),r=!0)}),r&&!n.resetZoomButton&&n.showResetZoom(),n.redraw()}}};r&&(()=>{let{dataCursor:a}=r,l=e.connectorHandlers?.[0]?.connector;if(l){let r=l.getTable();a.addListener(r.id,`${t}.extremes.min${i}`,s),a.addListener(r.id,`${t}.extremes.max${i}`,s);let c=()=>{n.zoomOut(),setTimeout(()=>{e.element.querySelectorAll(".highcharts-reset-zoom").forEach(e=>{e.remove()})})};a.addListener(r.id,"chart.zoomOut",c),o.push(()=>{a.removeListener(r.id,`${t}.extremes.min${i}`,s),a.removeListener(r.id,`${t}.extremes.max${i}`,s),a.removeListener(r.id,"chart.zoomOut"+i,c)})}})()}),function(){o.forEach(e=>{e()})}}}}},{error:iY}=eR,i_={defaultOptions:{affectedSeriesId:null,highlightPoint:!0,showTooltip:!0,showCrosshair:!0},syncPair:{emitter:function(){if("Highcharts"!==this.type)return;let e=this,{chart:t,board:i}=e,n=this.sync.syncConfig.highlight,r=n.group?":"+n.group:"";if(!n.enabled||!t)return;let{dataCursor:o}=i;for(let i=0,n=t.series?.length??0;i<n;++i){let n,s=t.series[i],a=s.options.id??"",l=e.seriesFromConnector[a],c=l?.connector?.getTable();if(!c)continue;let h=c?.getModified(),d=l.columnAssignment?.find(e=>e.seriesId===a);if(d){let{data:e}=d;n="string"==typeof e?e:Array.isArray(e)?e[1]:e.y??e.value}n||(n=s.name),s.update({point:{events:{mouseOver:function(){o.emitCursor(c,{type:"position",row:h.getOriginalRowIndex(this.index),column:n,state:"point.mouseOver"+r,sourceId:e.id})},mouseOut:function(){o.emitCursor(c,{type:"position",row:h.getOriginalRowIndex(this.index),column:n,state:"point.mouseOut"+r,sourceId:e.id})}}}},!1)}return t.redraw(),function(){t&&t.series&&(t.series.forEach(e=>{e.update({point:{events:{mouseOver:void 0,mouseOut:void 0}}},!1)}),t.redraw())}},handler:function(){if("Highcharts"!==this.type)return;let e=this,t=this.sync.syncConfig.highlight.group?":"+this.sync.syncConfig.highlight.group:"",{chart:i,board:n}=e,r=t=>{let{table:n,cursor:r}=t,o=this.sync.syncConfig.highlight;if(i&&i.series?.length&&"position"===r.type){let t,s=o.affectedSeriesId;if(o.affectedSeriesId){let e=i.get(o.affectedSeriesId);e?.points?t=e:iY("No series with ID '"+s+"' found in the chart. Affected series will be selected according to the column assignment.")}if(!t){let o=Object.keys(e.seriesFromConnector);for(let s=0,a=o.length;s<a;++s){let a=o[s],l=e.seriesFromConnector[a];if(l?.connector?.getTable()!==n)continue;let c=l.columnAssignment;if(t=i.get(a),!c)break;let{data:h}=c.find(e=>e.seriesId===a)??{};if(!h||!r.column)break;if("string"==typeof h){if(h===r.column)break}else if(Array.isArray(h)){if(h.includes(r.column))break}else if(Object.keys(h).map(e=>h[e]).includes(r.column))break}}let a=r.row;if(t?.visible&&void 0!==a){let e=n.getModified().getLocalRowIndex(a);if(void 0===e)return;let i=t.data[e];if(i?.visible)return i}}},o=t=>{let n=this.sync.syncConfig.highlight;if(!n.enabled||t.cursor.sourceId===e.id)return;let o=r(t);if(!o||!i||!o.isInside&&o.series.isCartesian||o===i.hoverPoint)return;let s=i.tooltip;if(s&&n.showTooltip){let e=s.shared,t=i.hoverPoint,n=t?.series||i.hoverSeries,r=i.pointer?.getHoverData(o,n,i.series,!0,!0);i.tooltip&&r?.hoverPoints.length&&s.refresh(e?r.hoverPoints:o)}n.highlightPoint&&(!s?.shared&&n.showTooltip||!n.showTooltip)&&o.setState("hover"),n.showCrosshair&&(o.series.xAxis?.drawCrosshair(void 0,o),o.series.yAxis?.drawCrosshair(void 0,o))},s=t=>{let n=this.sync.syncConfig.highlight;if(!i||!i.series.length||!n.enabled||t.cursor.sourceId===e.id)return;let o=r(t);if(o&&(!o.isInside&&o.series.isCartesian||o===i.hoverPoint))return;let s=!1,a=()=>{let e=i.series.length;for(let t=0;t<e;t++){let e=i.series[t].points,n=e.length;for(let t=0;t<n;t++)e[t].setState()}},l=i.tooltip;if(l&&n.showTooltip&&(l.hide(),l.shared&&(a(),s=!0)),n.highlightPoint&&!s&&(o?o.setState():a()),n.showCrosshair)if(o)o.series.xAxis?.drawCrosshair(),o.series.yAxis?.drawCrosshair();else{let e=i.xAxis,t=i.yAxis;for(let t=0,i=e.length;t<i;t++)e[t].drawCrosshair();for(let e=0,i=t.length;e<i;e++)t[e].drawCrosshair()}},a=()=>{let{dataCursor:e}=n,{connectorHandlers:i}=this;if(e)for(let n=0,r=i.length;n<r;++n){let r=i[n]?.connector?.getTable();r&&(e.addListener(r.id,"point.mouseOver"+t,o),e.addListener(r.id,"point.mouseOut"+t,s))}},l=()=>{let{dataCursor:e}=n,{connectorHandlers:i}=this;if(e)for(let n=0,r=i.length;n<r;++n){let r=i[n]?.connector?.getTable();r&&(e.removeListener(r.id,"point.mouseOver"+t,o),e.removeListener(r.id,"point.mouseOut"+t,s))}};if(n)return a(),l}}},iG={defaultOptions:{},syncPair:{emitter:function(){if("Highcharts"!==this.type)return;let e=this.sync.syncConfig.visibility,t=e.group?":"+e.group:"",{chart:i,board:n}=this,r=this.getFirstConnector();if(!n||!i)return;let o=r?.getTable();if(o){let{dataCursor:e}=n,{series:r}=i;r.forEach(i=>{i.update({events:{show:function(){e.emitCursor(o,{type:"position",state:"series.show"+t,column:this.name})},hide:function(){e.emitCursor(o,{type:"position",state:"series.hide"+t,column:this.name})}}},!1)}),i.redraw()}return function(){i&&i.series?.length&&(i.series.forEach(e=>{e.update({events:{show:void 0,hide:void 0}},!1)}),i.redraw())}},handler:function(){if("Highcharts"!==this.type)return;let e=this,t=this.sync.syncConfig.visibility,i=t.group?":"+t.group:"",{board:n}=e,r=(e,t)=>{for(let i of e)if(i.name===t)return i},o=t=>{let i=e.chart;if(i&&i.series?.length&&"position"===t.cursor.type&&void 0!==t.cursor.column){let e=r(i.series,t.cursor.column);e&&e.setVisible(!0,!0)}},s=t=>{let i=e.chart;if(i&&i.series?.length&&"position"===t.cursor.type&&void 0!==t.cursor.column){let e=r(i.series,t.cursor.column);e&&e.setVisible(!1,!0)}};if(n)return(()=>{let{dataCursor:t}=n;if(!t)return;let r=e.connectorHandlers?.[0]?.connector?.getTable();r&&(t.addListener(r.id,"series.show"+i,o),t.addListener(r.id,"series.hide"+i,s))})(),()=>{let t=e.connectorHandlers?.[0]?.connector?.getTable();t&&(n.dataCursor.removeListener(t.id,"series.show"+i,o),n.dataCursor.removeListener(t.id,"series.hide"+i,s))}}}},iJ={defaultSyncPairs:{extremes:iU.syncPair,highlight:i_.syncPair,visibility:iG.syncPair},defaultSyncOptions:{extremes:iU.defaultOptions,highlight:i_.defaultOptions,visibility:iG.defaultOptions}},{merge:iW,uniqueKey:iK}=j,iq={allowConnectorUpdate:!0,className:[eJ.defaultOptions.className,`${eJ.defaultOptions.className}-highcharts`].join(" "),chartClassName:"chart-container",chartID:"chart-"+iK(),chartOptions:{series:[]},chartConstructor:"chart",editableOptions:[{name:"connectorName",propertyPath:["connector","id"],type:"select"},...eJ.defaultOptions.editableOptions||[],{name:"chartOptions",type:"nested",nestedOptions:[{name:"chart",options:[{name:"title",propertyPath:["chartOptions","title","text"],type:"input"},{name:"subtitle",propertyPath:["chartOptions","subtitle","text"],type:"input"},{name:"type",propertyPath:["chartOptions","chart","type"],type:"select",selectOptions:[{name:"column",iconURL:"series-types/icon-column.svg"},{name:"line",iconURL:"series-types/icon-line.svg"},{name:"scatter",iconURL:"series-types/icon-scatter.svg"},{name:"pie",iconURL:"series-types/icon-pie.svg"}]}]},{name:"xAxis",options:[{name:"title",propertyPath:["chartOptions","xAxis","title","text"],type:"input"},{name:"type",propertyPath:["chartOptions","xAxis","type"],type:"select",selectOptions:[{name:"linear"},{name:"datetime"},{name:"logarithmic"}]}]},{name:"yAxis",options:[{name:"title",propertyPath:["chartOptions","yAxis","title","text"],type:"input"},{name:"type",propertyPath:["chartOptions","yAxis","type"],type:"select",selectOptions:[{name:"linear"},{name:"datetime"},{name:"logarithmic"}]}]},{name:"legend",showToggle:!0,propertyPath:["chartOptions","legend","enabled"],options:[{name:"align",propertyPath:["chartOptions","legend","align"],type:"select",selectOptions:[{name:"left"},{name:"center"},{name:"right"}]}]},{name:"tooltip",showToggle:!0,propertyPath:["chartOptions","tooltip","enabled"],options:[{name:"split",propertyPath:["chartOptions","tooltip","split"],type:"toggle"}]},{name:"dataLabels",propertyPath:["chartOptions","plotOptions","series","dataLabels","enabled"],showToggle:!0,options:[{name:"align",propertyPath:["chartOptions","plotOptions","series","dataLabels","align"],type:"select",selectOptions:[{name:"left"},{name:"center"},{name:"right"}]}]},{name:"credits",showToggle:!0,propertyPath:["chartOptions","credits","enabled"],options:[{name:"name",propertyPath:["chartOptions","credits","text"],type:"input"},{name:"url",propertyPath:["chartOptions","credits","href"],type:"input"}]}]},{name:"chartConfig",propertyPath:["chartOptions"],type:"textarea"},{name:"chartClassName",propertyPath:["chartClassName"],type:"input"},{name:"chartID",propertyPath:["chartID"],type:"input"}],editableOptionsBindings:iW(eJ.defaultOptions.editableOptionsBindings,{skipRedraw:["chartOptions","chartConfig"]})},{createElement:iZ,diffObjects:iX,isString:iQ,merge:i0,splat:i1}=j,{deepClone:i2}=eR;class i3 extends eJ{constructor(e,t,i){super(e,t=i0(i3.defaultOptions,t),i),this.seriesFromConnector={},this.options=t,this.chartConstructor=this.options.chartConstructor||"chart",this.type="Highcharts",this.chartContainer=iZ("figure",void 0,void 0,this.contentElement,!0),this.setOptions(),this.chartOptions=i0(this.options.chartOptions||{chart:{}},{tooltip:{}}),this.innerResizeTimeouts=[]}onTableChanged(){this.updateSeries()}async load(){return this.emit({type:"load"}),await super.load(),this.emit({type:"afterLoad"}),this}render(){return super.render(),this.chart=this.getChart(),this.updateSeries(),this.emit({type:"afterRender"}),this.setupConnectorUpdate(),this.sync.start(),this}resize(e,t){for(this.resizeDynamicContent(e,t);this.innerResizeTimeouts.length;){let e=this.innerResizeTimeouts.pop();e&&clearTimeout(e)}return this.innerResizeTimeouts.push(setTimeout(()=>{if(this.chart&&this.chart.container){let e=this.contentElement.offsetHeight-this.chart?.container.offsetHeight;this.chart.setSize(null,Math.abs(e)>1?this.contentElement.offsetHeight:null,!1)}},33)),this}setupConnectorUpdate(){let{connectorHandlers:e,chart:t}=this;if(!t||!this.options.allowConnectorUpdate)return;let i=t.series.length;for(let n=0,r=e.length;n<r;n++){let r=e[n];for(let e=0;e<i;e++)t.series[e].update({point:{events:{update:e=>{this.onChartUpdate(e.target,r)}}}},!1)}}onChartUpdate(e,t){let i,n=t.presentationTable,r=t.columnAssignment,o=e.series.options.id,s=new e5,a=e0.asNumber(e.y,s.decimalRegExp);if(n){if(r&&o){let e=r.find(e=>e.seriesId===o)?.data;iQ(e)?i=e:Array.isArray(e)?i=e[1]:e&&(i=e.y??e.value)}i||(i=o??e.series.name),n.setCell(i,e.index,a)}}setOptions(){this.options.chartClassName&&(this.chartContainer.classList.value=iq.className+" "+this.options.chartClassName),this.options.chartID&&(this.chartContainer.id=this.options.chartID)}async update(e,t=!0){await super.update(e,!1),this.setOptions(),this.options.chartConstructor!==this.chartConstructor?(this.chartConstructor=this.options.chartConstructor||"chart",this.chartOptions=this.options.chartOptions||{},this.chart?.destroy(),delete this.chart):this.chart?.update(i0(this.options.chartOptions)||{}),this.emit({type:"afterUpdate"}),t&&this.render()}updateSeries(){let{chart:e}=this,t=this.connectorHandlers;if(!e)return;let i=[];for(let e of t){let t=e.options.columnAssignment,n=e.connector,r=e.options.dataTableKey;if(n&&r&&e.setTable(n.dataTables[r]),!t&&e.presentationTable&&(t=this.getDefaultColumnAssignment(e.presentationTable.getColumnIds(),e.presentationTable)),t)for(let{seriesId:n}of(e.columnAssignment=t,t))n&&i.push(n)}let n=Object.keys(this.seriesFromConnector);for(let t=0,r=n.length;t<r;++t){let r=n[t];if(i.some(e=>e===r))continue;let o=e.get(r);o&&o.destroy()}for(let e of(this.seriesFromConnector={},t))this.updateSeriesFromConnector(e);e.redraw()}updateSeriesFromConnector(e){let t=this.chart;if(!e.connector||!t||!e.presentationTable)return;let i=e.presentationTable.getModified(),n=e.presentationTable.getModifier()?.options,r=e.columnAssignment??[];for(let o=0,s=r.length;o<s;++o){let s=r[o],a=s.data,l=t.get(s.seriesId),c={},h=e=>{n?.type==="Math"&&n.columnFormulas?.some(t=>e(t.column))&&(c.dragDrop={draggableY:!1})};if(iQ(a)){let e=i.getColumn(a);e&&(c.data=e.slice()),h(e=>e===a)}else if(Array.isArray(a))c.data=new tb({columns:i.getColumns(a)}).getRows(),h(e=>a.some(t=>t===e));else{let e=Object.keys(a),t=[];for(let i=0,n=e.length;i<n;++i)t.push(a[e[i]]);let n=new tb({columns:i.getColumns(t)});c.keys=e,c.data=n.getRows(),h(e=>t.some(t=>t===e))}l?l.update(c,!1):t.addSeries({name:s.seriesId,id:s.seriesId,...c},!1),this.seriesFromConnector[s.seriesId]=e}}getChart(){return this.chart||this.createChart()}destroy(){this.chart?.destroy(),super.destroy()}getDefaultColumnAssignment(e=[],t){let i=[],n=t.getColumn(e[0]);if(n&&iQ(n[0])){for(let t=1,n=e.length;t<n;++t)i.push({seriesId:e[t],data:[e[0],e[t]]});return i}for(let t=0,n=e.length;t<n;++t)i.push({seriesId:e[t],data:e[t]});return i}createChart(){let e=i3.charter||Q.win.Highcharts;this.chartConstructor||(this.chartConstructor="chart");let t=e[this.chartConstructor];if(t)try{if("chart"===this.chartConstructor)return e.Chart.chart(this.chartContainer,this.chartOptions);return new t(this.chartContainer,this.chartOptions)}catch(e){throw Error(`The Highcharts component in cell '${this.cell.id}' is misconfigured. 
____________
${e}`)}if("function"!=typeof e.chart)throw Error("Chart constructor not found");return this.chart}registerChartEvents(){if(this.chart&&this.chart.options){let e=this.chart.options;["chart","series","yAxis","xAxis","colorAxis","annotations","navigation"].map(t=>{let i=e[t]||{};return!Array.isArray(i)&&i.events&&(i=[i]),i&&"object"==typeof i&&Array.isArray(i)&&i.reduce((e,i,n)=>(i&&i.events&&(e[i.id||`${t}-${n}`]=i.events),e),{})||{}}).forEach(e=>{Object.keys(e).forEach(t=>{let i=e[t];Object.keys(i).forEach(e=>{this.callbackRegistry.addCallback(`${t}-${e}`,{type:"seriesEvent",func:i[e]})})})})}}getOptionsOnDrop(e){let t=e.editMode.board.dataPool.getConnectorIds(),i={type:"Highcharts",chartOptions:{chart:{animation:!1,type:"column",zooming:{}}}};return t.length&&(i={...i,connector:{id:t[0]}}),i}getOptions(){return{...iX(this.options,i3.defaultOptions),type:"Highcharts"}}getEditableOptions(){let e=this.options,t=this.chart,i=t&&t.options,n=i?.chart?.type||"line";return i2(i0({chartOptions:i},{chartOptions:{yAxis:i1(t&&t.yAxis[0].options),xAxis:i1(t&&t.xAxis[0].options),plotOptions:{series:(i&&i.plotOptions||{})[n]}}},e),["dataTable","points","series","data","editableOptions"])}getEditableOptionValue(e){if(e)return 1===e.length&&"chartOptions"===e[0]?JSON.stringify(this.options.chartOptions,null,2):super.getEditableOptionValue.call(this,e)}}i3.predefinedSyncConfig=iJ,i3.defaultOptions=i0(eJ.defaultOptions,iq);let{defined:i6}=j,i5={defaultOptions:{},syncPair:{emitter:void 0,handler:function(){if("KPI"!==this.type)return;let e=this,t=this.sync.syncConfig.extremes,i=t.group?":"+t.group:"",{board:n}=this,r=t=>{let i=t.cursor;if("position"===i.type&&"number"==typeof i?.row&&i6(i.column)&&e.connectorHandlers?.[0]?.connector&&!i6(e.options.value)){let t=String(e.connectorHandlers[0].connector.getTable().getModified().getCell(i.column,i.row));e.setValue(t)}},o=()=>{let{dataCursor:e}=n;if(!e)return;let t=this.getFirstConnector()?.getTable();t&&e.addListener(t.id,"xAxis.extremes.max"+i,r)},s=()=>{let e=this.getFirstConnector()?.getTable(),{dataCursor:t}=n;e&&t.removeListener(e.id,"xAxis.extremes.max"+i,r)};if(n)return o(),s}}},i4={defaultSyncPairs:{extremes:i5.syncPair},defaultSyncOptions:{extremes:i5.defaultOptions}},i9={type:"KPI",className:[eJ.defaultOptions.className,`${eJ.defaultOptions.className}-kpi`].join(" "),minFontSize:20,thresholdColors:["#f45b5b","#90ed7d"],editableOptions:[{name:"connectorName",propertyPath:["connector","id"],type:"select"},...eJ.defaultOptions.editableOptions||[],{name:"Value",type:"input",propertyPath:["value"]},{name:"Column name",type:"input",propertyPath:["columnId"]},{name:"Value format",type:"input",propertyPath:["valueFormat"]}],linkedValueTo:{enabled:!0,seriesIndex:0,pointIndex:0}},i8=["+","-","*","/","^","=","<","<=",">",">="],{isFormula:i7,isFunction:ne,isOperator:nt,isRange:ni,isReference:nn,isValue:nr}={isFormula:function(e){return Array.isArray(e)},isFunction:function(e){return"object"==typeof e&&!Array.isArray(e)&&"function"===e.type},isOperator:function(e){return"string"==typeof e&&i8.indexOf(e)>=0},isRange:function(e){return"object"==typeof e&&!Array.isArray(e)&&"range"===e.type},isReference:function(e){return"object"==typeof e&&!Array.isArray(e)&&"reference"===e.type},isValue:function(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}},{defined:no}=j,ns=/ */,na=Number.MAX_VALUE/1.000000000001,nl=Number.MAX_VALUE/1.000000000002,nc=Number.MAX_VALUE,nh={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},nd={},nu=/^[A-Z][A-Z\.]*$/;function np(e){switch(typeof e){case"boolean":return e?nc:na;case"string":return nl;case"number":return e;default:return NaN}}function nf(e){return"string"==typeof e?e.toLowerCase().replace(ns,"\0"):e}function nm(e){switch(typeof e){case"boolean":return+!!e;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function ng(e,t){return nr(e)?e:ni(e)?t&&ny(e,t)||[]:ne(e)?nv(e,t):nw(i7(e)?e:[e],t)}function ny(e,t){let i=t.getColumnIds().slice(e.beginColumn,e.endColumn+1),n=[];for(let r=0,o=i.length,s;r<o;++r){let o=t.getColumn(i[r],!0)||[];for(let a=e.beginRow,l=e.endRow+1;a<l;++a)"string"==typeof(s=o[a])&&"="===s[0]&&t!==t.getModified()&&(s=t.getModified().getCell(i[r],a)),n.push(nr(s)?s:NaN)}return n}function nb(e,t){let i=t.getColumnIds()[e.column];if(i){let n=t.getCell(i,e.row);if("string"==typeof n&&"="===n[0]&&t!==t.getModified()){let n=t.getModified().getCell(i,e.row);return nr(n)?n:NaN}if(nr(n))return e.isNegative?-n:n}return NaN}function nC(e,t){(e.length<2||t.length<1)&&e.push(NaN);let i=e.pop(),n=e.pop(),r=t.pop();no(i)&&no(n)&&no(r)?e.push(function(e,t,i){let n;switch(e){case"=":return nf(t)===nf(i);case"<":if(typeof t==typeof i)return nf(t)<nf(i);return np(t)<np(i);case"<=":if(typeof t==typeof i)return nf(t)<=nf(i);return np(t)<=np(i);case">":if(typeof t==typeof i)return nf(t)>nf(i);return np(t)>np(i);case">=":if(typeof t==typeof i)return nf(t)>=nf(i);return np(t)>=np(i)}switch(t=nm(t),i=nm(i),e){case"+":n=t+i;break;case"-":n=t-i;break;case"*":n=t*i;break;case"/":n=t/i;break;case"^":n=Math.pow(t,i);break;default:return NaN}return n%1?Math.round(1e9*n)/1e9:n}(r,n,i)):e.push(NaN)}function nw(e,t){let i=[],n=[],r=!0;for(let o=0,s=e.length;o<s;++o){let s,a=e[o];if(nt(a)){if(r&&"-"===a)i.push(0),n.push("-"),r=!0;else{for(;n.length&&nh[n[n.length-1]]>=nh[a];)nC(i,n);n.push(a),r=!0}continue}if(nr(a))s=a;else if(nn(a))s=t?nb(a,t):NaN;else if(ne(a)){let e=nv(a,t);s=nr(e)?e:NaN}else i7(a)&&(s=nw(a,t));if(void 0===s)return NaN;i.push(s),r=!1}for(;n.length;)nC(i,n);return 1!==i.length?NaN:i[0]}function nv(e,t,i){let n=nd[e.name];if(n)try{return n(e.args,t)}catch{return NaN}let r=Error(`Function "${e.name}" not found.`);throw r.name="FormulaProcessError",r}let nO={asNumber:nm,getArgumentValue:ng,getArgumentsValues:function(e,t){let i=[];for(let n=0,r=e.length;n<r;++n)i.push(ng(e[n],t));return i},getRangeValues:ny,getReferenceValue:nb,processFormula:nw,processorFunctions:nd,registerProcessorFunction:function(e,t){return nu.test(e)&&!nd[e]&&!!(nd[e]=t)},translateReferences:function e(t,i=0,n=0){for(let r=0,o=t.length,s;r<o;++r)Array.isArray(s=t[r])?e(s,i,n):ne(s)?e(s.args,i,n):ni(s)?(s.beginColumnRelative&&(s.beginColumn+=i),s.beginRowRelative&&(s.beginRow+=n),s.endColumnRelative&&(s.endColumn+=i),s.endRowRelative&&(s.endRow+=n)):nn(s)&&(s.columnRelative&&(s.column+=i),s.rowRelative&&(s.row+=n));return t}};function nx(e,t){let i=nO.getArgumentsValues(e,t),n=0;for(let e=0,r=i.length,o;e<r;++e)switch(typeof(o=i[e])){case"number":isNaN(o)||(n+=o);break;case"object":n+=nx(o,t)}return n}nO.registerProcessorFunction("SUM",nx);let{getArgumentsValues:nT}=nO;function nE(e,t){let i=nT(e,t),n=0,r=0;for(let e=0,t=i.length,o;e<t;++e)switch(typeof(o=i[e])){case"number":isNaN(o)||(++n,r+=o);break;case"object":for(let e=0,t=o.length,i;e<t;++e)"number"!=typeof(i=o[e])||isNaN(i)||(++n,r+=i)}return n?r/n:0}function nN(e,t){let i=[],n=nO.getArgumentsValues(e,t);for(let e=0,t=n.length,r;e<t;++e)switch(typeof(r=n[e])){case"number":isNaN(r)||i.push(r);break;case"object":for(let e=0,t=r.length,n;e<t;++e)"number"!=typeof(n=r[e])||isNaN(n)||i.push(n)}let r=i.length;if(!r)return NaN;let o=Math.floor(r/2);return r%2?i[o]:(i[o-1]+i[o])/2}nO.registerProcessorFunction("AVERAGE",nE),nO.registerProcessorFunction("MEDIAN",nN);let{getArgumentsValues:nM}=nO;function nS(e,t){let i=nM(e,t),n=-1/0;for(let e=0,t=i.length,r;e<t;++e)switch(typeof(r=i[e])){case"number":r>n&&(n=r);break;case"object":(r=nS(r))>n&&(n=r)}return isFinite(n)?n:0}nO.registerProcessorFunction("MAX",nS);let{getArgumentsValues:nA}=nO;function nR(e,t){let i=nA(e,t),n=1/0;for(let e=0,t=i.length,r;e<t;++e)switch(typeof(r=i[e])){case"number":r<n&&(n=r);break;case"object":(r=nR(r))<n&&(n=r)}return isFinite(n)?n:0}function nP(e,t){let i=nO.getArgumentsValues(e,t),n=0;for(let e=0,r=i.length,o;e<r;++e)switch(typeof(o=i[e])){case"number":!isNaN(o)&&++n;break;case"object":n+=nP(o,t)}return n}nO.registerProcessorFunction("MIN",nR),nO.registerProcessorFunction("COUNT",nP);let{getArgumentsValues:nI}=nO;function nL(e,t){let i=nI(e,t),n=1,r=!1;for(let e=0,o=i.length,s;e<o;++e)switch(typeof(s=i[e])){case"number":isNaN(s)||(r=!0,n*=s);break;case"object":r=!0,n*=nL(s,t)}return r?n:0}nO.registerProcessorFunction("PRODUCT",nL);let{pageLang:nH,win:nk}=p,{defined:nD,error:nF,extend:nj,isNumber:nz,isObject:n$,isString:nV,merge:nB,objectEach:nU,pad:nY,splat:n_,timeUnits:nG,ucfirst:nJ}=j,nW=p.isSafari&&nk.Intl&&!nk.Intl.DateTimeFormat.prototype.formatRange,nK=class{constructor(e,t){this.options={timezone:"UTC"},this.variableTimezone=!1,this.Date=nk.Date,this.update(e),this.lang=t}update(e={}){this.dTLCache={},this.options=e=nB(!0,this.options,e);let{timezoneOffset:t,useUTC:i,locale:n}=e;this.Date=e.Date||nk.Date||Date;let r=e.timezone;nD(i)&&(r=i?"UTC":void 0),t&&t%60==0&&(r="Etc/GMT"+(t>0?"+":"")+t/60),this.variableTimezone="UTC"!==r&&r?.indexOf("Etc/GMT")!==0,this.timezone=r,this.lang&&n&&(this.lang.locale=n),["months","shortMonths","weekdays","shortWeekdays"].forEach(e=>{let t=/months/i.test(e),i=/short/.test(e),n={timeZone:"UTC"};n[t?"month":"weekday"]=i?"short":"long",this[e]=(t?[0,1,2,3,4,5,6,7,8,9,10,11]:[3,4,5,6,7,8,9]).map(e=>this.dateFormat(n,(t?31:1)*24*36e5*e))})}toParts(e){let[t,i,n,r,o,s,a]=this.dateTimeFormat({weekday:"narrow",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},e,"es").split(/(?:, | |\/|:)/g);return[r,n-1,i,o,s,a,Math.floor(Number(e)||0)%1e3,"DLMXJVS".indexOf(t)].map(Number)}dateTimeFormat(e,t,i=this.options.locale||nH){let n=JSON.stringify(e)+i;nV(e)&&(e=this.str2dtf(e));let r=this.dTLCache[n];if(!r){e.timeZone??(e.timeZone=this.timezone);try{r=new Intl.DateTimeFormat(i,e)}catch(t){/Invalid time zone/i.test(t.message)?(nF(34),e.timeZone="UTC",r=new Intl.DateTimeFormat(i,e)):nF(t.message,!1)}}return this.dTLCache[n]=r,r?.format(t)||""}str2dtf(e,t={}){let i={L:{fractionalSecondDigits:3},S:{second:"2-digit"},M:{minute:"numeric"},H:{hour:"2-digit"},k:{hour:"numeric"},E:{weekday:"narrow"},a:{weekday:"short"},A:{weekday:"long"},d:{day:"2-digit"},e:{day:"numeric"},b:{month:"short"},B:{month:"long"},m:{month:"2-digit"},o:{month:"numeric"},y:{year:"2-digit"},Y:{year:"numeric"}};return Object.keys(i).forEach(n=>{-1!==e.indexOf(n)&&nj(t,i[n])}),t}makeTime(e,t,i=1,n=0,r,o,s){let a=this.Date.UTC(e,t,i,n,r||0,o||0,s||0);if("UTC"!==this.timezone){let e=this.getTimezoneOffset(a);if(a+=e,-1!==[2,3,8,9,10,11].indexOf(t)&&(n<5||n>20)){let t=this.getTimezoneOffset(a);e!==t?a+=t-e:e-36e5!==this.getTimezoneOffset(a-36e5)||nW||(a-=36e5)}}return a}parse(e){if(!nV(e))return e??void 0;let t=(e=e.replace(/\//g,"-").replace(/(GMT|UTC)/,"")).indexOf("Z")>-1||/([+-][0-9]{2}):?[0-9]{2}$/.test(e),i=/^[0-9]{4}-[0-9]{2}(-[0-9]{2}|)$/.test(e);t||i||(e+="Z");let n=Date.parse(e);if(nz(n))return n+(!t||i?this.getTimezoneOffset(n):0)}getTimezoneOffset(e){if("UTC"!==this.timezone){let[t,i,n,r,o=0]=this.dateTimeFormat({timeZoneName:"shortOffset"},e,"en").split(/(GMT|:)/).map(Number),s=-(60*(n+o/60)*6e4);if(nz(s))return s}return 0}dateFormat(e,t,i){let n=this.lang;if(!nD(t)||isNaN(t))return n?.invalidDate||"";if(nV(e=e??"%Y-%m-%d %H:%M:%S")){let i,r=/%\[([a-zA-Z]+)\]/g;for(;i=r.exec(e);)e=e.replace(i[0],this.dateTimeFormat(i[1],t,n?.locale))}if(nV(e)&&-1!==e.indexOf("%")){let i=this,[r,o,s,a,l,c,h,d]=this.toParts(t),u=n?.weekdays||this.weekdays,f=n?.shortWeekdays||this.shortWeekdays,m=n?.months||this.months,g=n?.shortMonths||this.shortMonths;nU(nj({a:f?f[d]:u[d].substr(0,3),A:u[d],d:nY(s),e:nY(s,2," "),w:d,v:n?.weekFrom??"",b:g[o],B:m[o],m:nY(o+1),o:o+1,y:r.toString().substr(2,2),Y:r,H:nY(a),k:a,I:nY(a%12||12),l:a%12||12,M:nY(l),p:a<12?"AM":"PM",P:a<12?"am":"pm",S:nY(c),L:nY(h,3)},p.dateFormats),function(n,r){if(nV(e))for(;-1!==e.indexOf("%"+r);)e=e.replace("%"+r,"function"==typeof n?n.call(i,t):n)})}else if(n$(e)){let i=(this.getTimezoneOffset(t)||0)/36e5,n=this.timezone||"Etc/GMT"+(i>=0?"+":"")+i,{prefix:r="",suffix:o=""}=e;e=r+this.dateTimeFormat(nj({timeZone:n},e),t)+o}return i?nJ(e):e}resolveDTLFormat(e){return n$(e,!0)?n$(e,!0)&&void 0===e.main?{main:e}:e:{main:(e=n_(e))[0],from:e[1],to:e[2]}}getDateFormat(e,t,i,n){let r=this.dateFormat("%m-%d %H:%M:%S.%L",t),o="01-01 00:00:00.000",s={millisecond:15,second:12,minute:9,hour:6,day:3},a="millisecond",l=a;for(a in nG){if(e&&e===nG.week&&+this.dateFormat("%w",t)===i&&r.substr(6)===o.substr(6)){a="week";break}if(e&&nG[a]>e){a=l;break}if(s[a]&&r.substr(s[a])!==o.substr(s[a]))break;"week"!==a&&(l=a)}return this.resolveDTLFormat(n[a]).main}},{defined:nq,extend:nZ,timeUnits:nX}=j,nQ=class extends nK{getTimeTicks(e,t,i,n){let r=this,o=[],s={},{count:a=1,unitRange:l}=e,[c,h,d,u,p,f]=r.toParts(t),m=(t||0)%1e3,g;if(n??(n=1),nq(t)){if(m=l>=nX.second?0:a*Math.floor(m/a),l>=nX.second&&(f=l>=nX.minute?0:a*Math.floor(f/a)),l>=nX.minute&&(p=l>=nX.hour?0:a*Math.floor(p/a)),l>=nX.hour&&(u=l>=nX.day?0:a*Math.floor(u/a)),l>=nX.day&&(d=l>=nX.month?1:Math.max(1,a*Math.floor(d/a))),l>=nX.month&&(h=l>=nX.year?0:a*Math.floor(h/a)),l>=nX.year&&(c-=c%a),l===nX.week){a&&(t=r.makeTime(c,h,d,u,p,f,m));let e=this.dateTimeFormat({timeZone:this.timezone,weekday:"narrow"},t,"es"),i="DLMXJVS".indexOf(e);d+=-i+n+(i<n?-7:0)}t=r.makeTime(c,h,d,u,p,f,m),r.variableTimezone&&nq(i)&&(g=i-t>4*nX.month||r.getTimezoneOffset(t)!==r.getTimezoneOffset(i));let e=t,y=1;for(;e<i;)o.push(e),l===nX.year?e=r.makeTime(c+y*a,0):l===nX.month?e=r.makeTime(c,h+y*a):g&&(l===nX.day||l===nX.week)?e=r.makeTime(c,h,d+y*a*(l===nX.day?1:7)):g&&l===nX.hour&&a>1?e=r.makeTime(c,h,d,u+y*a):e+=l*a,y++;o.push(e),l<=nX.hour&&o.length<1e4&&o.forEach(e=>{e%18e5==0&&"000000000"===r.dateFormat("%H%M%S%L",e)&&(s[e]="day")})}return o.info=nZ(e,{higherRanks:s,totalRange:l*a}),o}},{isTouchDevice:n0}=p,{fireEvent:n1,merge:n2}=j,n3={colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{weekFrom:"week from",chartTitle:"Chart title",locale:void 0,loading:"Loading...",months:void 0,seriesName:"Series {add index 1}",shortMonths:void 0,weekdays:void 0,numericSymbols:["k","M","G","T","P","E"],pieSliceName:"Slice",resetZoom:"Reset zoom",yAxisTitle:"Values",resetZoomTitle:"Reset zoom level 1:1"},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,timezone:"UTC",timezoneOffset:0,useUTC:void 0},chart:{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",margin:15,minScale:.67},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:""},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{color:"#333333",fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:e=>Math.sqrt(1-Math.pow(e-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%[AebHMSL]",second:"%[AebHMS]",minute:"%[AebHM]",hour:"%[AebHM]",day:"%[AebY]",week:"%v %[AebY]",month:"%[BY]",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,position:{x:0,y:3},shared:!1,snap:n0?25:10,headerFormat:'<span style="font-size: 0.8em">{ucfirst point.key}</span><br/>',pointFormat:'<span style="color:{point.color}"></span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}},n6=new nQ(n3.time,n3.lang),{defaultOptions:n5,defaultTime:n4}={defaultOptions:n3,defaultTime:n6,getOptions:function(){return n3},setOptions:function(e){return n1(p,"setOptions",{options:e}),n2(!0,n3,e),e.time&&n6.update(n3.time),e.lang&&"locale"in e.lang&&n6.update({locale:e.lang.locale}),e.lang?.chartTitle&&(n3.title={...n3.title,text:e.lang.chartTitle}),n3}},{pageLang:n9}=p,{extend:n8,getNestedProperty:n7,isArray:re,isNumber:rt,isObject:ri,isString:rn,pick:rr,ucfirst:ro}=j,rs={add:(e,t)=>e+t,divide:(e,t)=>0!==t?e/t:"",eq:(e,t)=>e==t,each:function(e){let t=arguments[arguments.length-1];return!!re(e)&&e.map((i,n)=>rc(t.body,n8(ri(i)?i:{"@this":i},{"@index":n,"@first":0===n,"@last":n===e.length-1}))).join("")},ge:(e,t)=>e>=t,gt:(e,t)=>e>t,if:e=>!!e,le:(e,t)=>e<=t,lt:(e,t)=>e<t,multiply:(e,t)=>e*t,ne:(e,t)=>e!=t,subtract:(e,t)=>e-t,ucfirst:ro,unless:e=>!e},ra={},rl=e=>/^["'].+["']$/.test(e);function rc(e="",t,i){let n=/\{([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= #\(\)]+)\}/g,r=/\(([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= ]+)\)/g,o=[],s=/f$/,a=/\.(\d)/,l=i?.options?.lang||n5.lang,c=i?.time||n4,h=i?.numberFormatter||rh.bind(i),d=(e="")=>{let i;return"true"===e||"false"!==e&&((i=Number(e)).toString()===e?i:rl(e)?e.slice(1,-1):n7(e,t))},u,p,f=0,m;for(;null!==(u=n.exec(e));){let i=u,n=r.exec(u[1]);n&&(u=n,m=!0),p?.isBlock||(p={ctx:t,expression:u[1],find:u[0],isBlock:"#"===u[1].charAt(0),start:u.index,startInner:u.index+u[0].length,length:u[0].length});let s=(p.isBlock?i:u)[1].split(" ")[0].replace("#","");rs[s]&&(p.isBlock&&s===p.fn&&f++,p.fn||(p.fn=s));let a="else"===u[1];if(p.isBlock&&p.fn&&(u[1]===`/${p.fn}`||a))if(f)!a&&f--;else{let t=p.startInner,i=e.substr(t,u.index-t);void 0===p.body?(p.body=i,p.startInner=u.index+u[0].length):p.elseBody=i,p.find+=i+u[0],a||(o.push(p),p=void 0)}else p.isBlock||o.push(p);if(n&&!p?.isBlock)break}return o.forEach(n=>{let o,u,{body:p,elseBody:f,expression:m,fn:g}=n;if(g){let e=[n],r=[],s=m.length,a=0,l;for(u=0;u<=s;u++){let e=m.charAt(u);l||'"'!==e&&"'"!==e?l===e&&(l=""):l=e,l||" "!==e&&u!==s||(r.push(m.substr(a,u-a)),a=u+1)}for(u=rs[g].length;u--;)e.unshift(d(r[u+1]));o=rs[g].apply(t,e),n.isBlock&&"boolean"==typeof o&&(o=rc(o?p:f,t,i))}else{let e=rl(m)?[m]:m.split(":"),t=(o=d(e.shift()||""))%1!=0;if("number"==typeof o&&(e.length||t)){let i=e.join(":");if(s.test(i)||t){let e=parseInt((i.match(a)||["","-1"])[1],10);null!==o&&(o=h(o,e,l.decimalPoint,i.indexOf(",")>-1?l.thousandsSep:""))}else o=c.dateFormat(i,o)}r.lastIndex=0,r.test(n.find)&&rn(o)&&(o=`"${o}"`)}e=e.replace(n.find,rr(o,""))}),m?rc(e,t,i):e}function rh(e,t,i,n){t*=1;let r,o,[s,a]=(e=+e||0).toString().split("e").map(Number),l=this?.options?.lang||n5.lang,c=(e.toString().split(".")[1]||"").split("e")[0].length,h=t,d={};i??(i=l.decimalPoint),n??(n=l.thousandsSep),-1===t?t=Math.min(c,20):rt(t)?t&&a<0&&((o=t+a)>=0?(s=+s.toExponential(o).split("e")[0],t=o):(s=Math.floor(s),e=t<20?+(s*Math.pow(10,a)).toFixed(t):0,a=0)):t=2,a&&(t??(t=2),e=s),rt(t)&&t>=0&&(d.minimumFractionDigits=t,d.maximumFractionDigits=t),""===n&&(d.useGrouping=!1);let u=n||i,p=u?"en":this?.locale||l.locale||n9,f=JSON.stringify(d)+p;return r=(ra[f]??(ra[f]=new Intl.NumberFormat(p,d))).format(e),u&&(r=r.replace(/([,\.])/g,"_$1").replace(/_\,/g,n??",").replace("_.",i??".")),(t||0!=+r)&&(!(a<0)||h)||(r="0"),a&&0!=+r&&(r+="e"+(a<0?"":"+")+a),r}let{format:rd}={dateFormat:function(e,t,i){return n4.dateFormat(e,t,i)},format:rc,helpers:rs,numberFormat:rh},{createElement:ru,css:rp,defined:rf,diffObjects:rm,isArray:rg,isNumber:ry,merge:rb,isFunction:rC}=j;class rw extends eJ{constructor(e,t,i){super(e,t=rb(rw.defaultOptions,t),i),this.options=t,this.type="KPI",this.value=ru("span",{className:`${t.className}-value`},{},this.contentElement),this.subtitle=ru("span",{className:this.getSubtitleClassName()},{},this.contentElement)}async load(){return await super.load(),this.linkValueToChart(),this}resize(e,t){return super.resize(e,t),this.chart&&this.chart.container&&this.chart.reflow(),this}render(){super.render(),this.updateElements();let e=rw.charter?.Chart;return e&&this.options.chartOptions&&!this.chart?(this.chartContainer||(this.chartContainer=ru("div",{className:`${this.options.className}-chart-container`},{padding:"0.1px"},this.contentElement)),this.chart=e.chart(this.chartContainer,rb(rw.defaultChartOptions,this.options.chartOptions))):this.chart&&!this.options.chartOptions&&"chartOptions"in this.options&&(this.chart.destroy(),this.chart=void 0),this.sync.start(),this.emit({type:"afterRender"}),this}async update(e,t=!0){await super.update(e),e.chartOptions&&this.chart&&this.chart.update(e.chartOptions),t&&this.render()}onTableChanged(){this.setValue()}destroy(){this.chart?.destroy(),super.destroy()}getFormulaValue(){let e=this.options.formula,t=this.getFirstConnector(),i=t?.getTable().getModified(),n=i?.getColumn(this.options.columnId);if(!n||!e)return;if(rC(e))return e.call(this,n);let r=Array.isArray(n)?n.slice().filter(rf):Array.from(n);("MIN"===e||"MAX"===e||"MEDIAN"===e)&&(r=r.filter(e=>""!==e&&!isNaN(Number(e)))),"MEDIAN"===e&&r.sort((e,t)=>Number(e)-Number(t));try{return rw.formulaFunctions[e](r)}catch{console.warn("Invalid formula option provided.")}}getValue(){if(rf(this.options.value))return this.options.value;let e=this.getFirstConnector();if(e&&this.options.columnId){if(rf(this.options.formula))return this.getFormulaValue();let t=e.getTable().getModified(),i=t.getColumn(this.options.columnId),n=i?.length||0;return String(t.getCell(this.options.columnId,n-1))}}setValue(e=this.getValue()){let{valueFormat:t,valueFormatter:i}=this.options;if(rf(e)){let n;ry(+e)&&(n=+e),i?e=i.call(this,e):t?e=rd(t,{value:e}):ry(e)&&(e=e.toLocaleString()),X.setElementHTML(this.value,""+e),this.linkValueToChart(n),this.prevValue=n}}linkValueToChart(e=this.getValue()){let t=this.chart,i=this.options.linkedValueTo;if(!t||!i.enabled||!rf(e)||!ry(+e))return;e*=1;let n=t.series[i.seriesIndex??0],r=n?.points[i.pointIndex??0];if(n)return r?void r.update({y:e}):void n.addPoint({y:e});t.addSeries({data:[{y:e}]})}updateElements(){let{style:e,subtitle:t}=this.options;this.setValue(),X.setElementHTML(this.subtitle,this.getSubtitle()),e&&rp(this.element,e),"object"==typeof t&&(t.style&&rp(this.subtitle,t.style),this.subtitle.className=this.getSubtitleClassName()),this.chartContainer&&(this.chartContainer.style.flex=this.options.chartOptions?"1":"0"),this.chart&&this.chart.reflow(),this.value.style.color=this.getValueColor()}getSubtitle(){let{subtitle:e,value:t}=this.options;if("string"==typeof e)return e;if(e){if(ry(this.prevValue)&&ry(t)){let i=t-this.prevValue,n="";if(i>0)n='<span style="color:green">&#9650;</span> +';else{if(!(i<0))return this.subtitle.innerHTML;n='<span style="color:red">&#9660;</span> '}if("diff"===e.type)return n+i.toLocaleString();if("diffpercent"===e.type)return n+rd("{v:,.2f}%",{v:i/this.prevValue*100})}return e.text||""}return""}getSubtitleClassName(){let{subtitle:e}=this.options;return`${eJ.defaultOptions.className}-subtitle`+("object"==typeof e&&e.className||"")}getValueColor(){let{threshold:e,thresholdColors:t,value:i}=this.options;if(t&&e&&ry(i)){if(rg(e)){for(let n=e.length-1;n>=0;n--)if(i>=e[n]){if(n+1<t.length)return t[n+1];return t[t.length-1]}}else if(i>=e)return t[1];return t[0]}return""}getOptionsOnDrop(e){let t=e.editMode.board.dataPool.getConnectorIds(),i={type:"KPI"};return t.length&&(i={...i,connector:{id:t[0]}}),i}getOptions(){return{...rm(this.options,rw.defaultOptions),type:"KPI"}}}rw.defaultOptions=rb(eJ.defaultOptions,i9),rw.predefinedSyncConfig=i4,rw.defaultChartOptions={chart:{type:"spline",zooming:{mouseWheel:{enabled:!1}}},title:{text:void 0},xAxis:{visible:!1},yAxis:{visible:!1,title:{text:null}},legend:{enabled:!1},credits:{enabled:!1},tooltip:{outside:!0},plotOptions:{series:{marker:{enabled:!1}}}},rw.formulaFunctions={SUM:nx,AVERAGE:nE,MEDIAN:nN,MAX:nS,MIN:nR,COUNT:nP,PRODUCT:nL};let rv={type:"Navigator",className:[eJ.defaultOptions.className,`${eJ.defaultOptions.className}-navigator`].join(" "),chartOptions:{chart:{animation:!1,height:200,type:"column",zooming:{mouseWheel:{enabled:!1}}},credits:{enabled:!1},legend:{enabled:!1},navigator:{enabled:!0,outlineWidth:0,series:{animation:!1,lineWidth:0,colorIndex:0},xAxis:{endOnTick:!0,gridZIndex:4,labels:{x:1,y:22},opposite:!0,showFirstLabel:!0,showLastLabel:!0,startOnTick:!0,tickPosition:"inside"},yAxis:{maxPadding:.5}},plotOptions:{series:{borderRadius:0,marker:{enabled:!1},states:{hover:{enabled:!1}}}},scrollbar:{enabled:!0},title:{text:""},tooltip:{enabled:!1},xAxis:{visible:!1,minRange:5e-324},yAxis:{visible:!1}},editableOptions:(eJ.defaultOptions.editableOptions||[]).concat()},{defined:rO}=j;!function(e){e.setRangeOptions=function(e,t,i,n){let r=!1,o=!1;("object"!=typeof e.condition||"and"!==e.condition.operator)&&(e.condition={operator:"and",conditions:[]});let{conditions:s}=e.condition;for(let e=0,a=s.length;e<a;++e){let a=s[e];if(a&&"object"==typeof a&&("<="===a.operator||">="===a.operator)&&a.columnId===t&&("<="===a.operator?(a.value=n,o=!0):(a.value=i,r=!0),r&&o))return}o||s.push({operator:"<=",columnId:t,value:n}),r||s.push({operator:">=",columnId:t,value:i})},e.unsetRangeOptions=function(e,t){if("object"!=typeof e.condition||"and"!==e.condition.operator)return;let{conditions:i}=e.condition;for(let e=0,n=i.length;e<n;++e){let n=i[e];n&&"object"==typeof n&&("<="===n.operator||">="===n.operator)&&n.columnId===t&&i.splice(e,1)[0]}},e.toRange=function(e){let t={};if("object"!=typeof e.condition||"and"!==e.condition.operator)return[];let{conditions:i}=e.condition;for(let e=0,n=i.length;e<n;++e){let n=i[e];if(!n||"object"!=typeof n||"<="!==n.operator&&">="!==n.operator||"string"!=typeof n.columnId||!rO(n.value))continue;let r=n.columnId;t[r]||(t[r]={maxValue:1/0,minValue:-1/0,columnId:r}),"<="===n.operator?t[r].maxValue=n.value:t[r].minValue=n.value}return Object.values(t)}}(c||(c={}));let rx=c,{Filter:rT}=ti.types,{addEvent:rE}=j,rN={defaultOptions:{affectNavigator:!1},syncPair:{emitter:function(){let e;if("Navigator"!==this.type)return;let t=this,i=this.sync.syncConfig.crossfilter,n=i.group?":"+i.group:"",r=async e=>{if(t.connectorHandlers?.[0]?.connector){let i=t.connectorHandlers[0].connector.getTable(),r=t.board.dataCursor,o=t.getColumnAssignment()[0],[s,a]=t.getAxisExtremes(),l=i.getModifier();l instanceof rT?rx.setRangeOptions(l.options,o,s,a):l=new rT({condition:{operator:"and",conditions:[{columnId:o,operator:">=",value:s},{columnId:o,operator:"<=",value:a}]}}),await i.setModifier(l),r.emitCursor(i,{type:"position",column:o,row:i.getRowIndexBy(o,s),state:"crossfilter"+n},e),r.emitCursor(i,{type:"position",column:o,row:i.getRowIndexBy(o,a),state:"crossfilter"+n},e)}};return rE(t.chart.xAxis[0],"afterSetExtremes",function(t){clearTimeout(e),e=setTimeout(r,50,this,t)})},handler:void 0}},{Filter:rM}=ti.types,{addEvent:rS,pick:rA,defined:rR}=j,rP={defaultOptions:{},syncPair:{emitter:function(){let e;if("Navigator"!==this.type)return;let t=this,i=this.sync.syncConfig.extremes,n=i.group?":"+i.group:"",r=e=>{if(t.connectorHandlers?.[0]?.connector){let i=t.connectorHandlers[0].connector.getTable(),r=t.board.dataCursor,o=t.getColumnAssignment()[0],[s,a]=t.getAxisExtremes();r.emitCursor(i,{type:"position",column:o,row:i.getRowIndexBy(o,s),state:"xAxis.extremes.min"+n},e),r.emitCursor(i,{type:"position",column:o,row:i.getRowIndexBy(o,a),state:"xAxis.extremes.max"+n},e)}};return rS(t.chart.xAxis[0],"afterSetExtremes",function(t){clearTimeout(e),e=setTimeout(r,50,this,t)})},handler:function(){if("Navigator"!==this.type)return;let e=this,t=this.sync.syncConfig.extremes,i=t.group?":"+t.group:"",n=e.board.dataCursor,r=t=>{let n=t.cursor;if(!e.connectorHandlers?.[0]?.connector)return;let r=e.connectorHandlers[0].connector.getTable(),o=r.getColumnIds()[0],s=r.getRowCount(),a=0;"range"===n.type?(s=n.lastRow,a=n.firstRow,n.columns&&(o=rA(n.columns[0],o))):n.state==="xAxis.extremes.max"+i?(o=rA(n.column,o),s=rA(n.row,s)):(o=rA(n.column,o),a=rA(n.row,a));let l=r.getModifier();if("string"==typeof o&&l instanceof rM){let e=r.getCell(o,a),t=r.getCell(o,s);rR(t)&&rR(e)&&(rx.setRangeOptions(l.options,o,e,t),r.setModifier(l))}},o=e.connectorHandlers?.[0]?.connector?.getTable();return o&&(n.addListener(o.id,"xAxis.extremes"+i,r),n.addListener(o.id,"xAxis.extremes.max"+i,r),n.addListener(o.id,"xAxis.extremes.min"+i,r)),()=>{let t=e.connectorHandlers?.[0]?.connector?.getTable();t&&(n.removeListener(t.id,"xAxis.extremes"+i,r),n.removeListener(t.id,"xAxis.extremes.max"+i,r),n.removeListener(t.id,"xAxis.extremes.min"+i,r))}}}},rI={defaultSyncPairs:{crossfilter:rN.syncPair,extremes:rP.syncPair},defaultSyncOptions:{crossfilter:rN.defaultOptions,extremes:rP.defaultOptions}},{diffObjects:rL,isNumber:rH,isString:rk,merge:rD,pick:rF}=j;class rj extends eJ{constructor(e,t){super(e,t),this.type="Navigator",this.options=rD(rj.defaultOptions,t);let i=rj.charter.Chart||Q.win.Highcharts;this.chartContainer=Q.win.document.createElement("div"),this.chart=i.chart(this.chartContainer,this.options.chartOptions||{}),this.chartContainer.classList.add(Q.classNamePrefix+"navigator"),this.sync.syncConfig.crossfilter?.enabled&&this.chart.update(rD({navigator:{xAxis:{labels:{format:"{value}"}}}},this.options.chartOptions||{}),!1)}adjustNavigator(){let e=this.chart,t=rF(e.chartHeight,this.contentElement.clientHeight),i=this.contentElement.clientWidth,n={};if((e.chartHeight!==t||e.chartWidth!==i)&&(n.chart={height:t,width:i}),e.navigator){let i=e.navigator,r=i.top-e.plotTop+i.height;i.height!==r&&(n.navigator={handles:{height:Math.round(t/4)},height:r}),Object.keys(n).length&&e.update(n,!1),i.series&&i.series[0]&&i.series[0].update({type:e.series[0].type},!1)}else Object.keys(n).length&&e.update(n,!1)}getColumnAssignment(){let e,t=this.options.columnAssignment??{};for(let i of Object.keys(t))if(null!==(e=t[i]))return[i,e];let i=this.getFirstConnector();if(i){let e=i.getTable().getColumnIds();if(e.length)return[e[0],"y"]}return["","y"]}getOptions(){return{...rL(this.options,rv),type:"Navigator"}}getAxisExtremes(){let e=this.chart.xAxis[0],t=e.getExtremes(),i=rH(t.min)?t.min:t.dataMin,n=rH(t.max)?t.max:t.dataMax;return this.categories?[this.categories[Math.max(0,Math.ceil(i))],this.categories[Math.min(this.categories.length-1,Math.floor(n))]]:e.hasNames?[e.names[Math.ceil(i)],e.names[Math.floor(n)]]:[i,n]}async load(){return await super.load(),this.contentElement.appendChild(this.chartContainer),this.parentElement.appendChild(this.element),this.adjustNavigator(),this.emit({type:"afterLoad"}),this}onTableChanged(){this.renderNavigator()}redrawNavigator(){let e=this.resizeTimeouts;for(let t=0,i=e.length;t<i;++t)clearTimeout(e[t]);e.length=0,e.push(setTimeout(()=>{this.adjustNavigator(),this.chart.redraw()},33))}render(){return super.render(),this.renderNavigator(),this.sync.start(),this.emit({type:"afterRender"}),this}renderNavigator(){let e=this.chart,t=this.getFirstConnector();if(t){let i,n=t.getTable(),r=this.getColumnAssignment(),o=n.getColumn(r[0],!0)||[];i=this.sync.syncConfig.crossfilter?.enabled?this.generateCrossfilterData():o.slice(),e.series[0]?e.series[0].setData(i,!1):e.addSeries({id:n.id,data:i},!1)}this.redrawNavigator()}generateCrossfilterData(){let e,t=this.sync.syncConfig.crossfilter,i=this.getFirstConnector()?.getTable(),n=i?.getColumn(this.getColumnAssignment()[0],!0)||[];if(!i||n.length<1||!t)return[];let r=[],o=[];for(let e=0,t=n.length;e<t;e++){let t=n[e];if(null!==t){if(rH(t)||(t=`${t}`),void 0===this.stringData)this.stringData=rk(t);else if(this.stringData!==rk(t))throw Error("Mixed data types in crossfilter navigator are not supported.");r.push(t),-1===o.indexOf(t)&&o.push(t)}}o.sort((e,t)=>rF(e,NaN)<rF(t,NaN)?-1:+(e!==t));let s=i.getModifier()?.options;if(t.affectNavigator&&s?.type==="Filter"){let t=[],n=[],o=rx.toRange(s);for(let e=0,r=o.length;e<r;e++)o[e].columnId!==this.getColumnAssignment()[0]&&(t.push(o[e]),n.push(i.getColumn(o[e].columnId,!0)||[]));e=[];let a=t.length;for(let i=0,o=r.length;i<o;i++){let o=r[i],s=!0;for(let e=0;e<a;e++){let r=t[e];if(!(n[e][i]>=(r.minValue??-1/0)&&n[e][i]<=(r.maxValue??1/0))){s=!1;break}}s&&e.push(o)}}else e=r;let a=[];if(this.stringData){this.categories=o;for(let e=0,t=o.length;e<t;e++)a.push([e,null])}else for(let e=0,t=o.length;e<t;e++)a.push([o[e],null]);for(let t=0,i=e.length;t<i;t++){let i=o.indexOf(e[t]);a[i][1]=(a[i][1]||0)+1}return a}resize(e,t){return super.resize(e,t),this.redrawNavigator(),this}async update(e,t=!0){let i=this.chart;await super.update(e,!1),e.chartOptions&&i.update(rD(this.sync.syncConfig.crossfilter?.enabled?{navigator:{xAxis:{labels:{format:"{value}"}}}}:{},e.chartOptions),!1),this.emit({type:"afterUpdate"}),t&&this.render()}getOptionsOnDrop(){return{}}}rj.defaultOptions=rD(eJ.defaultOptions,rv),rj.predefinedSyncConfig=rI;let rz={custom:{connectHighcharts:function(e){i3.charter=e,rw.charter=e,rj.charter=e}},name:"Highcharts.DashboardsPlugin",onRegister:function(e){let{ComponentRegistry:t}=e;t.registerComponent("Highcharts",i3),t.registerComponent("KPI",rw),t.registerComponent("Navigator",rj)},onUnregister:function(e){}};!function(e){e.registry={},e.revision=0,e.addPlugin=function(t,i=t.name){let{maxRevision:n,minRevision:r,onRegister:o}=t;if(e.registry[i]){if(i!==t.name)throw Error(`Plugin '${i}' already registered.`);return}if("number"==typeof r&&r>e.revision||"number"==typeof n&&n<e.revision)throw Error(`Plugin '${i}' does not support revision ${e.revision}.`);o({Board:iN,ComponentRegistry:il,Sync:eC,revision:e.revision}),e.registry[i]=t},e.removePlugin=function(t){e.registry[t]&&(e.registry[t].onUnregister({ComponentRegistry:il,Board:iN,Sync:eC,revision:e.revision}),delete e.registry[t])}}(h||(h={}));let r$=h;Q.board=iN.board,Q.addEvent=eR.addEvent,Q.error=eR.error,Q.merge=eR.merge,Q.removeEvent=eR.removeEvent,Q.uniqueKey=eR.uniqueKey,Q.AST=X,Q.Board=iN,Q.Component=eJ,Q.ComponentRegistry=il,Q.DataConnector=tT,Q.DataConverter=e5,Q.DataCursor=ir,Q.DataModifier=ti,Q.DataPool=iC,Q.DataTable=tb,Q.GridPlugin=i$,Q.HighchartsPlugin=rz,Q.PluginHandler=r$,Q.Sync=eC,j.extend(Q,j),Q.win.Dashboards||(Q.win.Dashboards=Q),Q.win.Grid&&(i$.custom.connectGrid(Q.win.Grid),Q.PluginHandler.addPlugin(i$)),Q.win.Highcharts&&(rz.custom.connectHighcharts(Q.win.Highcharts),Q.PluginHandler.addPlugin(rz));let rV=Q;return u.default})());