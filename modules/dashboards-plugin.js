/**
 * Highcharts Dashboards v1.1.3 (2023-11-29)
 *
 * (c) 2009-2023 Highsoft AS
 *
 * License: www.highcharts.com/license
 * */!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("dashboards/modules/dashboards-plugin",["dashboards"],function(e){return t(e),t.Dashboards=e,t}):t("undefined"!=typeof Dashboards?Dashboards:void 0)}(function(t){"use strict";var e=t?t._modules:{};function i(t,e,i,s){t.hasOwnProperty(e)||(t[e]=s.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("DashboardsModuleLoaded",{detail:{path:e,module:t[e]}})))}i(e,"Dashboards/Plugins/DataGridSyncHandlers.js",[e["Core/Utilities.js"]],function(t){let{addEvent:e}=t,i={emitters:{highlightEmitter:["highlightEmitter",function(){if("DataGrid"===this.type){let{dataGrid:t,board:i}=this;if(i){let{dataCursor:s}=i,n=[];if(!t)return;return n.push(e(t.container,"dataGridHover",t=>{let e=this.connector&&this.connector.table;if(e){let i=t.row,n=i.querySelector(`.highcharts-datagrid-cell[data-original-data="${i.dataset.rowXIndex}"]`);s.emitCursor(e,{type:"position",row:parseInt(i.dataset.rowIndex,10),column:n?n.dataset.columnName:void 0,state:"dataGrid.hoverRow"})}})),n.push(e(t.container,"mouseout",()=>{let t=this.connector&&this.connector.table;t&&s.emitCursor(t,{type:"position",state:"dataGrid.hoverOut"})})),function(){n.forEach(t=>t())}}}}]},handlers:{highlightHandler:["highlightHandler",void 0,function(){let{board:t}=this,e=t=>{let e=t.cursor;if("position"===e.type){let{row:t}=e,{dataGrid:i}=this;if(void 0!==t&&i){let e=i.container.querySelector(`.highcharts-datagrid-row[data-row-index="${t}"]`);e&&(i.toggleRowHighlight(e),i.hoveredRow=e)}}},i=()=>{let{dataGrid:t}=this;t&&t.toggleRowHighlight(void 0)},s=()=>{let{dataCursor:s}=t;if(!s)return;let n=this.connector&&this.connector.table;n&&(s.addListener(n.id,"point.mouseOver",e),s.addListener(n.id,"point.mouseOut",i))},n=()=>{let s=t.dataCursor,n=this.connector&&this.connector.table;n&&(s.addListener(n.id,"point.mouseOver",e),s.addListener(n.id,"point.mouseOut",i))};t&&(s(),this.on("setConnector",()=>n()),this.on("afterSetConnector",()=>s()))}],extremesHandler:function(){let{board:t}=this,e=t=>{let e=t.cursor;if("position"===e.type&&this.dataGrid&&"number"==typeof e?.row){let{row:t}=e;this.dataGrid.scrollToRow(t)}},i=()=>{let{dataCursor:i}=t;if(!i)return;let s=this.connector&&this.connector.table;s&&i.addListener(s.id,"xAxis.extremes.min",e)},s=()=>{let i=this.connector&&this.connector.table,{dataCursor:s}=t;i&&s.removeListener(i.id,"xAxis.extremes.min",e)};t&&(i(),this.on("setConnector",()=>s()),this.on("afterSetConnector",()=>i()))},visibilityHandler:function(){let t=this,{board:e}=t,i=e=>{let i=e.cursor,s=t.dataGrid;if(!(s&&"position"===i.type&&i.column))return;let n=i.column;s.update({columns:{[n]:{show:"series.hide"!==i.state}}})},s=()=>{let{dataCursor:t}=e;if(!t)return;let s=this.connector&&this.connector.table;s&&(t.addListener(s.id,"series.show",i),t.addListener(s.id,"series.hide",i))},n=()=>{let t=this.connector&&this.connector.table,{dataCursor:s}=e;t&&(s.removeListener(t.id,"series.show",i),s.removeListener(t.id,"series.hide",i))};e&&(s(),this.on("setConnector",()=>n()),this.on("afterSetConnector",()=>s()))}}},s={highlight:{emitter:i.emitters.highlightEmitter,handler:i.handlers.highlightHandler},extremes:{handler:i.handlers.extremesHandler},visibility:{handler:i.handlers.visibilityHandler}};return s}),i(e,"Dashboards/Plugins/DataGridComponent.js",[e["Dashboards/Components/Component.js"],e["Data/Converters/DataConverter.js"],e["Dashboards/Plugins/DataGridSyncHandlers.js"],e["Core/Utilities.js"]],function(t,e,i,s){let{diffObjects:n,merge:o,uniqueKey:r}=s;class a extends t{static onUpdate(t,i){let s=t.target;if(s){let t=s.closest(".highcharts-datagrid-row"),n=s.closest(".highcharts-datagrid-cell"),o=new e;if(t&&t instanceof HTMLElement&&n&&n instanceof HTMLElement){let e=t.dataset.rowIndex,{columnName:r}=n.dataset;if(void 0!==e&&void 0!==r){let t=i.table;if(t){let i=o.asGuessedType(s.value);i instanceof Date&&(i=i.toString()),t.setCell(r,parseInt(e,10),i)}}}}}static fromJSON(t,e){let i=t.options,s=JSON.parse(t.options.dataGridOptions||""),n=new a(e,o(i,{dataGridOptions:s,syncHandlers:a.syncHandlers}));return n.emit({type:"fromJSON",json:t}),n}constructor(t,e){super(t,e=o(a.defaultOptions,e)),this.connectorListeners=[],this.options=e,this.type="DataGrid",this.options.dataGridClassName&&this.contentElement.classList.add(this.options.dataGridClassName),this.options.dataGridID&&(this.contentElement.id=this.options.dataGridID),this.sync=new a.Sync(this,this.syncHandlers),this.dataGridOptions=this.options.dataGridOptions||{},this.innerResizeTimeouts=[],this.on("afterSetConnector",t=>{this.disableEditingModifiedColumns(t.connector)})}onTableChanged(){this.dataGrid&&!this.dataGrid?.cellInputEl&&this.dataGrid.update({dataTable:this.filterColumns()})}disableEditingModifiedColumns(t){let e=this.getColumnOptions(t);this.dataGrid?.update({columns:e})}getColumnOptions(t){let e=t.options.dataModifier;if(!e||"Math"!==e.type)return{};let i=e.columnFormulas;if(!i)return{};let s={};for(let t=0,e=i.length;t<e;++t){let e=i[t].column;s[e]={editable:!1}}return s}async load(){if(this.emit({type:"load"}),await super.load(),this.connector&&!this.connectorListeners.length){let t=this.connectorListeners;t.push(this.connector.on("afterLoad",t=>{t.table&&this.connector&&this.connector.table.setColumns(t.table.getColumns())})),t.push(this.connector.table.on("afterSetCell",t=>{let e=this.dataGrid,i=!0;if(e){let s=e.rowElements[t.rowIndex],n=[];s&&(n=Array.prototype.slice.call(s.childNodes)),n.forEach(e=>{if(e.childElementCount>0){let s=e.childNodes[0],n="string"==typeof t.cellValue?s.value:+s.value;e.dataset.columnName===t.columnName&&n===t.cellValue&&(i=!1)}})}i&&this.update({})}))}return this.emit({type:"afterLoad"}),this}render(){return super.render(),this.dataGrid||(this.dataGrid=this.constructDataGrid()),this.connector&&this.dataGrid&&this.dataGrid.dataTable.modified!==this.connector.table.modified&&this.dataGrid.update({dataTable:this.filterColumns()}),this.sync.start(),this.emit({type:"afterRender"}),this.setupConnectorUpdate(),this}resize(t,e){this.dataGrid&&super.resize(t,e)}async update(t){if(t.connector?.id!==this.connectorId){let t=this.connectorListeners;for(let e=0,i=t.length;e<i;++e)t[e]();t.length=0}await super.update(t),this.dataGrid&&(this.filterAndAssignSyncOptions(i),this.dataGrid.update(this.options.dataGridOptions||{})),this.emit({type:"afterUpdate"})}constructDataGrid(){if(a.DataGridConstructor){let t=this.connector?this.getColumnOptions(this.connector):{};return this.dataGrid=new a.DataGridConstructor(this.contentElement,{...this.options.dataGridOptions,dataTable:this.options.dataGridOptions?.dataTable||this.filterColumns(),columns:o(t,this.options.dataGridOptions?.columns)}),this.dataGrid}throw Error("DataGrid not connected.")}setupConnectorUpdate(){let{connector:t,dataGrid:e}=this;t&&e&&e.on("cellClick",e=>{"input"in e&&e.input.addEventListener("keyup",e=>this.options.onUpdate(e,t))})}filterColumns(){let t=this.connector?.table.modified,e=this.options.visibleColumns;if(t){if(!e?.length)return t;let i=t.getColumnNames().filter(t=>e?.length>0&&!e.includes(t)),s=t.clone();return s.deleteColumns(i),s}}toJSON(){let t=JSON.stringify(this.options.dataGridOptions),e=super.toJSON(),i={...e,options:{...e.options,dataGridOptions:t}};return this.emit({type:"toJSON",json:i}),i}getOptions(){return{...n(this.options,a.defaultOptions),type:"DataGrid"}}destroy(){this.dataGrid?.containerResizeObserver.disconnect(),super.destroy()}}return a.syncHandlers=i,a.defaultOptions=o(t.defaultOptions,{dataGridClassName:"dataGrid-container",dataGridID:"dataGrid-"+r(),dataGridOptions:{},editableOptions:[{name:"connectorName",propertyPath:["connector","id"],type:"select"}],syncHandlers:i,onUpdate:a.onUpdate}),a}),i(e,"Dashboards/Plugins/DataGridPlugin.js",[e["Dashboards/Plugins/DataGridComponent.js"]],function(t){return{custom:{connectDataGrid:function(e){t.DataGridConstructor=e}},name:"DataGrid.DashboardsPlugin",onRegister:function(e){let{ComponentRegistry:i}=e;i.registerComponent("DataGrid",t)},onUnregister:function(t){let{Sync:e}=t}}}),i(e,"Dashboards/Plugins/HighchartsSyncHandlers.js",[e["Core/Utilities.js"]],function(t){let{addEvent:e}=t;function i(t,e){let{ranges:i}=e;if(i){let e=i.reduce((t,e)=>(e.minValue>t.minValue&&(t=e),t),i[0]),s=t.getRowIndexBy(e.column,e.minValue);if(s)return s}return 0}let s={emitters:{highlightEmitter:["highlightEmitter",function(){if("Highcharts"===this.type){let{chart:t,board:e}=this;if(e){let{dataCursor:s}=e;return this.on("afterRender",()=>{let e=this.connector&&this.connector.table;t&&t.series&&e&&t.series.forEach(t=>{t.update({point:{events:{mouseOver:function(){let n=0,o=e.getModifier();o&&"Range"===o.options.type&&(n=i(e,o.options)),s.emitCursor(e,{type:"position",row:n+this.index,column:t.name,state:"point.mouseOver"})},mouseOut:function(){let n=0,o=e.getModifier();o&&"Range"===o.options.type&&(n=i(e,o.options)),s.emitCursor(e,{type:"position",row:n+this.index,column:t.name,state:"point.mouseOut"})}}}})})}),function(){t&&t.series&&t.series.forEach(t=>{t.update({point:{events:{mouseOver:void 0,mouseOut:void 0}}})})}}}}],seriesVisibilityEmitter:function(){if("Highcharts"===this.type){let t=this;return this.on("afterRender",()=>{let{chart:e,connector:i,board:s}=t,n=i&&i.table;if(n&&s&&e){let{dataCursor:t}=s,{series:i}=e;i.forEach(e=>{e.update({events:{show:function(){t.emitCursor(n,{type:"position",state:"series.show",column:this.name})},hide:function(){t.emitCursor(n,{type:"position",state:"series.hide",column:this.name})}}})})}})}},extremesEmitter:function(){if("Highcharts"===this.type){let t=this,i=[];return this.on("afterRender",()=>{let{chart:s,connector:n,board:o}=t,r=n&&n.table,{dataCursor:a}=o;if(r&&s){let t=t=>{let e=!!t.resetSelection;if((!t.trigger||t.trigger&&"dashboards-sync"!==t.trigger)&&!e){let e=t.target,i=e.series.filter(t=>r.hasColumns([t.name])),[s]=i.length?i:e.series;if(s){let n=s.points.filter(t=>t.isInside||!1),o={type:"position",state:`${e.coll}.extremes.min`},l={type:"position",state:`${e.coll}.extremes.max`};if(i.length&&"xAxis"===e.coll&&n.length){let t=e.dateTime&&r.hasColumns(["x"])?"x":s.name;o.row=n[0].index,o.column=t,l.row=n[n.length-1].index,l.column=t}a.emitCursor(r,o,t,!0).emitCursor(r,l,t,!0)}}},n=()=>s.axes.map(i=>e(i,"afterSetExtremes",t)),o=n(),l=()=>{o.forEach(t=>{t()}),o=[]};i.push(e(s,"selection",t=>{t.resetSelection&&(l(),a.emitCursor(r,{type:"position",state:"chart.zoomOut"},t),o.push(...n()))})),i.push(()=>{a.remitCursor(r.id,{type:"position",state:"xAxis.extremes.min"}),a.remitCursor(r.id,{type:"position",state:"xAxis.extremes.max"}),l()})}}),function(){i.forEach(t=>t())}}}},handlers:{seriesVisibilityHandler:function(){let t=this,{board:e}=this,i=(t,e)=>{for(let i of t)if(i.name===e)return i},s=e=>{let s=t.chart;if(s&&"position"===e.cursor.type&&void 0!==e.cursor.column){let t=i(s.series,e.cursor.column);t&&t.setVisible(!0,!0)}},n=e=>{let s=t.chart;if(s&&"position"===e.cursor.type&&void 0!==e.cursor.column){let t=i(s.series,e.cursor.column);t&&t.setVisible(!1,!0)}},o=()=>{let{dataCursor:t}=e;if(!t)return;let i=this.connector&&this.connector.table;i&&(t.addListener(i.id,"series.show",s),t.addListener(i.id,"series.hide",n))},r=()=>{let t=this.connector&&this.connector.table;t&&(e.dataCursor.removeListener(t.id,"series.show",s),e.dataCursor.removeListener(t.id,"series.hide",n))};e&&(o(),this.on("setConnector",()=>r()),this.on("afterSetConnector",()=>o()))},highlightHandler:function(){let{chart:t,board:e}=this,s=e=>{let s=this.connector&&this.connector.table;if(!s)return;let n=0,o=s.getModifier();if(o&&"Range"===o.options.type&&(n=i(s,o.options)),t&&t.series.length){let i=e.cursor;if("position"===i.type){let[e]=t.series.length>1&&i.column?t.series.filter(t=>t.name===i.column):t.series;if(e&&e.visible&&void 0!==i.row){let s=e.points[i.row-n];s&&t.tooltip&&t.tooltip.refresh(s)}}}},n=()=>{t&&t.series.length&&t.tooltip&&t.tooltip.hide()},o=()=>{let{dataCursor:t}=e;if(t){let e=this.connector&&this.connector.table;e&&(t.addListener(e.id,"point.mouseOver",s),t.addListener(e.id,"dataGrid.hoverRow",s),t.addListener(e.id,"point.mouseOut",n),t.addListener(e.id,"dataGrid.hoverOut",n))}},r=()=>{let t=this.connector&&this.connector.table;t&&(e.dataCursor.removeListener(t.id,"point.mouseOver",s),e.dataCursor.removeListener(t.id,"dataGrid.hoverRow",s),e.dataCursor.removeListener(t.id,"point.mouseOut",n),e.dataCursor.removeListener(t.id,"dataGrid.hoverOut",n))};e&&(o(),this.on("setConnector",()=>r()),this.on("afterSetConnector",()=>o()))},extremesHandler:function(){let{chart:t,board:e}=this;if(t&&e&&t.zooming?.type){let i=t.zooming.type.split("").map(t=>t+"Axis");i.forEach(i=>{let s=[],n=e=>{let{cursor:s,event:n}=e;if("position"===s.type){let e=n&&n.target;if(e&&t){let s=t[i],n=!1;s.forEach(t=>{e.coll===t.coll&&e!==t&&null!==e.min&&null!==e.max&&(t.max!==e.max||t.min!==e.min)&&(t.setExtremes(e.min,e.max,!1,void 0,{trigger:"dashboards-sync"}),n=!0)}),n&&!t.resetZoomButton&&t.showResetZoom(),t.redraw()}}},o=()=>{let{dataCursor:o}=e,{connector:r}=this;if(r){let{table:e}=r;o.addListener(e.id,`${i}.extremes.min`,n),o.addListener(e.id,`${i}.extremes.max`,n);let a=()=>{t.zoomOut(),setTimeout(()=>{let t=this.element.querySelectorAll(".highcharts-reset-zoom");t.forEach(t=>{t.remove()})})};o.addListener(e.id,"chart.zoomOut",a),s.push(()=>{o.removeListener(e.id,`${i}.extremes.min`,n),o.removeListener(e.id,`${i}.extremes.max`,n),o.removeListener(e.id,"chart.zoomOut",a)})}},r=()=>{s.forEach(t=>t())};e&&(o(),this.on("setConnector",()=>r()),this.on("afterSetConnector",()=>o()))})}}}},n={extremes:{emitter:s.emitters.extremesEmitter,handler:s.handlers.extremesHandler},highlight:{emitter:s.emitters.highlightEmitter,handler:s.handlers.highlightHandler},visibility:{emitter:s.emitters.seriesVisibilityEmitter,handler:s.handlers.seriesVisibilityHandler}};return n}),i(e,"Dashboards/Plugins/HighchartsComponent.js",[e["Dashboards/Components/Component.js"],e["Data/Converters/DataConverter.js"],e["Data/DataTable.js"],e["Dashboards/Globals.js"],e["Dashboards/Plugins/HighchartsSyncHandlers.js"],e["Core/Utilities.js"]],function(t,e,i,s,n,o){let{addEvent:r,createElement:a,error:l,diffObjects:h,isString:c,merge:d,splat:u,uniqueKey:p}=o;class m extends t{static fromJSON(t,e){let i=t.options,s=JSON.parse(t.options.chartOptions||"{}"),n=new m(e,d(i,{chartOptions:s,syncHandlers:m.syncHandlers}));return n.emit({type:"fromJSON",json:t}),n}constructor(t,e){super(t,e=d(m.defaultOptions,e)),this.options=e,this.chartConstructor=this.options.chartConstructor,this.type="Highcharts",this.chartContainer=a("figure",void 0,void 0,this.contentElement,!0),this.setOptions(),this.sync=new m.Sync(this,this.syncHandlers),this.chartOptions=d(this.options.chartOptions||{chart:{}},{tooltip:{}}),this.connector&&this.connector.on("afterLoad",t=>{t.table&&this.connector&&this.connector.table.setColumns(t.table.getColumns())}),this.innerResizeTimeouts=[]}onTableChanged(){this.updateSeries()}async load(){return this.emit({type:"load"}),await super.load(),this.emit({type:"afterLoad"}),this}render(){return super.render(),this.chart=this.getChart(),this.updateSeries(),this.sync.start(),this.emit({type:"afterRender"}),this.setupConnectorUpdate(),this}resize(t,e){for(super.resize(t,e);this.innerResizeTimeouts.length;){let t=this.innerResizeTimeouts.pop();t&&clearTimeout(t)}return this.innerResizeTimeouts.push(setTimeout(()=>{this.chart&&this.chart.setSize(null,this.contentElement.clientHeight,!1)},33)),this}setupConnectorUpdate(){let{connector:t,chart:e}=this;t&&e&&this.options.allowConnectorUpdate&&e.series.forEach(e=>{e.points.forEach(e=>{r(e,"drag",()=>{this.onChartUpdate(e,t)})})})}setOptions(){this.options.chartClassName&&this.chartContainer.classList.add(this.options.chartClassName),this.options.chartID&&(this.chartContainer.id=this.options.chartID)}onChartUpdate(t,i){let s=i.table,n=t.series.name,o=t.index,r=new e,a=r.asNumber(t.y);s.setCell(n,o,a)}async update(t,e=!0){await super.update(t,!1),this.setOptions(),this.filterAndAssignSyncOptions(n),this.chart&&this.chart.update(d(this.options.chartOptions)||{}),this.emit({type:"afterUpdate"}),e&&this.render()}updateSeries(){if(this.chart&&this.connector){this.presentationTable=this.presentationModifier?this.connector.table.modified.clone():this.connector.table;let{id:t}=this.connector.table,{chart:e}=this;this.presentationModifier&&(this.presentationTable=this.presentationModifier.modifyTable(this.presentationTable).modified);let s=this.presentationTable,n=s.getModifier()?.options,o=s.modified.getColumnNames(),r=this.options.columnAssignment||this.getDefaultColumnAssignment(o),a={};this.emit({type:"afterPresentationModifier",table:s});let l=s.modified.getColumnNames().filter(t=>{let e=!this.activeGroup||!1!==this.activeGroup.getSharedState().getColumnVisibility(t);return!!e&&!!r[t]&&("x"!==r[t]||(a[t]=t,!1))}),h=l.map((i,s)=>{let o=0;for(;o<e.series.length;){let i=e.series[o],n=i.options.id===`${t}-series-${s}`,r=-1!==l.indexOf(i.name);if(o++,r&&n)return i;!r&&n&&i.destroy()}let r=!(n?.type==="Math"&&n.columnFormulas?.some(t=>t.column===i));return e.addSeries({name:i,id:`${t}-series-${s}`,dragDrop:{draggableY:r}},!1)});h.forEach(t=>{let e=Object.keys(a)[0],n=new i({columns:s.modified.getColumns([e,t.name])});n.renameColumn(t.name,"y"),e&&n.renameColumn(e,"x");let o=n.getRowObjects().reduce((t,e)=>(t.push([e.x,e.y]),t),[]);t.setData(o)})}}getChart(){return this.chart||this.createChart()}getDefaultColumnAssignment(t=[]){let e={};for(let i=0,s=t.length;i<s;++i)if(e[t[i]]="y",0===i){let s=this.presentationTable?.getColumn(t[i],!0);s&&c(s[0])&&(e[t[i]]="x")}return e}createChart(){let t=m.charter||s.win.Highcharts;if("chart"!==this.chartConstructor){let e=t[this.chartConstructor];if(e)try{return e(this.chartContainer,this.chartOptions)}catch{l("The Highcharts component is misconfigured: `"+this.cell.id+"`")}}if("function"!=typeof t.chart)throw Error("Chart constructor not found");return this.chart=t.chart(this.chartContainer,this.chartOptions),this.chart}registerChartEvents(){if(this.chart&&this.chart.options){let t=this.chart.options,e=["chart","series","yAxis","xAxis","colorAxis","annotations","navigation"].map(e=>{let i=t[e]||{};return!Array.isArray(i)&&i.events&&(i=[i]),i&&"object"==typeof i&&Array.isArray(i)&&i.reduce((t,i,s)=>(i&&i.events&&(t[i.id||`${e}-${s}`]=i.events),t),{})||{}});e.forEach(t=>{Object.keys(t).forEach(e=>{let i=t[e];Object.keys(i).forEach(t=>{this.callbackRegistry.addCallback(`${e}-${t}`,{type:"seriesEvent",func:i[t]})})})})}}setConnector(t){let e=this.chart;if(this.connector&&e&&e.series&&this.connector.table.id!==t?.table.id){let t=this.connector.table.id;for(let i=e.series.length-1;i>=0;i--){let s=e.series[i];s.options.id?.indexOf(t)!==-1&&s.remove(!1)}}return super.setConnector(t),this}toJSON(){let t=JSON.stringify(this.options.chartOptions),e=this.options.chartConstructor;this.registerChartEvents();let i=super.toJSON(),s={...i,type:"Highcharts",options:{...i.options,chartOptions:t,chartConstructor:e,type:"Highcharts",sync:{}}};return this.emit({type:"toJSON",json:s}),s}getOptions(){return{...h(this.options,m.defaultOptions),type:"Highcharts"}}getEditableOptions(){let t=this.options,e=this.chart,i=e&&e.options,s=i&&i.chart?.type||"line";return d(t,{chartOptions:i},{chartOptions:{yAxis:u(e&&e.yAxis[0].options),xAxis:u(e&&e.xAxis[0].options),plotOptions:{series:(i&&i.plotOptions||{})[s]}}})}getEditableOptionValue(t){return t?1===t.length&&"chartOptions"===t[0]?JSON.stringify(this.options.chartOptions,null,2):super.getEditableOptionValue.call(this,t):void 0}}return m.syncHandlers=n,m.defaultOptions=d(t.defaultOptions,{allowConnectorUpdate:!0,className:[t.defaultOptions.className,`${t.defaultOptions.className}-highcharts`].join(" "),chartClassName:"chart-container",chartID:"chart-"+p(),chartOptions:{chart:{styledMode:!0},series:[]},chartConstructor:"",editableOptions:(t.defaultOptions.editableOptions||[]).concat([{name:"chartOptions",type:"nested",nestedOptions:[{name:"chart",options:[{name:"title",propertyPath:["chartOptions","title","text"],type:"input"},{name:"subtitle",propertyPath:["chartOptions","subtitle","text"],type:"input"},{name:"type",propertyPath:["chartOptions","chart","type"],type:"select",selectOptions:[{name:"column",iconURL:"series-types/icon-column.svg"},{name:"line",iconURL:"series-types/icon-line.svg"},{name:"scatter",iconURL:"series-types/icon-scatter.svg"},{name:"pie",iconURL:"series-types/icon-pie.svg"}]}]},{name:"xAxis",options:[{name:"title",propertyPath:["chartOptions","xAxis","title","text"],type:"input"},{name:"type",propertyPath:["chartOptions","xAxis","type"],type:"select",selectOptions:[{name:"linear"},{name:"datetime"},{name:"logarithmic"}]}]},{name:"yAxis",options:[{name:"title",propertyPath:["chartOptions","yAxis","title","text"],type:"input"},{name:"type",propertyPath:["chartOptions","yAxis","type"],type:"select",selectOptions:[{name:"linear"},{name:"datetime"},{name:"logarithmic"}]}]},{name:"legend",showToggle:!0,propertyPath:["chartOptions","legend","enabled"],options:[{name:"align",propertyPath:["chartOptions","legend","align"],type:"select",selectOptions:[{name:"left"},{name:"center"},{name:"right"}]}]},{name:"tooltip",showToggle:!0,propertyPath:["chartOptions","tooltip","enabled"],options:[{name:"split",propertyPath:["chartOptions","tooltip","split"],type:"toggle"}]},{name:"dataLabels",propertyPath:["chartOptions","plotOptions","series","dataLabels","enabled"],showToggle:!0,options:[{name:"align",propertyPath:["chartOptions","plotOptions","series","dataLabels","align"],type:"select",selectOptions:[{name:"left"},{name:"center"},{name:"right"}]}]},{name:"credits",showToggle:!0,propertyPath:["chartOptions","credits","enabled"],options:[{name:"name",propertyPath:["chartOptions","credits","text"],type:"input"},{name:"url",propertyPath:["chartOptions","credits","href"],type:"input"}]}]},{name:"chartConfig",propertyPath:["chartOptions"],type:"textarea"},{name:"chartClassName",propertyPath:["chartClassName"],type:"input"},{name:"chartID",propertyPath:["chartID"],type:"input"}]),syncHandlers:n,editableOptionsBindings:d(t.defaultOptions.editableOptionsBindings,{skipRedraw:["chartOptions","chartConfig"]}),columnAssignment:void 0}),m}),i(e,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),i(e,"Core/Color/Palettes.js",[],function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}}),i(e,"Core/Time.js",[e["Core/Globals.js"],e["Core/Utilities.js"]],function(t,e){let{win:i}=t,{defined:s,error:n,extend:o,isObject:r,merge:a,objectEach:l,pad:h,pick:c,splat:d,timeUnits:u}=e,p=t.isSafari&&i.Intl&&i.Intl.DateTimeFormat.prototype.formatRange,m=t.isSafari&&i.Intl&&!i.Intl.DateTimeFormat.prototype.formatRange;return class{constructor(t){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=i.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(t)}get(t,e){if(this.variableTimezone||this.timezoneOffset){let i=e.getTime(),s=i-this.getTimezoneOffset(e);e.setTime(s);let n=e["getUTC"+t]();return e.setTime(i),n}return this.useUTC?e["getUTC"+t]():e["get"+t]()}set(t,e,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===t||"Seconds"===t||"Minutes"===t&&this.getTimezoneOffset(e)%36e5==0)return e["setUTC"+t](i);let s=this.getTimezoneOffset(e),n=e.getTime()-s;e.setTime(n),e["setUTC"+t](i);let o=this.getTimezoneOffset(e);return n=e.getTime()+o,e.setTime(n)}return this.useUTC||p&&"FullYear"===t?e["setUTC"+t](i):e["set"+t](i)}update(t={}){let e=c(t.useUTC,!0);this.options=t=a(!0,this.options,t),this.Date=t.Date||i.Date||Date,this.useUTC=e,this.timezoneOffset=e&&t.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=e&&!!(t.getTimezoneOffset||t.timezone)}makeTime(t,e,i,s,n,o){let r,a,l;return this.useUTC?(r=this.Date.UTC.apply(0,arguments),a=this.getTimezoneOffset(r),r+=a,a!==(l=this.getTimezoneOffset(r))?r+=l-a:a-36e5!==this.getTimezoneOffset(r-36e5)||m||(r-=36e5)):r=new this.Date(t,e,c(i,1),c(s,0),c(n,0),c(o,0)).getTime(),r}timezoneOffsetFunction(){let t=this,e=this.options,s=e.getTimezoneOffset,o=e.moment||i.moment;if(!this.useUTC)return function(t){return 6e4*new Date(t.toString()).getTimezoneOffset()};if(e.timezone){if(o)return function(t){return-(6e4*o.tz(t,e.timezone).utcOffset())};n(25)}return this.useUTC&&s?function(t){return 6e4*s(t.valueOf())}:function(){return 6e4*(t.timezoneOffset||0)}}dateFormat(e,i,n){if(!s(i)||isNaN(i))return t.defaultOptions.lang&&t.defaultOptions.lang.invalidDate||"";e=c(e,"%Y-%m-%d %H:%M:%S");let r=this,a=new this.Date(i),d=this.get("Hours",a),u=this.get("Day",a),p=this.get("Date",a),m=this.get("Month",a),f=this.get("FullYear",a),g=t.defaultOptions.lang,y=g&&g.weekdays,b=g&&g.shortWeekdays,C=o({a:b?b[u]:y[u].substr(0,3),A:y[u],d:h(p),e:h(p,2," "),w:u,b:g.shortMonths[m],B:g.months[m],m:h(m+1),o:m+1,y:f.toString().substr(2,2),Y:f,H:h(d),k:d,I:h(d%12||12),l:d%12||12,M:h(this.get("Minutes",a)),p:d<12?"AM":"PM",P:d<12?"am":"pm",S:h(this.get("Seconds",a)),L:h(Math.floor(i%1e3),3)},t.dateFormats);return l(C,function(t,s){for(;-1!==e.indexOf("%"+s);)e=e.replace("%"+s,"function"==typeof t?t.call(r,i):t)}),n?e.substr(0,1).toUpperCase()+e.substr(1):e}resolveDTLFormat(t){return r(t,!0)?t:{main:(t=d(t))[0],from:t[1],to:t[2]}}getTimeTicks(t,e,i,n){let r,a,l,h;let d=this,p=d.Date,m=[],f={},g=new p(e),y=t.unitRange,b=t.count||1;if(n=c(n,1),s(e)){d.set("Milliseconds",g,y>=u.second?0:b*Math.floor(d.get("Milliseconds",g)/b)),y>=u.second&&d.set("Seconds",g,y>=u.minute?0:b*Math.floor(d.get("Seconds",g)/b)),y>=u.minute&&d.set("Minutes",g,y>=u.hour?0:b*Math.floor(d.get("Minutes",g)/b)),y>=u.hour&&d.set("Hours",g,y>=u.day?0:b*Math.floor(d.get("Hours",g)/b)),y>=u.day&&d.set("Date",g,y>=u.month?1:Math.max(1,b*Math.floor(d.get("Date",g)/b))),y>=u.month&&(d.set("Month",g,y>=u.year?0:b*Math.floor(d.get("Month",g)/b)),a=d.get("FullYear",g)),y>=u.year&&(a-=a%b,d.set("FullYear",g,a)),y===u.week&&(h=d.get("Day",g),d.set("Date",g,d.get("Date",g)-h+n+(h<n?-7:0))),a=d.get("FullYear",g);let t=d.get("Month",g),o=d.get("Date",g),c=d.get("Hours",g);e=g.getTime(),(d.variableTimezone||!d.useUTC)&&s(i)&&(l=i-e>4*u.month||d.getTimezoneOffset(e)!==d.getTimezoneOffset(i));let p=g.getTime();for(r=1;p<i;)m.push(p),y===u.year?p=d.makeTime(a+r*b,0):y===u.month?p=d.makeTime(a,t+r*b):l&&(y===u.day||y===u.week)?p=d.makeTime(a,t,o+r*b*(y===u.day?1:7)):l&&y===u.hour&&b>1?p=d.makeTime(a,t,o,c+r*b):p+=y*b,r++;m.push(p),y<=u.hour&&m.length<1e4&&m.forEach(function(t){t%18e5==0&&"000000000"===d.dateFormat("%H%M%S%L",t)&&(f[t]="day")})}return m.info=o(t,{higherRanks:f,totalRange:y*b}),m}getDateFormat(t,e,i,s){let n=this.dateFormat("%m-%d %H:%M:%S.%L",e),o="01-01 00:00:00.000",r={millisecond:15,second:12,minute:9,hour:6,day:3},a="millisecond",l=a;for(a in u){if(t===u.week&&+this.dateFormat("%w",e)===i&&n.substr(6)===o.substr(6)){a="week";break}if(u[a]>t){a=l;break}if(r[a]&&n.substr(r[a])!==o.substr(r[a]))break;"week"!==a&&(l=a)}return this.resolveDTLFormat(s[a]).main}}}),i(e,"Core/Defaults.js",[e["Core/Chart/ChartDefaults.js"],e["Core/Globals.js"],e["Core/Color/Palettes.js"],e["Core/Time.js"],e["Core/Utilities.js"]],function(t,e,i,s,n){let{isTouchDevice:o,svg:r}=e,{merge:a}=n,l={colors:i.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:t,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:r,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:o?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};l.chart.styledMode=!1;let h=new s(l.time);return{defaultOptions:l,defaultTime:h,getOptions:function(){return l},setOptions:function(t){return a(!0,l,t),(t.time||t.global)&&(e.time?e.time.update(a(l.global,l.time,t.global,t.time)):e.time=h),l}}}),i(e,"Core/Templating.js",[e["Core/Defaults.js"],e["Core/Utilities.js"]],function(t,e){let{defaultOptions:i,defaultTime:s}=t,{extend:n,getNestedProperty:o,isArray:r,isNumber:a,isObject:l,isString:h,pick:c,pInt:d}=e,u={add:(t,e)=>t+e,divide:(t,e)=>0!==e?t/e:"",eq:(t,e)=>t==e,each:function(t){let e=arguments[arguments.length-1];return!!r(t)&&t.map((i,s)=>p(e.body,n(l(i)?i:{"@this":i},{"@index":s,"@first":0===s,"@last":s===t.length-1}))).join("")},ge:(t,e)=>t>=e,gt:(t,e)=>t>e,if:t=>!!t,le:(t,e)=>t<=e,lt:(t,e)=>t<e,multiply:(t,e)=>t*e,ne:(t,e)=>t!=e,subtract:(t,e)=>t-e,unless:t=>!t};function p(t="",e,n){let r=/\{([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= #\(\)]+)\}/g,a=/\(([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= ]+)\)/g,l=[],h=/f$/,d=/\.([0-9])/,f=i.lang,g=n&&n.time||s,y=n&&n.numberFormatter||m,b=(t="")=>{let i;return"true"===t||"false"!==t&&((i=Number(t)).toString()===t?i:o(t,e))},C,O,x=0,v;for(;null!==(C=r.exec(t));){let i=a.exec(C[1]);i&&(C=i,v=!0),O&&O.isBlock||(O={ctx:e,expression:C[1],find:C[0],isBlock:"#"===C[1].charAt(0),start:C.index,startInner:C.index+C[0].length,length:C[0].length});let s=C[1].split(" ")[0].replace("#","");u[s]&&(O.isBlock&&s===O.fn&&x++,O.fn||(O.fn=s));let n="else"===C[1];if(O.isBlock&&O.fn&&(C[1]===`/${O.fn}`||n)){if(x)!n&&x--;else{let e=O.startInner,i=t.substr(e,C.index-e);void 0===O.body?(O.body=i,O.startInner=C.index+C[0].length):O.elseBody=i,O.find+=i+C[0],n||(l.push(O),O=void 0)}}else O.isBlock||l.push(O);if(i&&!O?.isBlock)break}return l.forEach(i=>{let s,n;let{body:o,elseBody:r,expression:a,fn:l}=i;if(l){let t=[i],h=a.split(" ");for(n=u[l].length;n--;)t.unshift(b(h[n+1]));s=u[l].apply(e,t),i.isBlock&&"boolean"==typeof s&&(s=p(s?o:r,e))}else{let t=a.split(":");if(s=b(t.shift()||""),t.length&&"number"==typeof s){let e=t.join(":");if(h.test(e)){let t=parseInt((e.match(d)||["","-1"])[1],10);null!==s&&(s=y(s,t,f.decimalPoint,e.indexOf(",")>-1?f.thousandsSep:""))}else s=g.dateFormat(e,s)}}t=t.replace(i.find,c(s,""))}),v?p(t,e,n):t}function m(t,e,s,n){let o,r;t=+t||0,e=+e;let l=i.lang,h=(t.toString().split(".")[1]||"").split("e")[0].length,u=t.toString().split("e"),p=e;-1===e?e=Math.min(h,20):a(e)?e&&u[1]&&u[1]<0&&((r=e+ +u[1])>=0?(u[0]=(+u[0]).toExponential(r).split("e")[0],e=r):(u[0]=u[0].split(".")[0]||0,t=e<20?(u[0]*Math.pow(10,u[1])).toFixed(e):0,u[1]=0)):e=2;let m=(Math.abs(u[1]?u[0]:t)+Math.pow(10,-Math.max(e,h)-1)).toFixed(e),f=String(d(m)),g=f.length>3?f.length%3:0;return s=c(s,l.decimalPoint),n=c(n,l.thousandsSep),o=(t<0?"-":"")+(g?f.substr(0,g)+n:""),0>+u[1]&&!p?o="0":o+=f.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+n),e&&(o+=s+m.slice(-e)),u[1]&&0!=+o&&(o+="e"+u[1]),o}return{dateFormat:function(t,e,i){return s.dateFormat(t,e,i)},format:p,helpers:u,numberFormat:m}}),i(e,"Dashboards/Plugins/KPISyncHandlers.js",[e["Core/Utilities.js"]],function(t){let{defined:e}=t,i={extremes:{handler:{emitters:{},handlers:{extremesHandler:function(){let{board:t}=this,i=t=>{let i=t.cursor;if("position"===i.type&&"number"==typeof i?.row&&e(i.column)&&this.connector&&!e(this.options.value)){let t=this.connector.table.modified.getCellAsString(i.column,i.row);this.setValue(t)}},s=()=>{let{dataCursor:e}=t;if(!e)return;let s=this.connector&&this.connector.table;s&&e.addListener(s.id,"xAxis.extremes.max",i)},n=()=>{let e=this.connector&&this.connector.table,{dataCursor:s}=t;e&&s.removeListener(e.id,"xAxis.extremes.max",i)};t&&(s(),this.on("setConnector",()=>n()),this.on("afterSetConnector",()=>s()))}}}.handlers.extremesHandler}};return i}),i(e,"Dashboards/Plugins/KPIComponent.js",[e["Core/Renderer/HTML/AST.js"],e["Dashboards/Components/Component.js"],e["Core/Templating.js"],e["Dashboards/Plugins/KPISyncHandlers.js"],e["Core/Utilities.js"]],function(t,e,i,s,n){let{format:o}=i,{createElement:r,css:a,defined:l,diffObjects:h,isArray:c,isNumber:d,merge:u}=n;class p extends e{static fromJSON(t,e){let i=t.options,s=i.chartOptions&&JSON.parse(i.chartOptions),n=JSON.parse(i.subtitle||"{}"),o=i.title&&JSON.parse(i.title);return new p(e,u(i,{chartOptions:s,title:o,subtitle:n}))}constructor(t,e){super(t,e=u(p.defaultOptions,e)),this.options=e,this.type="KPI",this.sync=new p.Sync(this,this.syncHandlers),this.value=r("span",{className:`${e.className}-value`},{},this.contentElement),this.subtitle=r("span",{className:this.getSubtitleClassName()},{},this.contentElement),this.options.chartOptions&&(this.chartContainer=r("div",{className:`${e.className}-chart-container`},{},this.contentElement))}async load(){return await super.load(),this.contentElement.style.display="flex",this.contentElement.style.flexDirection="column",this.linkValueToChart(),this}resize(t,e){return super.resize(t,e),this.chart&&this.chart.reflow(),this}render(){super.render(),this.updateElements();let t=p.charter;return t&&this.options.chartOptions&&!this.chart&&this.chartContainer?this.chart=t.chart(this.chartContainer,u(p.defaultChartOptions,this.options.chartOptions)):this.chart&&!this.options.chartOptions&&"chartOptions"in this.options&&(this.chart.destroy(),this.chart=void 0),this.sync.start(),this.emit({type:"afterRender"}),this}setOptions(){this.filterAndAssignSyncOptions(s)}async update(t,e=!0){await super.update(t),this.setOptions(),t.chartOptions&&this.chart&&this.chart.update(t.chartOptions),e&&this.render()}onTableChanged(){this.setValue()}getValue(){if(l(this.options.value))return this.options.value;if(this.connector&&this.options.columnName){let t=this.connector?.table.modified,e=t.getColumn(this.options.columnName),i=e?.length||0;return t.getCellAsString(this.options.columnName,i-1)}}setValue(e=this.getValue()){let{valueFormat:i,valueFormatter:s}=this.options;if(l(e)){let n;d(+e)&&(n=+e),s?e=s.call(this,e):i?e=o(i,{value:e}):d(e)&&(e=e.toLocaleString()),t.setElementHTML(this.value,""+e),this.linkValueToChart(n),this.prevValue=n}}linkValueToChart(t=this.getValue()){let e=this.chart,i=this.options.linkedValueTo;if(!e||!i.enabled||!l(t)||!d(+t))return;t=+t;let s=e.series[i.seriesIndex??0],n=s?.points[i.pointIndex??0];if(s){if(n){n.update({y:t});return}s.addPoint({y:t});return}e.addSeries({data:[{y:t}]})}updateElements(){let{style:e,subtitle:i}=this.options;this.setValue(),t.setElementHTML(this.subtitle,this.getSubtitle()),e&&a(this.element,e),"object"==typeof i&&(i.style&&a(this.subtitle,i.style),this.subtitle.className=this.getSubtitleClassName()),this.chartContainer&&(this.chartContainer.style.flex=this.options.chartOptions?"1":"0"),this.chart&&this.chart.reflow(),this.value.style.color=this.getValueColor()}getSubtitle(){let{subtitle:t,value:e}=this.options;if("string"==typeof t)return t;if(t){if(d(this.prevValue)&&d(e)){let i=e-this.prevValue,s="";if(i>0)s='<span style="color:green">&#9650;</span> +';else{if(!(i<0))return this.subtitle.innerHTML;s='<span style="color:red">&#9660;</span> '}if("diff"===t.type)return s+i.toLocaleString();if("diffpercent"===t.type)return s+o("{v:,.2f}%",{v:i/this.prevValue*100})}return t.text||""}return""}getSubtitleClassName(){let{subtitle:t}=this.options;return`${e.defaultOptions.className}-subtitle`+("object"==typeof t&&t.className||"")}getValueColor(){let{threshold:t,thresholdColors:e,value:i}=this.options;if(e&&t&&d(i)){if(c(t)){for(let s=t.length-1;s>=0;s--)if(i>=t[s]){if(s+1<e.length)return e[s+1];return e[e.length-1]}}else if(i>=t)return e[1];return e[0]}return""}toJSON(){let t=super.toJSON(),e={...t,type:"KPI",options:{...t.options,type:"KPI",value:this.options.value,subtitle:JSON.stringify(this.options.subtitle),title:JSON.stringify(this.options.title),threshold:this.options.threshold,thresholdColors:this.options.thresholdColors,chartOptions:JSON.stringify(this.options.chartOptions),valueFormat:this.options.valueFormat}};return this.emit({type:"toJSON",json:t}),e}getOptions(){return{...h(this.options,p.defaultOptions),type:"KPI"}}}return p.syncHandlers=s,p.defaultOptions=u(e.defaultOptions,{type:"KPI",className:[e.defaultOptions.className,`${e.defaultOptions.className}-kpi`].join(" "),minFontSize:20,syncHandlers:s,thresholdColors:["#f45b5b","#90ed7d"],editableOptions:(e.defaultOptions.editableOptions||[]).concat([{name:"Value",type:"input",propertyPath:["value"]},{name:"Column name",type:"input",propertyPath:["columnName"]},{name:"Value format",type:"input",propertyPath:["valueFormat"]}]),linkedValueTo:{enabled:!0,seriesIndex:0,pointIndex:0}}),p.defaultChartOptions={chart:{type:"spline",styledMode:!0,zooming:{mouseWheel:{enabled:!1}}},title:{text:void 0},xAxis:{visible:!1},yAxis:{visible:!1,title:{text:null}},legend:{enabled:!1},credits:{enabled:!1},tooltip:{outside:!0},plotOptions:{series:{marker:{enabled:!1}}}},p}),i(e,"Dashboards/Plugins/NavigatorComponentDefaults.js",[e["Dashboards/Components/Component.js"]],function(t){let e={type:"Navigator",chartOptions:{chart:{animation:!1,height:200,styledMode:!0,type:"column",zooming:{mouseWheel:{enabled:!1}}},credits:{enabled:!1},legend:{enabled:!1},navigator:{enabled:!0,outlineWidth:0,series:{animation:!1,lineWidth:0},xAxis:{endOnTick:!0,gridZIndex:4,labels:{x:1,y:22},opposite:!0,showFirstLabel:!0,showLastLabel:!0,startOnTick:!0,tickPosition:"inside"},yAxis:{maxPadding:.5}},plotOptions:{series:{borderRadius:0,marker:{enabled:!1},states:{hover:{enabled:!1}}}},scrollbar:{enabled:!0},title:{text:""},tooltip:{enabled:!1},xAxis:{visible:!1},yAxis:{visible:!1}},editableOptions:(t.defaultOptions.editableOptions||[]).concat()};return e}),i(e,"Dashboards/Plugins/NavigatorComponent.js",[e["Dashboards/Components/Component.js"],e["Data/Modifiers/DataModifier.js"],e["Dashboards/Globals.js"],e["Dashboards/Plugins/NavigatorComponentDefaults.js"],e["Core/Utilities.js"]],function(t,e,i,s,n){let{Range:o}=e.types,{addEvent:r,diffObjects:a,isNumber:l,merge:h,pick:c}=n,d={crossfilter:{emitter:function(){let t;let e=this,i=async(t,i)=>{if(e.connector){let s=e.connector.table,n=e.board.dataCursor,r=e.getColumnAssignment()[0],[a,l]=u(t,i),h=s.getModifier();h instanceof o?function(t,e,i,s){let n=!1;for(let o=0,r=t.length;o<r;++o)if(t[o].column===e){t[o].maxValue=s,t[o].minValue=i,n=!0;break}n||t.push({column:e,maxValue:s,minValue:i})}(h.options.ranges,r,a,l):h=new o({ranges:[{column:r,maxValue:l,minValue:a}]}),await s.setModifier(h),n.emitCursor(s,{type:"range",columns:[r],firstRow:0,lastRow:s.getRowCount()-1,state:"crossfilter"},i)}};return r(e.chart.xAxis[0],"afterSetExtremes",function(e){clearTimeout(t),t=setTimeout(i,50,this,e)})}},extremes:{emitter:function(){let t;let e=this,i=(t,i)=>{if(e.connector){let s=e.connector.table,n=e.board.dataCursor,o=e.getColumnAssignment()[0],[r,a]=u(t,i);n.emitCursor(s,{type:"position",column:o,row:s.getRowIndexBy(o,r),state:"xAxis.extremes.min"},i),n.emitCursor(s,{type:"position",column:o,row:s.getRowIndexBy(o,a),state:"xAxis.extremes.max"},i)}};return r(e.chart.xAxis[0],"afterSetExtremes",function(e){clearTimeout(t),t=setTimeout(i,50,this,e)})},handler:function(){let t=this,e=t.board.dataCursor,i=e=>{let i=e.cursor;if(!t.connector)return;let s=t.connector.table,n=s.getColumnNames()[0],r=s.getRowCount(),a=0;"range"===i.type?(r=i.lastRow,a=i.firstRow,i.columns&&(n=c(i.columns[0],n))):"xAxis.extremes.max"===i.state?(n=c(i.column,n),r=c(i.row,r)):(n=c(i.column,n),a=c(i.row,a));let l=s.getModifier();if("string"==typeof n&&l instanceof o){let t=l.options.ranges,e=s.getCell(n,a),i=s.getCell(n,r);null!=i&&null!=e&&(function(t,e){for(let i=0,s=t.length;i<s;++i)if(t[i].column===e)return t.splice(i,1)[0]}(t,n),t.unshift({column:n,maxValue:i,minValue:e}),s.setModifier(l))}},s=()=>{let s=t.connector&&t.connector.table;s&&(e.addListener(s.id,"xAxis.extremes",i),e.addListener(s.id,"xAxis.extremes.max",i),e.addListener(s.id,"xAxis.extremes.min",i))},n=()=>{let s=t.connector&&t.connector.table;s&&(e.removeListener(s.id,"xAxis.extremes",i),e.removeListener(s.id,"xAxis.extremes.max",i),e.removeListener(s.id,"xAxis.extremes.min",i))};s(),t.on("setConnector",()=>n()),t.on("afterSetConnector",()=>s())}}};function u(t,e){let i="number"==typeof e.max?e.max:e.dataMax,s="number"==typeof e.min?e.min:e.dataMin;return t.hasNames?[t.names[Math.round(s)],t.names[Math.round(i)]]:[s,i]}class p extends t{static fromJSON(t,e){let i=t.options,s=new p(e,i);return s.emit({type:"fromJSON",json:t}),s}constructor(t,e){super(t,e),this.options=h(p.defaultOptions,e);let s=p.charter||i.win.Highcharts;this.chartContainer=i.win.document.createElement("div"),this.chart=s.chart(this.chartContainer,this.options.chartOptions||{}),this.chartContainer.classList.add(i.classNamePrefix+"navigator"),this.filterAndAssignSyncOptions(d),this.sync=new p.Sync(this,this.syncHandlers),this.options.sync.crossfilter&&this.chart.update({navigator:{xAxis:{labels:{format:"{value}"}}}},!1)}adjustNavigator(){let t=this.chart,e=c(t.chartHeight,this.contentElement.clientHeight),i=this.contentElement.clientWidth,s={};if((t.chartHeight!==e||t.chartWidth!==i)&&(s.chart={height:e,width:i}),t.navigator){let i=t.navigator,n=i.top-t.plotTop+i.height;i.height!==n&&(s.navigator={handles:{height:Math.round(e/4)},height:n}),Object.keys(s).length&&t.update(s,!1),i.series&&i.series[0]&&i.series[0].update({type:t.series[0].type},!1)}else Object.keys(s).length&&t.update(s,!1)}getColumnAssignment(){let t;let e=this.options.columnAssignments||{};for(let i of Object.keys(e))if(null!==(t=e[i]))return[i,t];if(this.connector){let t=this.connector.table.getColumnNames();if(t.length)return[t[0],"y"]}return["","y"]}getOptions(){return{...a(this.options,s),type:"Navigator"}}async load(){return await super.load(),this.contentElement.appendChild(this.chartContainer),this.parentElement.appendChild(this.element),this.adjustNavigator(),this.emit({type:"afterLoad"}),this}onTableChanged(){this.renderNavigator()}redrawNavigator(){let t=this.resizeTimeouts;for(let e=0,i=t.length;e<i;++e)clearTimeout(t[e]);t.length=0,t.push(setTimeout(()=>{this.adjustNavigator(),this.chart.redraw()},33))}render(){return super.render(),this.renderNavigator(),this.sync.start(),this.emit({type:"afterRender"}),this}renderNavigator(){let t=this.chart;if(this.connector){let e;let i=this.connector.table,s=this.options,n=this.getColumnAssignment(),o=i.getColumn(n[0],!0)||[];if(s.sync.crossfilter){let t;let i=[],s=[];for(let e of o)null!==e&&(l(e)||(e=`${e}`),-1===(t=s.indexOf(e))?(t=s.length,s[t]=e,i[t]=[e,1]):i[t][1]=i[t][1]+1);i.sort((t,e)=>c(t[0],NaN)<c(e[0],NaN)?-1:t[0]===e[0]?0:1),e=i}else o[0],e=o.slice();t.series[0]?t.series[0].setData(e,!1):t.addSeries({id:i.id,data:e},!1)}this.redrawNavigator()}resize(t,e){return super.resize(t,e),this.redrawNavigator(),this}async update(t,e=!0){let i=this.chart;await super.update(t,!1),t.sync&&this.filterAndAssignSyncOptions(d),t.chartOptions&&i.update(h(this.options.sync.crossfilter?{navigator:{xAxis:{labels:{format:"{value}"}}}}:{},t.chartOptions),!1),this.emit({type:"afterUpdate"}),e&&this.render()}}return p.defaultOptions=h(t.defaultOptions,s),p}),i(e,"Dashboards/Plugins/HighchartsPlugin.js",[e["Dashboards/Plugins/HighchartsComponent.js"],e["Dashboards/Plugins/HighchartsSyncHandlers.js"],e["Dashboards/Plugins/KPIComponent.js"],e["Dashboards/Plugins/NavigatorComponent.js"]],function(t,e,i,s){return{custom:{connectHighcharts:function(e){t.charter=e,i.charter=e,s.charter=e}},name:"Highcharts.DashboardsPlugin",onRegister:function(n){let{Sync:o,ComponentRegistry:r}=n;r.registerComponent("Highcharts",t),r.registerComponent("KPI",i),r.registerComponent("Navigator",s),o.defaultHandlers={...o.defaultHandlers,...e}},onUnregister:function(t){let{Sync:i}=t;Object.keys(e).forEach(t=>{i.defaultHandlers[t]===e[t]&&delete i.defaultHandlers[t]})}}}),i(e,"masters/modules/dashboards-plugin.src.js",[e["Dashboards/Plugins/DataGridPlugin.js"],e["Dashboards/Globals.js"],e["Dashboards/Plugins/HighchartsPlugin.js"]],function(t,e,i){return e.DataGridPlugin=t,e.HighchartsPlugin=i,e.win.Highcharts&&(i.custom.connectHighcharts(e.win.Highcharts),e.PluginHandler.addPlugin(i)),e.win.DataGrid&&(t.custom.connectDataGrid(e.win.DataGrid.DataGrid),e.PluginHandler.addPlugin(t)),e})});