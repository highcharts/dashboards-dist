/*
 Highcharts Dashboards Math 1.0.1 (2023-07-19)

 (c) 2009-2023 Highsoft AS

 License: www.highcharts.com/license
*/
'use strict';(function(g){"object"===typeof module&&module.exports?(g["default"]=g,module.exports=g):"function"===typeof define&&define.amd?define("dashboards/modules/math-modifier",["dashboards"],function(l){g(l);g.Dashboards=l;return g}):g("undefined"!==typeof Dashboards?Dashboards:void 0)})(function(g){function l(f,b,c,a){f.hasOwnProperty(b)||(f[b]=a.apply(null,c),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("DashboardsModuleLoaded",{detail:{path:b,module:f[b]}})))}g=g?
g._modules:{};l(g,"Data/Formula/FormulaParser.js",[],function(){function f(e){let d=0;for(let b=0,h=e.length,a,c=1;b<h;++b)if(a=e[b],"("===a)d||(c=b+1),++d;else if(")"===a&&(--d,!d))return e.substring(c,b);if(0<d)throw e=Error("Incomplete parantheses."),e.name="FormulaParseError",e;return""}function b(e){let d=-1;for(let b=0,h=e.length,a,c=!1;b<h;++b)if(a=e[b],"\\"===a)c=!c;else if(c)c=!1;else if('"'===a)if(0>d)d=b;else return e.substring(d+1,b);e=Error("Incomplete string.");e.name="FormulaParseError";
throw e;}function c(b,d){var a;if(a=b.match(q)){b=""===a[2]||"["===a[2][0];d=""===a[1]||"["===a[1][0];var c=""===a[4]||"["===a[4][0],f=""===a[3]||"["===a[3][0];a={type:"range",beginColumn:b?parseInt(a[2].substring(1,-1)||"0",10):parseInt(a[2],10)-1,beginRow:d?parseInt(a[1].substring(1,-1)||"0",10):parseInt(a[1],10)-1,endColumn:c?parseInt(a[4].substring(1,-1)||"0",10):parseInt(a[4],10)-1,endRow:f?parseInt(a[3].substring(1,-1)||"0",10):parseInt(a[3],10)-1};b&&(a.beginColumnRelative=!0);d&&(a.beginRowRelative=
!0);c&&(a.endColumnRelative=!0);f&&(a.endRowRelative=!0);return a}if(a=b.match(w))return b="$"!==a[1][0],d="$"!==a[2][0],c="$"!==a[3][0],f="$"!==a[4][0],a={type:"range",beginColumn:h(b?a[1]:a[1].substring(1))-1,beginRow:parseInt(d?a[2]:a[2].substring(1),10)-1,endColumn:h(c?a[3]:a[3].substring(1))-1,endRow:parseInt(f?a[4]:a[4].substring(1),10)-1},b&&(a.beginColumnRelative=!0),d&&(a.beginRowRelative=!0),c&&(a.endColumnRelative=!0),f&&(a.endRowRelative=!0),a;a=e(b,d);return 1===a.length&&"string"!==
typeof a[0]?a[0]:a}function a(a,e){const d=[],h=e?";":",";let f=0,g="";for(let p=0,x=a.length,n;p<x;++p)if(n=a[p],n===h&&!f&&g)d.push(c(g,e)),g="";else if('"'!==n||f||g)" "!==n&&(g+=n,"("===n?++f:")"===n&&--f);else{const e=b(a.substring(p));d.push(e);p+=e.length+1}!f&&g&&d.push(c(g,e));return d}function e(c,n){const w=n?g:d,q=[];var k;let m=("="===c[0]?c.substring(1):c).trim();for(;m;)if(k=m.match(z)){var t=""===k[2]||"["===k[2][0],r=""===k[1]||"["===k[1][0],u={type:"reference",column:t?parseInt(k[2].substring(1,
-1)||"0",10):parseInt(k[2],10)-1,row:r?parseInt(k[1].substring(1,-1)||"0",10):parseInt(k[1],10)-1};t&&(u.columnRelative=!0);r&&(u.rowRelative=!0);q.push(u);m=m.substring(k[0].length).trim()}else if(k=m.match(l))t="$"!==k[1][0],r="$"!==k[2][0],u={type:"reference",column:h(t?k[1]:k[1].substring(1))-1,row:parseInt(r?k[2]:k[2].substring(1),10)-1},t&&(u.columnRelative=!0),r&&(u.rowRelative=!0),q.push(u),m=m.substring(k[0].length).trim();else if(k=m.match(v))q.push(k[0]),m=m.substring(k[0].length).trim();
else if(k=m.match(p))q.push("TRUE"===k[0]),m=m.substring(k[0].length).trim();else if(k=m.match(w))q.push(parseFloat(k[0])),m=m.substring(k[0].length).trim();else if('"'===m[0])k=b(m),q.push(k.substring(1,-1)),m=m.substring(k.length+2).trim();else if(k=m.match(x))m=m.substring(k[1].length).trim(),t=f(m),q.push({type:"function",name:k[1],args:a(t,n)}),m=m.substring(t.length+2).trim();else{if("("===m[0]&&(k=f(m))){q.push(e(k,n));m=m.substring(k.length+2).trim();continue}n=c.length-m.length;c=Error("Unexpected character `"+
c.substring(n,n+1)+"` at position "+(n+1)+". (`..."+c.substring(n-5,n+6)+"...`)");c.name="FormulaParseError";throw c;}return q}function h(a){let e=0;for(let d=0,b=a.length,h,c=a.length-1;d<b;++d)h=a.charCodeAt(d),65<=h&&90>=h&&(e+=(h-64)*Math.pow(26,c)),--c;return e}const p=/^(?:FALSE|TRUE)/,d=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,g=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,x=/^([A-Z][A-Z\d\.]*)\(/,v=/^(?:[+\-*\/^<=>]|<=|=>)/,w=/^(\$?[A-Z]+)(\$?\d+):(\$?[A-Z]+)(\$?\d+)/,q=/^R(\d*|\[\d+\])C(\d*|\[\d+\]):R(\d*|\[\d+\])C(\d*|\[\d+\])/,
l=/^(\$?[A-Z]+)(\$?\d+)(?![:C])/,z=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!:)/;return{parseFormula:e}});l(g,"Data/Formula/FormulaTypes.js",[],function(){const f="+ - * / ^ = < <= > >=".split(" ");return{isFormula:function(b){return b instanceof Array},isFunction:function(b){return"object"===typeof b&&!(b instanceof Array)&&"function"===b.type},isOperator:function(b){return"string"===typeof b&&0<=f.indexOf(b)},isRange:function(b){return"object"===typeof b&&!(b instanceof Array)&&"range"===b.type},isReference:function(b){return"object"===
typeof b&&!(b instanceof Array)&&"reference"===b.type},isValue:function(b){return"boolean"===typeof b||"number"===typeof b||"string"===typeof b}}});l(g,"Data/Formula/FormulaProcessor.js",[g["Data/Formula/FormulaTypes.js"]],function(f){function b(a){switch(typeof a){case "boolean":return a?m:C;case "string":return k;case "number":return a;default:return NaN}}function c(a){return"string"===typeof a?a.toLowerCase().replace(B,"\x00"):a}function a(a){switch(typeof a){case "boolean":return a?1:0;case "string":return parseFloat(a.replace(",",
"."));case "number":return a;default:return NaN}}function e(e,d,h){switch(e){case "=":return c(d)===c(h);case "<":return typeof d===typeof h?c(d)<c(h):b(d)<b(h);case "<=":return typeof d===typeof h?c(d)<=c(h):b(d)<=b(h);case ">":return typeof d===typeof h?c(d)>c(h):b(d)>b(h);case ">=":return typeof d===typeof h?c(d)>=c(h):b(d)>=b(h)}d=a(d);h=a(h);switch(e){case "+":e=d+h;break;case "-":e=d-h;break;case "*":e=d*h;break;case "/":e=d/h;break;case "^":e=Math.pow(d,h);break;default:return NaN}return e%
1?Math.round(1E9*e)/1E9:e}function h(a,d){return r(a)?a:z(a)?d&&g(a,d)||[]:q(a)?x(a,d):n(w(a)?a:[a],d)}function g(a,d){const e=d.getColumnNames().slice(a.beginColumn,a.endColumn+1),h=[];for(let b=0,c=e.length,f;b<c;++b){const c=d.getColumn(e[b],!0)||[];for(let g=a.beginRow,n=a.endRow+1;g<n;++g)f=c[g],"string"===typeof f&&"="===f[0]&&d!==d.modified&&(f=d.modified.getCell(e[b],g)),h.push(r(f)?f:NaN)}return h}function d(a,d){const e=d.getColumnNames()[a.column];if(e){const h=d.getCell(e,a.row);return"string"===
typeof h&&"="===h[0]&&d!==d.modified?(a=d.modified.getCell(e,a.row),r(a)?a:NaN):r(h)?h:NaN}return NaN}function n(a,h){let b;for(let c=0,f=a.length,g,p,v,k;c<f;++c)if(g=a[c],l(g))p=g;else if(r(g)?k=g:w(g)?k=n(a,h):q(g)?(v=x(g,h),k=r(v)?v:NaN):A(g)&&(k=h&&d(g,h)),"undefined"!==typeof k){if("undefined"===typeof b)b=p?e(p,0,k):k;else if(p){const d=a[c+1];l(d)&&t[d]>t[p]&&(k=e(d,k,n(a.slice(c+2))),c=f);b=e(p,b,k)}else return NaN;k=p=void 0}return r(b)?b:NaN}function x(a,d){const e=y[a.name];if(e)try{return e(a.args,
d)}catch(E){return NaN}a=Error(`Function "${a.name}" not found.`);a.name="FormulaProcessError";throw a;}function v(a,d=0,e=0){for(let h=0,b=a.length,c;h<b;++h)c=a[h],c instanceof Array?v(c):q(c)?v(c.args):z(c)?(c.beginColumnRelative&&(c.beginColumn+=d),c.beginRowRelative&&(c.beginRow+=e),c.endColumnRelative&&(c.endColumn+=d),c.endRowRelative&&(c.endRow+=e)):A(c)&&(c.columnRelative&&(c.column+=d),c.rowRelative&&(c.row+=e));return a}const {isFormula:w,isFunction:q,isOperator:l,isRange:z,isReference:A,
isValue:r}=f,B=/ */,C=Number.MAX_VALUE/1.000000000001,k=Number.MAX_VALUE/1.000000000002,m=Number.MAX_VALUE,t={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},y={},u=/^[A-Z][A-Z\.]*$/;return{asNumber:a,getArgumentValue:h,getArgumentsValues:function(a,d){const e=[];for(let b=0,c=a.length;b<c;++b)e.push(h(a[b],d));return e},getRangeValues:g,getReferenceValue:d,processFormula:n,processorFunctions:y,registerProcessorFunction:function(a,d){return u.test(a)&&!y[a]&&!!(y[a]=d)},translateReferences:v}});
l(g,"Data/Formula/Functions/ABS.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){a=c(a[0],e);switch(typeof a){case "number":return Math.abs(a);case "object":e=[];for(let h=0,b=a.length,d;h<b;++h){d=a[h];if("number"!==typeof d)return NaN;e.push(Math.abs(d))}return e;default:return NaN}}const {getArgumentValue:c}=f;f.registerProcessorFunction("ABS",b);return b});l(g,"Data/Formula/Functions/AND.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){for(let h=0,
f=a.length,d;h<f;++h)if(d=c(a[h],e),!d||"object"===typeof d&&!b(d,e))return!1;return!0}const {getArgumentValue:c}=f;f.registerProcessorFunction("AND",b);return b});l(g,"Data/Formula/Functions/AVERAGE.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){a=c(a,e);let h=e=0;for(let b=0,d=a.length,c;b<d;++b)switch(c=a[b],typeof c){case "number":isNaN(c)||(++e,h+=c);break;case "object":for(let a=0,d=c.length,b;a<d;++a)b=c[a],"number"!==typeof b||isNaN(b)||(++e,h+=b)}return e?h/e:0}const {getArgumentsValues:c}=
f;f.registerProcessorFunction("AVERAGE",b);return b});l(g,"Data/Formula/Functions/AVERAGEA.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){let b=0,f=0;for(let d=0,h=a.length,g;d<h;++d)switch(g=c(a[d],e),typeof g){case "boolean":++b;f+=g?1:0;continue;case "number":isNaN(g)||(++b,f+=g);continue;case "string":++b;continue;default:for(let a=0,d=g.length,e;a<d;++a)switch(e=g[a],typeof e){case "boolean":++b;f+=e?1:0;continue;case "number":isNaN(e)||(++b,f+=e);continue;case "string":++b}}return b?
f/b:0}const {getArgumentValue:c}=f;f.registerProcessorFunction("AVERAGEA",b);return b});l(g,"Data/Formula/Functions/COUNT.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(c,a){c=f.getArgumentsValues(c,a);let e=0;for(let h=0,f=c.length,d;h<f;++h)switch(d=c[h],typeof d){case "number":isNaN(d)||++e;break;case "object":e+=b(d,a)}return e}f.registerProcessorFunction("COUNT",b);return b});l(g,"Data/Formula/Functions/COUNTA.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(c,
a){c=f.getArgumentsValues(c,a);let e=0;for(let h=0,f=c.length,d;h<f;++h){d=c[h];switch(typeof d){case "number":if(isNaN(d))continue;break;case "object":e+=b(d,a);continue;case "string":if(!d)continue}++e}return e}f.registerProcessorFunction("COUNTA",b);return b});l(g,"Data/Formula/Functions/IF.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){return c(a[0],e)?c(a[1],e):c(a[2],e)}const {getArgumentValue:c}=f;f.registerProcessorFunction("IF",b);return b});l(g,"Data/Formula/Functions/ISNA.js",
[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){a=c(a[0],e);return"number"!==typeof a||isNaN(a)}const {getArgumentValue:c}=f;f.registerProcessorFunction("ISNA",b);return b});l(g,"Data/Formula/Functions/MAX.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){a=c(a,e);e=Number.NEGATIVE_INFINITY;for(let c=0,f=a.length,d;c<f;++c)switch(d=a[c],typeof d){case "number":d>e&&(e=d);break;case "object":d=b(d),d>e&&(e=d)}return isFinite(e)?e:0}const {getArgumentsValues:c}=
f;f.registerProcessorFunction("MAX",b);return b});l(g,"Data/Formula/Functions/MEDIAN.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(b,a){const e=[];b=f.getArgumentsValues(b,a);for(let a=0,c=b.length,d;a<c;++a)switch(d=b[a],typeof d){case "number":isNaN(d)||e.push(d);break;case "object":for(let a=0,b=d.length,c;a<b;++a)c=d[a],"number"!==typeof c||isNaN(c)||e.push(c)}b=e.length;if(!b)return NaN;a=Math.floor(b/2);return b%2?e[a]:(e[a-1]+e[a])/2}f.registerProcessorFunction("MEDIAN",
b);return b});l(g,"Data/Formula/Functions/MIN.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){a=c(a,e);e=Number.POSITIVE_INFINITY;for(let c=0,f=a.length,d;c<f;++c)switch(d=a[c],typeof d){case "number":d<e&&(e=d);break;case "object":d=b(d),d<e&&(e=d)}return isFinite(e)?e:0}const {getArgumentsValues:c}=f;f.registerProcessorFunction("MIN",b);return b});l(g,"Data/Formula/Functions/MOD.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,b){let e=c(a[0],b);a=c(a[1],
b);"object"===typeof e&&(e=e[0]);"object"===typeof a&&(a=a[0]);return"number"!==typeof e||"number"!==typeof a||0===a?NaN:e%a}const {getArgumentValue:c}=f;f.registerProcessorFunction("MOD",b);return b});l(g,"Data/Formula/Functions/MODE.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,b){const e={};a=f.getArgumentsValues(a,b);for(let d=0,b=a.length,c;d<b;++d)switch(c=a[d],typeof c){case "number":isNaN(c)||(e[c]=(e[c]||0)+1);break;case "object":for(let a=0,d=c.length,b;a<d;++a)b=
c[a],"number"!==typeof b||isNaN(b)||(e[b]=(e[b]||0)+1)}return e}function c(a,c){a=b(a,c);c=Object.keys(a);if(!c.length)return NaN;let e=[parseFloat(c[0])],d=a[c[0]];for(let b=1,h=c.length,f,g;b<h;++b)f=c[b],g=a[f],d<g?(e=[parseFloat(f)],d=g):d===g&&e.push(parseFloat(f));return 1<d?e:NaN}function a(a,c){a=b(a,c);c=Object.keys(a);if(!c.length)return NaN;let e=parseFloat(c[0]),d=a[c[0]];for(let b=1,f=c.length,h,g,p;b<f;++b)h=c[b],p=a[h],d<p?(e=parseFloat(h),d=p):d===p&&(g=parseFloat(h),e>g&&(e=g,d=p));
return 1<d?e:NaN}f.registerProcessorFunction("MODE",a);f.registerProcessorFunction("MODE.MULT",c);f.registerProcessorFunction("MODE.SNGL",a);return{MULT:c,SNGL:a}});l(g,"Data/Formula/Functions/NOT.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,b){a=c(a[0],b);"object"===typeof a&&(a=a[0]);switch(typeof a){case "boolean":case "number":return!a}return NaN}const {getArgumentValue:c}=f;f.registerProcessorFunction("NOT",b);return b});l(g,"Data/Formula/Functions/OR.js",[g["Data/Formula/FormulaProcessor.js"]],
function(f){function b(a,e){for(let f=0,g=a.length,d;f<g;++f)if(d=c(a[f],e),"object"===typeof d){if(b(d,e))return!0}else if(d)return!0;return!1}const {getArgumentValue:c}=f;f.registerProcessorFunction("OR",b);return b});l(g,"Data/Formula/Functions/PRODUCT.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,e){a=c(a,e);let f=1,g=!1;for(let d=0,c=a.length,h;d<c;++d)switch(h=a[d],typeof h){case "number":isNaN(h)||(g=!0,f*=h);break;case "object":g=!0,f*=b(h,e)}return g?f:0}const {getArgumentsValues:c}=
f;f.registerProcessorFunction("PRODUCT",b);return b});l(g,"Data/Formula/Functions/SUM.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(c,a){c=f.getArgumentsValues(c,a);let e=0;for(let f=0,g=c.length,d;f<g;++f)switch(d=c[f],typeof d){case "number":isNaN(d)||(e+=d);break;case "object":e+=b(d,a)}return e}f.registerProcessorFunction("SUM",b);return b});l(g,"Data/Formula/Functions/XOR.js",[g["Data/Formula/FormulaProcessor.js"]],function(f){function b(a,b){for(let e=0,f=a.length,d,g;e<
f;++e)switch(g=c(a[e],b),typeof g){case "boolean":case "number":if("undefined"===typeof d)d=!!g;else if(!!g!==d)return!0;break;case "object":for(let a=0,b=g.length,c;a<b;++a)switch(c=g[a],typeof c){case "boolean":case "number":if("undefined"===typeof d)d=!!c;else if(!!c!==d)return!0}}return!1}const {getArgumentValue:c}=f;f.registerProcessorFunction("XOR",b);return b});l(g,"Data/Formula/Formula.js",[g["Data/Formula/FormulaParser.js"],g["Data/Formula/FormulaProcessor.js"],g["Data/Formula/FormulaTypes.js"]],
function(f,b,c){return Object.assign(Object.assign(Object.assign({},f),b),c)});l(g,"Data/Modifiers/MathModifier.js",[g["Data/Modifiers/DataModifier.js"],g["Data/Formula/FormulaParser.js"],g["Data/Formula/FormulaProcessor.js"]],function(f,b,c){class a extends f{constructor(b){super();this.options=Object.assign(Object.assign({},a.defaultOptions),b)}modifyTable(a,c){this.emit({type:"modify",detail:c,table:a});const e=this.options.alternativeSeparators;var d=this.options.formulaColumns||a.getColumnNames();
const f=a.modified;for(let b=0,c=d.length,e;b<c;++b)e=d[b],0<=d.indexOf(e)&&f.setColumn(e,this.processColumn(a,e));d=this.options.columnFormulas||[];for(let c=0,g=d.length,h,n;c<g;++c)h=d[c],n=b.parseFormula(h.formula,e),f.setColumn(h.column,this.processColumnFormula(n,a,h.rowStart,h.rowEnd));this.emit({type:"afterModify",detail:c,table:a});return a}processColumn(a,f,g=0){const d=this.options.alternativeSeparators;f=(a.getColumn(f,!0)||[]).slice(0<g?g:0);for(let e=0,g=f.length,h=[],l="",p;e<g;++e)if(p=
f[e],"string"===typeof p&&"="===p[0])try{h=l===p?h:b.parseFormula(p.substring(1),d),f[e]=c.processFormula(h,a)}catch(D){f[e]=NaN}return f}processColumnFormula(a,b,f=0,d=b.getRowCount()){f=0<=f?f:0;d=0<=d?d:b.getRowCount()+d;const e=[];b=b.modified;for(let g=0,h=d-f;g<h;++g)try{e[g]=c.processFormula(a,b)}catch(w){e[g]=NaN}finally{a=c.translateReferences(a,0,1)}return e}}a.defaultOptions={type:"Math",alternativeSeparators:!1};f.registerType("Math",a);return a});l(g,"masters/modules/math-modifier.src.js",
[g["Dashboards/Globals.js"],g["Data/Formula/Formula.js"]],function(f,b){f.Formula=b;return f})});//# sourceMappingURL=math-modifier.js.map