!/**
 * Highcharts Dashboards v1.3.1 (2024-02-14)
 *
 * (c) 2009-2024 Highsoft AS
 *
 * License: www.highcharts.com/license
 */function(e){"object"==typeof module&&module.exports?(e.default=e,module.exports=e):"function"==typeof define&&define.amd?define("dashboards/datagrid",["dashboards"],function(t){return e(t),e.Dashboards=t,e}):e("undefined"!=typeof Dashboards?Dashboards:void 0)}(function(e){"use strict";var t=e?e._modules:{};function i(e,t,i,s){e.hasOwnProperty(t)||(e[t]=s.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("DashboardsModuleLoaded",{detail:{path:t,module:e[t]}})))}i(t,"DataGrid/Globals.js",[],function(){var e,t;return(t=e||(e={})).classNamePrefix="highcharts-datagrid-",t.classNames={gridContainer:t.classNamePrefix+"container",outerContainer:t.classNamePrefix+"outer-container",scrollContainer:t.classNamePrefix+"scroll-container",innerContainer:t.classNamePrefix+"inner-container",cell:t.classNamePrefix+"cell",cellInput:t.classNamePrefix+"cell-input",row:t.classNamePrefix+"row",columnHeader:t.classNamePrefix+"column-header"},t.win=window,e}),i(t,"DataGrid/DataGridUtils.js",[],function(){return{dataTableCellToString:e=>"string"==typeof e||"number"==typeof e||"boolean"==typeof e?""+e:"",emptyHTMLElement(e){for(;e.firstChild;)e.removeChild(e.firstChild)},makeDiv:(e,t)=>{let i=document.createElement("div");return i.className=e,t&&(i.id=t),i}}}),i(t,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),i(t,"Core/Color/Palettes.js",[],function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}}),i(t,"Core/Time.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(e,t){let{win:i}=e,{defined:s,error:n,extend:o,isNumber:l,isObject:r,merge:a,objectEach:h,pad:d,pick:m,splat:u,timeUnits:c}=t,f=e.isSafari&&i.Intl&&i.Intl.DateTimeFormat.prototype.formatRange,g=e.isSafari&&i.Intl&&!i.Intl.DateTimeFormat.prototype.formatRange;return class{constructor(e){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=i.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(e)}get(e,t){if(this.variableTimezone||this.timezoneOffset){let i=t.getTime(),s=i-this.getTimezoneOffset(t);t.setTime(s);let n=t["getUTC"+e]();return t.setTime(i),n}return this.useUTC?t["getUTC"+e]():t["get"+e]()}set(e,t,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===e||"Seconds"===e||"Minutes"===e&&this.getTimezoneOffset(t)%36e5==0)return t["setUTC"+e](i);let s=this.getTimezoneOffset(t),n=t.getTime()-s;t.setTime(n),t["setUTC"+e](i);let o=this.getTimezoneOffset(t);return n=t.getTime()+o,t.setTime(n)}return this.useUTC||f&&"FullYear"===e?t["setUTC"+e](i):t["set"+e](i)}update(e={}){let t=m(e.useUTC,!0);this.options=e=a(!0,this.options,e),this.Date=e.Date||i.Date||Date,this.useUTC=t,this.timezoneOffset=t&&e.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=t&&!!(e.getTimezoneOffset||e.timezone)}makeTime(e,t,i,s,n,o){let l,r,a;return this.useUTC?(l=this.Date.UTC.apply(0,arguments),r=this.getTimezoneOffset(l),l+=r,r!==(a=this.getTimezoneOffset(l))?l+=a-r:r-36e5!==this.getTimezoneOffset(l-36e5)||g||(l-=36e5)):l=new this.Date(e,t,m(i,1),m(s,0),m(n,0),m(o,0)).getTime(),l}timezoneOffsetFunction(){let e=this,t=this.options,i=t.getTimezoneOffset;return this.useUTC?t.timezone?e=>{try{let[i,s,n,o,r=0]=Intl.DateTimeFormat("en",{timeZone:t.timezone,timeZoneName:"shortOffset"}).format(e).split(/(GMT|:)/).map(Number),a=-(36e5*(n+r/60));if(l(a))return a}catch(e){n(34)}return 0}:this.useUTC&&i?e=>6e4*i(e.valueOf()):()=>6e4*(e.timezoneOffset||0):e=>6e4*new Date(e.toString()).getTimezoneOffset()}dateFormat(t,i,n){if(!s(i)||isNaN(i))return e.defaultOptions.lang&&e.defaultOptions.lang.invalidDate||"";t=m(t,"%Y-%m-%d %H:%M:%S");let l=this,r=new this.Date(i),a=this.get("Hours",r),u=this.get("Day",r),c=this.get("Date",r),f=this.get("Month",r),g=this.get("FullYear",r),p=e.defaultOptions.lang,C=p&&p.weekdays,b=p&&p.shortWeekdays;return h(o({a:b?b[u]:C[u].substr(0,3),A:C[u],d:d(c),e:d(c,2," "),w:u,b:p.shortMonths[f],B:p.months[f],m:d(f+1),o:f+1,y:g.toString().substr(2,2),Y:g,H:d(a),k:a,I:d(a%12||12),l:a%12||12,M:d(this.get("Minutes",r)),p:a<12?"AM":"PM",P:a<12?"am":"pm",S:d(this.get("Seconds",r)),L:d(Math.floor(i%1e3),3)},e.dateFormats),function(e,s){for(;-1!==t.indexOf("%"+s);)t=t.replace("%"+s,"function"==typeof e?e.call(l,i):e)}),n?t.substr(0,1).toUpperCase()+t.substr(1):t}resolveDTLFormat(e){return r(e,!0)?e:{main:(e=u(e))[0],from:e[1],to:e[2]}}getTimeTicks(e,t,i,n){let l,r,a,h;let d=this,u=d.Date,f=[],g={},p=new u(t),C=e.unitRange,b=e.count||1;if(n=m(n,1),s(t)){d.set("Milliseconds",p,C>=c.second?0:b*Math.floor(d.get("Milliseconds",p)/b)),C>=c.second&&d.set("Seconds",p,C>=c.minute?0:b*Math.floor(d.get("Seconds",p)/b)),C>=c.minute&&d.set("Minutes",p,C>=c.hour?0:b*Math.floor(d.get("Minutes",p)/b)),C>=c.hour&&d.set("Hours",p,C>=c.day?0:b*Math.floor(d.get("Hours",p)/b)),C>=c.day&&d.set("Date",p,C>=c.month?1:Math.max(1,b*Math.floor(d.get("Date",p)/b))),C>=c.month&&(d.set("Month",p,C>=c.year?0:b*Math.floor(d.get("Month",p)/b)),r=d.get("FullYear",p)),C>=c.year&&(r-=r%b,d.set("FullYear",p,r)),C===c.week&&(h=d.get("Day",p),d.set("Date",p,d.get("Date",p)-h+n+(h<n?-7:0))),r=d.get("FullYear",p);let e=d.get("Month",p),o=d.get("Date",p),m=d.get("Hours",p);t=p.getTime(),(d.variableTimezone||!d.useUTC)&&s(i)&&(a=i-t>4*c.month||d.getTimezoneOffset(t)!==d.getTimezoneOffset(i));let u=p.getTime();for(l=1;u<i;)f.push(u),C===c.year?u=d.makeTime(r+l*b,0):C===c.month?u=d.makeTime(r,e+l*b):a&&(C===c.day||C===c.week)?u=d.makeTime(r,e,o+l*b*(C===c.day?1:7)):a&&C===c.hour&&b>1?u=d.makeTime(r,e,o,m+l*b):u+=C*b,l++;f.push(u),C<=c.hour&&f.length<1e4&&f.forEach(function(e){e%18e5==0&&"000000000"===d.dateFormat("%H%M%S%L",e)&&(g[e]="day")})}return f.info=o(e,{higherRanks:g,totalRange:C*b}),f}getDateFormat(e,t,i,s){let n=this.dateFormat("%m-%d %H:%M:%S.%L",t),o="01-01 00:00:00.000",l={millisecond:15,second:12,minute:9,hour:6,day:3},r="millisecond",a=r;for(r in c){if(e===c.week&&+this.dateFormat("%w",t)===i&&n.substr(6)===o.substr(6)){r="week";break}if(c[r]>e){r=a;break}if(l[r]&&n.substr(l[r])!==o.substr(l[r]))break;"week"!==r&&(a=r)}return this.resolveDTLFormat(s[r]).main}}}),i(t,"Core/Defaults.js",[t["Core/Chart/ChartDefaults.js"],t["Core/Globals.js"],t["Core/Color/Palettes.js"],t["Core/Time.js"],t["Core/Utilities.js"]],function(e,t,i,s,n){let{isTouchDevice:o,svg:l}=t,{merge:r}=n,a={colors:i.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:e,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:l,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:o?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};a.chart.styledMode=!1;let h=new s(a.time);return{defaultOptions:a,defaultTime:h,getOptions:function(){return a},setOptions:function(e){return r(!0,a,e),(e.time||e.global)&&(t.time?t.time.update(r(a.global,a.time,e.global,e.time)):t.time=h),a}}}),i(t,"Core/Templating.js",[t["Core/Defaults.js"],t["Core/Utilities.js"]],function(e,t){let{defaultOptions:i,defaultTime:s}=e,{extend:n,getNestedProperty:o,isArray:l,isNumber:r,isObject:a,pick:h,pInt:d}=t,m={add:(e,t)=>e+t,divide:(e,t)=>0!==t?e/t:"",eq:(e,t)=>e==t,each:function(e){let t=arguments[arguments.length-1];return!!l(e)&&e.map((i,s)=>u(t.body,n(a(i)?i:{"@this":i},{"@index":s,"@first":0===s,"@last":s===e.length-1}))).join("")},ge:(e,t)=>e>=t,gt:(e,t)=>e>t,if:e=>!!e,le:(e,t)=>e<=t,lt:(e,t)=>e<t,multiply:(e,t)=>e*t,ne:(e,t)=>e!=t,subtract:(e,t)=>e-t,unless:e=>!e};function u(e="",t,n){let l=/\{([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= #\(\)]+)\}/g,r=/\(([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= ]+)\)/g,a=[],d=/f$/,f=/\.([0-9])/,g=i.lang,p=n&&n.time||s,C=n&&n.numberFormatter||c,b=(e="")=>{let i;return"true"===e||"false"!==e&&((i=Number(e)).toString()===e?i:o(e,t))},y,T,w=0,x;for(;null!==(y=l.exec(e));){let i=r.exec(y[1]);i&&(y=i,x=!0),T&&T.isBlock||(T={ctx:t,expression:y[1],find:y[0],isBlock:"#"===y[1].charAt(0),start:y.index,startInner:y.index+y[0].length,length:y[0].length});let s=y[1].split(" ")[0].replace("#","");m[s]&&(T.isBlock&&s===T.fn&&w++,T.fn||(T.fn=s));let n="else"===y[1];if(T.isBlock&&T.fn&&(y[1]===`/${T.fn}`||n)){if(w)!n&&w--;else{let t=T.startInner,i=e.substr(t,y.index-t);void 0===T.body?(T.body=i,T.startInner=y.index+y[0].length):T.elseBody=i,T.find+=i+y[0],n||(a.push(T),T=void 0)}}else T.isBlock||a.push(T);if(i&&!T?.isBlock)break}return a.forEach(i=>{let s,n;let{body:o,elseBody:l,expression:r,fn:a}=i;if(a){let e=[i],h=r.split(" ");for(n=m[a].length;n--;)e.unshift(b(h[n+1]));s=m[a].apply(t,e),i.isBlock&&"boolean"==typeof s&&(s=u(s?o:l,t))}else{let e=r.split(":");if(s=b(e.shift()||""),e.length&&"number"==typeof s){let t=e.join(":");if(d.test(t)){let e=parseInt((t.match(f)||["","-1"])[1],10);null!==s&&(s=C(s,e,g.decimalPoint,t.indexOf(",")>-1?g.thousandsSep:""))}else s=p.dateFormat(t,s)}}e=e.replace(i.find,h(s,""))}),x?u(e,t,n):e}function c(e,t,s,n){let o,l;e=+e||0,t=+t;let a=i.lang,m=(e.toString().split(".")[1]||"").split("e")[0].length,u=e.toString().split("e"),c=t;-1===t?t=Math.min(m,20):r(t)?t&&u[1]&&u[1]<0&&((l=t+ +u[1])>=0?(u[0]=(+u[0]).toExponential(l).split("e")[0],t=l):(u[0]=u[0].split(".")[0]||0,e=t<20?(u[0]*Math.pow(10,u[1])).toFixed(t):0,u[1]=0)):t=2;let f=(Math.abs(u[1]?u[0]:e)+Math.pow(10,-Math.max(t,m)-1)).toFixed(t),g=String(d(f)),p=g.length>3?g.length%3:0;return s=h(s,a.decimalPoint),n=h(n,a.thousandsSep),o=(e<0?"-":"")+(p?g.substr(0,p)+n:""),0>+u[1]&&!c?o="0":o+=g.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+n),t&&(o+=s+f.slice(-t)),u[1]&&0!=+o&&(o+="e"+u[1]),o}return{dateFormat:function(e,t,i){return s.dateFormat(e,t,i)},format:u,helpers:m,numberFormat:c}}),i(t,"DataGrid/DataGridDefaults.js",[],function(){return{cellHeight:49,columnHeaders:{enabled:!0},columns:{},defaultHeight:400,editable:!0,resizableColumns:!0}}),i(t,"DataGrid/DataGrid.js",[t["Data/DataTable.js"],t["DataGrid/DataGridUtils.js"],t["DataGrid/Globals.js"],t["Core/Templating.js"],t["DataGrid/DataGridDefaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(e,t,i,s,n,o,l){let{dataTableCellToString:r,emptyHTMLElement:a,makeDiv:h}=t,{doc:d}=o,{addEvent:m,clamp:u,defined:c,fireEvent:f,isNumber:g,merge:p,pick:C}=l;class b{constructor(e,t){if(this.columnNames=[],this.prevTop=-1,this.scrollEndRowCount=0,this.scrollEndTop=0,this.bottom=!1,this.overflowHeaderWidths=[],"string"==typeof e){let t=d.getElementById(e);t?this.container=t:this.container=h(i.classNames.gridContainer,e)}else this.container=e;this.gridContainer=h(i.classNames.gridContainer),this.outerContainer=h(i.classNames.outerContainer),this.scrollContainer=h(i.classNames.scrollContainer),this.innerContainer=h(i.classNames.innerContainer),this.outerContainer.appendChild(this.scrollContainer),this.gridContainer.appendChild(this.outerContainer),this.container.appendChild(this.gridContainer),this.options=p(b.defaultOptions,t),this.gridContainer.style.height=this.getDataGridSize()+"px",this.gridContainer.role="figure",this.dataTable=this.initDataTable(),this.rowElements=[],this.draggedResizeHandle=null,this.draggedColumnRightIx=null,this.columnNames=this.getColumnsToDisplay(),this.render(),(this.containerResizeObserver=new ResizeObserver(()=>{this.updateGridElements()})).observe(this.container)}update(e){this.options=p(this.options,e),this.options.dataTable!==this.dataTable&&(this.dataTable=this.initDataTable()),this.columnNames=this.getColumnsToDisplay(),this.scrollContainer.removeChild(this.innerContainer),this.render()}resizeColumn(e,t){let i=this.columnHeadersContainer,s="string"==typeof t?this.columnNames.indexOf(t):t,n=`${e}`;if(g(s)){if(-1!==s){if(i){let e=i.children[s];e&&(e.style.flex=n)}for(let e=0;e<this.rowElements.length;e++){let t=this.rowElements[e].children[s];t&&(t.style.flex=n)}}}else{if(i)for(let e=0;e<i.children.length;e++)i.children[e].style.flex=n;for(let e=0;e<this.rowElements.length;e++){let t=this.rowElements[e];for(let e=0;e<t.children.length;e++)t.children[e].style.flex=n}}this.renderColumnDragHandles(),this.emit({type:"afterResizeColumn",width:e,index:s,name:g(s)?this.columnNames[s]:void 0})}emit(e){f(this,e.type,e)}toggleRowHighlight(e){this.hoveredRow&&this.hoveredRow.classList.contains("hovered")&&this.hoveredRow.classList.remove("hovered"),e&&(e.classList.contains("hovered")?e.classList.remove("hovered"):e.classList.add("hovered"))}on(e,t){return m(this,e,t)}scrollToRow(e){this.outerContainer.scrollTop=e*this.options.cellHeight}getColumnsToDisplay(){let e=this.options.columns,t=this.dataTable.modified.getColumnNames(),i=[];for(let s=0;s<t.length;s++){let n=t[s],o=e[n];o&&c(o.show)?e[n].show&&i.push(n):i.push(n)}return i}isColumnEditable(e){return C((this.options.columns[e]||{}).editable,this.options.editable)}initDataTable(){return this.options.dataTable?this.options.dataTable:new e}render(){let{options:e}=this;this.prevTop=-1,this.bottom=!1,a(this.innerContainer),e.columnHeaders.enabled?this.renderColumnHeaders():this.outerContainer.style.top="0",this.renderInitialRows(),this.addEvents(),this.updateScrollingLength(),this.updateVisibleCells(),e.columnHeaders.enabled&&e.resizableColumns&&this.renderColumnDragHandles(),this.updateGridElements(),this.gridContainer.ariaLabel=`Grid with ${this.dataTable.getColumnNames().length} columns and ${this.dataTable.getRowCount()} rows.`}addEvents(){this.outerContainer.addEventListener("scroll",e=>{this.onScroll(e)}),document.addEventListener("click",e=>{this.onDocumentClick(e)}),this.container.addEventListener("mouseover",e=>{this.handleMouseOver(e)})}updateVisibleCells(e=!1){let t=this.outerContainer.scrollTop;o.isSafari&&(t=u(t,0,this.outerContainer.scrollHeight-this.outerContainer.clientHeight));let i=Math.floor(t/this.options.cellHeight);if(i===this.prevTop&&!e)return;this.prevTop=i;let s=this.columnNames,n=this.dataTable.modified.getRowCount();for(let e=0;e<this.rowElements.length&&i<n;e++,i++){let t=this.rowElements[e];t.dataset.rowIndex=String(i);let n=t.childNodes;for(let e=0,o=s.length;e<o;e++){let o=n[e],l=s[e],r=this.dataTable.modified.getCell(s[e],i);o.textContent=this.formatCell(r,l),o.dataset.originalData=""+r,o.dataset.columnName=s[e],o.dataset.dataType=typeof r,0===e&&(t.dataset.rowXIndex=String(g(r)?r:i))}}this.prevTop+this.scrollEndRowCount===n?!this.bottom&&this.scrollEndTop&&(this.bottom=!0,this.innerContainer.scrollTop=this.scrollEndTop):this.bottom&&(this.bottom=!1,this.innerContainer.scrollTop=0)}onScroll(e){e.preventDefault(),window.requestAnimationFrame(this.updateVisibleCells.bind(this,!1))}onCellClick(e,t){if(this.isColumnEditable(t)){let t=e.querySelector("input"),s=e.getAttribute("data-original-data");if(!t){this.removeCellInputElement();let n=e.clientHeight;e.textContent="",(t=this.cellInputEl=document.createElement("input")).style.height=n+"px",t.className=i.classNames.cellInput,e.appendChild(t),t.focus(),t.value=s||""}this.emit({type:"cellClick",input:t})}}onDocumentClick(e){if(this.cellInputEl&&e.target){let t=this.cellInputEl.parentNode;t&&t.contains(e.target)||this.removeCellInputElement()}}handleMouseOver(e){let t=e.target;if(t&&t.classList.contains(i.classNames.cell)){let e=t.parentElement;this.toggleRowHighlight(e),this.hoveredRow=e,f(this.container,"dataGridHover",{row:e})}else this.hoveredRow&&(this.toggleRowHighlight(),this.hoveredRow=void 0)}removeCellInputElement(){let e=this.cellInputEl;if(e){let t=e.parentNode;if(t){let i=t.getAttribute("data-data-type"),s=t.getAttribute("data-column-name"),n=e.value;"number"===i&&(n=parseFloat(n)),t.textContent=this.formatCell(n,s||"")}e.remove(),delete this.cellInputEl}}updateScrollingLength(){let e=this.columnNames,t=this.dataTable.modified.getRowCount()-1,i=0,s=t-this.getNumRowsToDraw(),n=this.outerContainer.clientHeight;this.innerContainer.style.height=n+"px";for(let i=0;i<this.rowElements.length;i++){let s=this.rowElements[i].childNodes;for(let n=0;n<e.length;n++)s[n].textContent=r(this.dataTable.modified.getCell(e[n],t-i))}this.scrollContainer.appendChild(this.innerContainer);for(let e=0;t>s;t--,e++)if((i+=this.rowElements[e].offsetHeight)>n){t--;break}let o=t-s;this.scrollEndRowCount=this.rowElements.length-o,this.scrollEndTop=i-n;let l=(this.dataTable.modified.getRowCount()+o)*this.options.cellHeight;this.scrollContainer.style.height=l+"px"}getNumRowsToDraw(){return Math.min(this.dataTable.modified.getRowCount(),Math.ceil((this.outerContainer.offsetHeight||this.options.defaultHeight)/this.options.cellHeight))}getDataGridSize(){let e=this.options,{height:t}=this.container.getBoundingClientRect();return t>2?t:e.defaultHeight}renderCell(e,t){let s=i.classNames.cell;this.isColumnEditable(t)||(s+=` ${s}-readonly`);let n=h(s);n.style.minHeight=this.options.cellHeight+"px",n.addEventListener("click",()=>this.onCellClick(n,t)),e.appendChild(n)}renderRow(){let e=h(i.classNames.row);for(let t=0;t<this.columnNames.length;t++)this.renderCell(e,this.columnNames[t]);this.innerContainer.appendChild(e),this.rowElements.push(e)}formatHeaderCell(e){let t=this.options.columns[e],i=t&&t.headerFormat;return i?s.format(i,{text:e}):e}formatCell(e,t){let i=this.options.columns[t],n=i&&i.cellFormat,o=i&&i.cellFormatter,l=c(e)?e:"";return(n&&("number"==typeof e&&n.indexOf("value")>-1?l=s.format(n,{value:e}):"string"==typeof e&&n.indexOf("text")>-1&&(l=s.format(n,{text:e}))),o)?o.call({value:e}):l.toString()}renderColumnHeader(e,t){let s=i.classNames.columnHeader;this.isColumnEditable(t)||(s+=` ${s}-readonly`);let n=h(s);n.style.minHeight=this.options.cellHeight+"px",n.style.maxHeight=2*this.options.cellHeight+"px",n.textContent=this.formatHeaderCell(t),e.appendChild(n)}renderColumnHeaders(){let e=this.columnNames,t=this.columnHeadersContainer=this.columnHeadersContainer||h(`${i.classNamePrefix}column-headers`);a(t),e.forEach(this.renderColumnHeader.bind(this,t)),this.headerContainer||(this.headerContainer=h(`${i.classNamePrefix}header-container`),this.headerContainer.appendChild(t)),this.gridContainer.insertBefore(this.headerContainer,this.outerContainer),this.updateColumnHeaders()}updateGridElements(){this.updateColumnHeaders(),this.redrawRowElements(),this.updateDragHandlesPosition()}updateColumnHeaders(){let e=this.columnHeadersContainer;if(e){for(let t=0;t<this.columnNames.length;t++){let i=this.columnNames[t],s=e.children[t],n=this.overflowHeaderWidths[t];s.scrollWidth>s.clientWidth?(this.overflowHeaderWidths[t]=s.scrollWidth,s.textContent=this.formatHeaderCell(i).split(" ").map(e=>e.length<4?e:e.slice(0,2)+"...").join(" ")):g(n)&&n<=s.clientWidth&&(this.overflowHeaderWidths[t]=null,s.textContent=this.formatHeaderCell(i))}this.outerContainer.style.top=e.clientHeight+"px",e.lastChild&&(e.lastChild.style.marginRight=this.outerContainer.offsetWidth-this.outerContainer.clientWidth+"px")}}redrawRowElements(){if(!this.rowElements.length)return;let e=[],t=this.rowElements[0].children;for(let i=0;i<t.length;i++)e.push(t[i].style.flex);a(this.innerContainer),this.renderInitialRows(),this.updateScrollingLength(),this.updateVisibleCells(!0);for(let t=0;t<this.rowElements.length;t++){let i=this.rowElements[t];for(let t=0;t<i.childElementCount;t++)i.children[t].style.flex=e[t]}}updateDragHandlesPosition(){let e=this.columnHeadersContainer,t=this.columnDragHandlesContainer;if(t&&e)for(let i=0;i<t.childElementCount-1;i++){let s=t.children[i],n=e.children[i+1];s.style.height=e.clientHeight+"px",s.style.left=n.offsetLeft-2+"px"}}renderInitialRows(){this.rowElements=[];let e=this.getNumRowsToDraw();for(let t=0;t<e;t++)this.renderRow()}renderColumnDragHandles(){if(!this.columnHeadersContainer)return;let e=this.columnDragHandlesContainer=this.columnDragHandlesContainer||h(`${i.classNamePrefix}col-resize-container`),t=this.columnHeadersContainer.children,s=this.options.cellHeight;a(e);for(let n=1;n<t.length;++n){let o=t[n],l=h(`${i.classNamePrefix}col-resize-handle`);l.style.height=s+"px",l.style.left=o.offsetLeft-2+"px",l.addEventListener("mouseover",()=>{this.draggedResizeHandle||(l.style.opacity="1")}),l.addEventListener("mouseleave",()=>{this.draggedResizeHandle||(l.style.opacity="0")}),l.addEventListener("mousedown",this.onHandleMouseDown.bind(this,l,n)),e.appendChild(l)}this.renderColumnResizeCrosshair(e),document.addEventListener("mouseup",e=>{this.draggedResizeHandle&&this.stopColumnResize(this.draggedResizeHandle,e)}),document.addEventListener("mousemove",e=>{this.draggedResizeHandle&&this.updateColumnResizeDrag(e)}),this.headerContainer&&this.headerContainer.appendChild(e)}renderColumnResizeCrosshair(e){let t=this.columnResizeCrosshair=this.columnResizeCrosshair||h(`${i.classNamePrefix}col-resize-crosshair`),s=this.options.cellHeight;t.style.top=s+"px",t.style.height=this.innerContainer.offsetHeight+"px",e.appendChild(t)}onHandleMouseDown(e,t,i){if(this.draggedResizeHandle)return;i.preventDefault(),this.draggedResizeHandle=e,this.draggedColumnRightIx=t,this.dragResizeStart=i.pageX;let s=this.columnResizeCrosshair;s&&(s.style.left=e.offsetLeft+e.offsetWidth/2-s.offsetWidth/2+"px",s.style.opacity="1")}updateColumnResizeDrag(e){let t=this.draggedResizeHandle,i=this.columnResizeCrosshair,s=this.draggedColumnRightIx,n=this.columnHeadersContainer;if(!t||!i||null===s||!n||!this.dragResizeStart)return;let o=n.children[s],l=e.pageX-this.dragResizeStart,r=o.offsetLeft+l;t.style.left=r-t.offsetWidth/2+"px",i.style.left=r-i.offsetWidth/2+"px"}stopColumnResize(e,t){let i=this.columnResizeCrosshair,s=this.draggedColumnRightIx,n=this.columnHeadersContainer;if(!i||!n||!this.dragResizeStart||null===s)return;e.style.opacity="0",i.style.opacity="0";let o=n.children[s-1],l=n.children[s],r=t.pageX-this.dragResizeStart,a=o.offsetWidth+r,h=l.offsetWidth-r,d=a/o.offsetWidth,m=h/l.offsetWidth,u=(o.style.flex?parseFloat(o.style.flex):1)*d,c=(l.style.flex?parseFloat(l.style.flex):1)*m;this.resizeColumn(u,s-1),this.resizeColumn(c,s),this.draggedResizeHandle=null,this.draggedColumnRightIx=null,this.updateGridElements()}setSize(e,t){e&&(this.innerContainer.style.width=e+"px"),t&&(this.gridContainer.style.height=this.getDataGridSize()+"px",this.outerContainer.style.height=t-(this.options.cellHeight+this.getMarginHeight(t))+"px"),this.render()}getMarginHeight(e){return e-this.gridContainer.getBoundingClientRect().height}}return b.defaultOptions=n,b}),i(t,"masters/datagrid.src.js",[t["DataGrid/Globals.js"],t["DataGrid/DataGrid.js"]],function(e,t){return e.DataGrid=t,e.win.DataGrid||(e.win.DataGrid=e),e})});